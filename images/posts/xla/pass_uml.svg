<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="7455.2083px" preserveAspectRatio="none" style="width:2520px;height:7455px;background:#00000000;" version="1.1" viewBox="0 0 2520 7455" width="2520.8333px" zoomAndPan="magnify"><defs/><g><!--MD5=[22e37ea835dee11a475042bc4ec65ea5]
cluster Just for correctness--><polygon fill="#E3F2FD" points="1221.875,2429.6875,1451.0417,2429.6875,1458.3333,2470.8903,1461.4583,2470.8903,1461.4583,2815.1042,1221.875,2815.1042,1221.875,2429.6875" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1221.875" x2="1458.3333" y1="2470.8903" y2="2470.8903"/><text fill="#2FA4E7" font-family="&quot;Verdana&quot;" font-size="20.8333" font-weight="bold" lengthAdjust="spacing" textLength="212.5" x="1231.25" y="2457.1208">Just for correctness</text><!--MD5=[c1a4d914c1f5776e50e7c9b246de0e2d]
class AliasPassthroughParams--><rect codeLine="217" height="50.9949" id="AliasPassthroughParams" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="180.2083" x="1251.5625" y="2484.375"/><ellipse cx="1266.1458" cy="2501.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1268.0562,2505.9642 Q1267.629,2506.1839 1267.159,2506.2937 Q1266.689,2506.4036 1266.1702,2506.4036 Q1264.327,2506.4036 1263.3565,2505.189 Q1262.3861,2503.9744 1262.3861,2501.6795 Q1262.3861,2499.3785 1263.3565,2498.1639 Q1264.327,2496.9493 1266.1702,2496.9493 Q1266.689,2496.9493 1267.1651,2497.0591 Q1267.6412,2497.169 1268.0562,2497.3887 L1268.0562,2499.3907 Q1267.5924,2498.9634 1267.156,2498.7651 Q1266.7196,2498.5667 1266.2557,2498.5667 Q1265.2669,2498.5667 1264.7634,2499.351 Q1264.2598,2500.1353 1264.2598,2501.6795 Q1264.2598,2503.2176 1264.7634,2504.0019 Q1265.2669,2504.7862 1266.2557,2504.7862 Q1266.7196,2504.7862 1267.156,2504.5878 Q1267.5924,2504.3894 1268.0562,2503.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="138.5417" x="1284.8958" y="2505.8695">AliasPassthroughParams</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1252.6042" x2="1430.7292" y1="2518.7032" y2="2518.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1252.6042" x2="1430.7292" y1="2527.0365" y2="2527.0365"/><!--MD5=[e6b2c6c7074e19fc59abdd2f615e4c33]
class LoopScheduleLinearizer--><rect codeLine="218" height="50.9949" id="LoopScheduleLinearizer" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="175" x="1254.1667" y="2571.875"/><ellipse cx="1268.75" cy="2589.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1270.6604,2593.4642 Q1270.2332,2593.6839 1269.7632,2593.7937 Q1269.2932,2593.9036 1268.7744,2593.9036 Q1266.9312,2593.9036 1265.9607,2592.689 Q1264.9902,2591.4744 1264.9902,2589.1795 Q1264.9902,2586.8785 1265.9607,2585.6639 Q1266.9312,2584.4493 1268.7744,2584.4493 Q1269.2932,2584.4493 1269.7693,2584.5591 Q1270.2454,2584.669 1270.6604,2584.8887 L1270.6604,2586.8907 Q1270.1965,2586.4634 1269.7601,2586.2651 Q1269.3237,2586.0667 1268.8599,2586.0667 Q1267.8711,2586.0667 1267.3676,2586.851 Q1266.864,2587.6353 1266.864,2589.1795 Q1266.864,2590.7176 1267.3676,2591.5019 Q1267.8711,2592.2862 1268.8599,2592.2862 Q1269.3237,2592.2862 1269.7601,2592.0878 Q1270.1965,2591.8894 1270.6604,2591.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="133.3333" x="1287.5" y="2593.3695">LoopScheduleLinearizer</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1255.2083" x2="1428.125" y1="2606.2032" y2="2606.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1255.2083" x2="1428.125" y1="2614.5365" y2="2614.5365"/><!--MD5=[4166052d1a00c29bc4a98d6840784e11]
class GpuCopyInsertion--><rect codeLine="219" height="50.9949" id="GpuCopyInsertion" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="143.75" x="1269.7917" y="2659.375"/><ellipse cx="1284.375" cy="2676.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1286.2854,2680.9642 Q1285.8582,2681.1839 1285.3882,2681.2937 Q1284.9182,2681.4036 1284.3994,2681.4036 Q1282.5562,2681.4036 1281.5857,2680.189 Q1280.6152,2678.9744 1280.6152,2676.6795 Q1280.6152,2674.3785 1281.5857,2673.1639 Q1282.5562,2671.9493 1284.3994,2671.9493 Q1284.9182,2671.9493 1285.3943,2672.0591 Q1285.8704,2672.169 1286.2854,2672.3887 L1286.2854,2674.3907 Q1285.8215,2673.9634 1285.3851,2673.7651 Q1284.9487,2673.5667 1284.4849,2673.5667 Q1283.4961,2673.5667 1282.9926,2674.351 Q1282.489,2675.1353 1282.489,2676.6795 Q1282.489,2678.2176 1282.9926,2679.0019 Q1283.4961,2679.7862 1284.4849,2679.7862 Q1284.9487,2679.7862 1285.3851,2679.5878 Q1285.8215,2679.3894 1286.2854,2678.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="102.0833" x="1303.125" y="2680.8695">GpuCopyInsertion</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1270.8333" x2="1412.5" y1="2693.7032" y2="2693.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1270.8333" x2="1412.5" y1="2702.0365" y2="2702.0365"/><!--MD5=[2cc5fbb13707f6ae0a77be89d0574711]
class GpuSanitizeConstantNames--><rect codeLine="220" height="50.9949" id="GpuSanitizeConstantNames" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="195.8333" x="1243.75" y="2746.875"/><ellipse cx="1258.3333" cy="2764.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1260.2437,2768.4642 Q1259.8165,2768.6839 1259.3465,2768.7937 Q1258.8765,2768.9036 1258.3577,2768.9036 Q1256.5145,2768.9036 1255.544,2767.689 Q1254.5736,2766.4744 1254.5736,2764.1795 Q1254.5736,2761.8785 1255.544,2760.6639 Q1256.5145,2759.4493 1258.3577,2759.4493 Q1258.8765,2759.4493 1259.3526,2759.5591 Q1259.8287,2759.669 1260.2437,2759.8887 L1260.2437,2761.8907 Q1259.7799,2761.4634 1259.3435,2761.2651 Q1258.9071,2761.0667 1258.4432,2761.0667 Q1257.4544,2761.0667 1256.9509,2761.851 Q1256.4473,2762.6353 1256.4473,2764.1795 Q1256.4473,2765.7176 1256.9509,2766.5019 Q1257.4544,2767.2862 1258.4432,2767.2862 Q1258.9071,2767.2862 1259.3435,2767.0878 Q1259.7799,2766.8894 1260.2437,2766.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="154.1667" x="1277.0833" y="2768.3695">GpuSanitizeConstantNames</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1244.7917" x2="1438.5417" y1="2781.2032" y2="2781.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1244.7917" x2="1438.5417" y1="2789.5365" y2="2789.5365"/><!--MD5=[e1baa807812ff977a9edbff5ac23c406]
class HloPassInterface--><rect codeLine="10" height="170.5526" id="HloPassInterface" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="485.4167" x="17.7083" y="4218.2292"/><ellipse cx="204.6875" cy="4235.3933" fill="#D2494E" rx="10.4167" ry="10.4167" style="stroke:#FFFFFF;stroke-width:1.0416666666666667;"/><path d="M201.5706,4232.5551 L201.5706,4230.9682 L206.9967,4230.9682 L206.9967,4232.5551 L205.1839,4232.5551 L205.1839,4238.4939 L206.9967,4238.4939 L206.9967,4240.0808 L201.5706,4240.0808 L201.5706,4238.4939 L203.3834,4238.4939 L203.3834,4232.5551 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" font-style="italic" lengthAdjust="spacing" textLength="92.7083" x="229.6875" y="4239.7237">HloPassInterface</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="18.75" x2="502.0833" y1="4252.5574" y2="4252.5574"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="18.75" x2="502.0833" y1="4260.8907" y2="4260.8907"/><ellipse cx="29.1667" cy="4272.349" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" font-style="italic" lengthAdjust="spacing" textLength="137.5" x="42.7083" y="4281.3436">name(): absl::string_view</text><ellipse cx="29.1667" cy="4296.2606" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" font-style="italic" lengthAdjust="spacing" textLength="241.6667" x="42.7083" y="4305.2551">Run(module: HloModule*): StatusOr&lt;bool&gt;</text><ellipse cx="29.1667" cy="4320.1721" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" font-style="italic" lengthAdjust="spacing" textLength="410.4167" x="42.7083" y="4329.1667">RunOnModuleGroup(module_group: HloModuleGroup*): StatusOr&lt;bool&gt;</text><ellipse cx="29.1667" cy="4344.0837" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="448.9583" x="42.7083" y="4353.0782">RunOnChangedComputations(module: HloModule*, run_state: RunState*): Status</text><ellipse cx="29.1667" cy="4367.9952" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="116.6667" x="42.7083" y="4376.9897">IsPassPipeline(): bool</text><!--MD5=[106a0b1016e6f44db1bbc9f6790d9e67]
class HloModulePass--><rect codeLine="18" height="98.818" id="HloModulePass" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="230.2083" x="665.1042" y="4254.1667"/><ellipse cx="728.6458" cy="4271.3308" fill="#8FB961" rx="10.4167" ry="10.4167" style="stroke:#FFFFFF;stroke-width:1.0416666666666667;"/><path d="M728.7598,4268.0328 L727.9114,4271.7621 L729.6143,4271.7621 Z M727.6611,4266.3849 L729.8645,4266.3849 L732.3242,4275.4974 L730.5237,4275.4974 L729.9622,4273.2452 L727.5513,4273.2452 L727.002,4275.4974 L725.2014,4275.4974 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" font-style="italic" lengthAdjust="spacing" textLength="84.375" x="753.6458" y="4275.6612">HloModulePass</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="666.1458" x2="894.2708" y1="4288.4949" y2="4288.4949"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="666.1458" x2="894.2708" y1="4296.8282" y2="4296.8282"/><ellipse cx="676.5625" cy="4308.2865" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="117.7083" x="690.1042" y="4317.2811">RunOnModuleGroup:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="810.9375" y="4317.2811">override</text><ellipse cx="676.5625" cy="4332.1981" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="193.75" x="690.1042" y="4341.1926">UpdateLayout(shape: Shape*): void</text><polygon fill="none" points="895.3125,4307.9944,916.4102,4301.5073,915.8508,4316.0799" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="916.1305" x2="917.7083" y1="4308.7936" y2="4308.8542"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="665.1042" x2="644.2188" y1="4303.6351" y2="4303.6458"/><!--MD5=[3e45a540899a28090f9d76957af37896]
class HloModuleGroupPass--><rect codeLine="23" height="74.9064" id="HloModuleGroupPass" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="169.7917" x="695.3125" y="4410.9375"/><ellipse cx="713.6458" cy="4428.1016" fill="#8FB961" rx="10.4167" ry="10.4167" style="stroke:#FFFFFF;stroke-width:1.0416666666666667;"/><path d="M713.7598,4424.8037 L712.9114,4428.5329 L714.6143,4428.5329 Z M712.6611,4423.1557 L714.8645,4423.1557 L717.3242,4432.2683 L715.5237,4432.2683 L714.9622,4430.0161 L712.5513,4430.0161 L712.002,4432.2683 L710.2014,4432.2683 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" font-style="italic" lengthAdjust="spacing" textLength="119.7917" x="733.2292" y="4432.432">HloModuleGroupPass</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="696.3542" x2="864.0625" y1="4445.2657" y2="4445.2657"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="696.3542" x2="864.0625" y1="4453.599" y2="4453.599"/><ellipse cx="706.7708" cy="4465.0574" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="25" x="720.3125" y="4474.0519">Run:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="748.4375" y="4474.0519">override</text><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="800.5208" y="4474.0519">(</text><text fill="#FF0000" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="44.7917" x="804.6875" y="4474.0519">prohibit</text><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="4.1667" x="849.4792" y="4474.0519">)</text><!--MD5=[e3c1ce5a92cf76a8f67e3c137f900f6f]
class OpExpanderPass--><rect codeLine="31" height="170.5526" id="OpExpanderPass" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="392.7083" x="1145.3125" y="661.9792"/><ellipse cx="1284.8958" cy="679.1433" fill="#8FB961" rx="10.4167" ry="10.4167" style="stroke:#FFFFFF;stroke-width:1.0416666666666667;"/><path d="M1285.0098,675.8453 L1284.1614,679.5746 L1285.8643,679.5746 Z M1283.9111,674.1974 L1286.1145,674.1974 L1288.5742,683.3099 L1286.7737,683.3099 L1286.2122,681.0577 L1283.8013,681.0577 L1283.252,683.3099 L1281.4514,683.3099 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" font-style="italic" lengthAdjust="spacing" textLength="94.7917" x="1309.8958" y="683.4737">OpExpanderPass</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1146.3542" x2="1536.9792" y1="696.3074" y2="696.3074"/><ellipse cx="1156.7708" cy="707.7657" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;fill:none;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="345.8333" x="1170.3125" y="716.7603">PatternExtraFilter: std::function&lt;bool(const HloInstruction*)&gt;</text><polygon fill="none" points="1156.7708,726.4689,1160.9375,730.6356,1156.7708,734.8022,1152.6042,730.6356" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="170.8333" x="1170.3125" y="740.6718">extra_filter_: PatternExtraFilter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1146.3542" x2="1536.9792" y1="752.4638" y2="752.4638"/><ellipse cx="1156.7708" cy="763.9221" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="25" x="1170.3125" y="772.9167">Run:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1198.4375" y="772.9167">override</text><polygon fill="#FFFF44" points="1156.7708,782.6253,1160.9375,786.792,1156.7708,790.9587,1152.6042,786.792" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="339.5833" x="1170.3125" y="796.8282">InstructionMatchesPattern(instruction: HloInstruction*): bool</text><polygon fill="#FFFF44" points="1156.7708,806.5369,1160.9375,810.7035,1156.7708,814.8702,1152.6042,810.7035" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="356.25" x="1170.3125" y="820.7397">ExpandInstruction(instruction: HloInstruction*): HloInstruction*</text><polygon fill="none" points="1538.0208,738.9663,1558.5281,730.8024,1559.1432,745.3728" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1558.8356" x2="1560.4167" y1="738.0876" y2="738.0208"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1302.6679" x2="1292.9167" y1="832.5317" y2="853.8542"/><!--MD5=[c7dd63c00f6c2fb4e9db159c535bc247]
class HloPassFix--><rect codeLine="39" height="170.5526" id="HloPassFix" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="601.0417" x="1688.5417" y="2082.8125"/><ellipse cx="1703.125" cy="2099.9766" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1705.0354,2104.4017 Q1704.6082,2104.6214 1704.1382,2104.7312 Q1703.6682,2104.8411 1703.1494,2104.8411 Q1701.3062,2104.8411 1700.3357,2103.6265 Q1699.3652,2102.4119 1699.3652,2100.117 Q1699.3652,2097.816 1700.3357,2096.6014 Q1701.3062,2095.3868 1703.1494,2095.3868 Q1703.6682,2095.3868 1704.1443,2095.4966 Q1704.6204,2095.6065 1705.0354,2095.8262 L1705.0354,2097.8282 Q1704.5715,2097.4009 1704.1351,2097.2026 Q1703.6987,2097.0042 1703.2349,2097.0042 Q1702.2461,2097.0042 1701.7426,2097.7885 Q1701.239,2098.5728 1701.239,2100.117 Q1701.239,2101.6551 1701.7426,2102.4394 Q1702.2461,2103.2237 1703.2349,2103.2237 Q1703.6987,2103.2237 1704.1351,2103.0253 Q1704.5715,2102.8269 1705.0354,2102.3997 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="60.4167" x="1721.875" y="2104.307">HloPassFix</text><rect height="27.6917" style="stroke:#343A40;stroke-width:1.0416666666666667;fill:none;stroke-dasharray:2.0,2.0;" width="496.875" x="1795.8333" y="2079.6875"/><text fill="#343A40" font-family="Verdana" font-size="12.5" font-style="italic" lengthAdjust="spacing" textLength="484.375" x="1802.0833" y="2098.5046">typename Pass, is_base_of&lt;HloPassInterface, Pass&gt;, HloPassFix extends Pass</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1689.5833" x2="2288.5417" y1="2117.1407" y2="2117.1407"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1689.5833" x2="2288.5417" y1="2125.474" y2="2125.474"/><ellipse cx="1700" cy="2136.9324" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="25" x="1713.5417" y="2145.9269">Run:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1741.6667" y="2145.9269">override</text><ellipse cx="1700" cy="2160.8439" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="117.7083" x="1713.5417" y="2169.8385">RunOnModuleGroup:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1834.375" y="2169.8385">override</text><ellipse cx="1700" cy="2184.7555" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="170.8333" x="1713.5417" y="2193.75">RunOnChangedComputations:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1887.5" y="2193.75">override</text><rect fill="#F24D5C" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1696.875" y="2205.542"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="362.5" x="1713.5417" y="2217.6615">RunToFixPoint(module: HloModule*, run_state: RunState*): Status</text><rect fill="#F24D5C" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1696.875" y="2229.4535"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="478.125" x="1713.5417" y="2241.5731">RunOnChangedComputationsOnce(module: HloModule*, run_state: RunState*): Status</text><!--MD5=[39ffc23c61e6eab59c6c3bcd69b51356]
class HloPassPipeline--><rect codeLine="47" height="290.1103" id="HloPassPipeline" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="429.1667" x="565.625" y="2625"/><ellipse cx="727.6042" cy="2642.1641" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M729.5146,2646.5892 Q729.0873,2646.8089 728.6174,2646.9187 Q728.1474,2647.0286 727.6286,2647.0286 Q725.7853,2647.0286 724.8149,2645.814 Q723.8444,2644.5994 723.8444,2642.3045 Q723.8444,2640.0035 724.8149,2638.7889 Q725.7853,2637.5743 727.6286,2637.5743 Q728.1474,2637.5743 728.6235,2637.6841 Q729.0995,2637.794 729.5146,2638.0137 L729.5146,2640.0157 Q729.0507,2639.5884 728.6143,2639.3901 Q728.1779,2639.1917 727.714,2639.1917 Q726.7253,2639.1917 726.2217,2639.976 Q725.7182,2640.7603 725.7182,2642.3045 Q725.7182,2643.8426 726.2217,2644.6269 Q726.7253,2645.4112 727.714,2645.4112 Q728.1779,2645.4112 728.6143,2645.2128 Q729.0507,2645.0144 729.5146,2644.5872 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="86.4583" x="752.6042" y="2646.4945">HloPassPipeline</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="566.6667" x2="993.75" y1="2659.3282" y2="2659.3282"/><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="573.9583" y="2667.6615"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="326.0417" x="590.625" y="2679.7811">passes_: std::vector&lt;std::unique_ptr&lt;HloPassInterface&gt;&gt;</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="573.9583" y="2691.5731"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="392.7083" x="590.625" y="2703.6926">invariant_checkers_: std::vector&lt;std::unique_ptr&lt;HloPassInterface&gt;&gt;</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="566.6667" x2="993.75" y1="2715.4846" y2="2715.4846"/><ellipse cx="577.0833" cy="2726.943" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="33.3333" x="590.625" y="2735.9375">name:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="627.0833" y="2735.9375">override</text><ellipse cx="577.0833" cy="2750.8545" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="25" x="590.625" y="2759.849">Run:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="618.75" y="2759.849">override</text><ellipse cx="577.0833" cy="2774.766" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="117.7083" x="590.625" y="2783.7606">RunOnModuleGroup:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="711.4583" y="2783.7606">override</text><ellipse cx="577.0833" cy="2798.6776" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="80.2083" x="590.625" y="2807.6721">IsPassPipeline:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="673.9583" y="2807.6721">override</text><ellipse cx="577.0833" cy="2822.5891" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="162.5" x="590.625" y="2831.5837">AddPass(args: Args&amp;&amp;...): T&amp;</text><ellipse cx="577.0833" cy="2846.5007" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="232.2917" x="590.625" y="2855.4952">AddInvariantChecker(args: Args&amp;&amp;...): T&amp;</text><ellipse cx="577.0833" cy="2870.4122" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="88.5417" x="590.625" y="2879.4067">PassesSize(): int</text><ellipse cx="577.0833" cy="2894.3237" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="211.4583" x="590.625" y="2903.3183">GetPass(index: int): HloPassInterface&amp;</text><!--MD5=[2f601d9b6df18e62a9fa10da7557db44]
class HloVerifier--><rect codeLine="61" height="50.9949" id="HloVerifier" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="101.0417" x="1291.1458" y="2011.4583"/><ellipse cx="1305.7292" cy="2028.6224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1307.6396,2033.0475 Q1307.2123,2033.2672 1306.7424,2033.3771 Q1306.2724,2033.4869 1305.7536,2033.4869 Q1303.9103,2033.4869 1302.9399,2032.2723 Q1301.9694,2031.0577 1301.9694,2028.7628 Q1301.9694,2026.4618 1302.9399,2025.2472 Q1303.9103,2024.0326 1305.7536,2024.0326 Q1306.2724,2024.0326 1306.7485,2024.1425 Q1307.2245,2024.2523 1307.6396,2024.472 L1307.6396,2026.474 Q1307.1757,2026.0468 1306.7393,2025.8484 Q1306.3029,2025.65 1305.839,2025.65 Q1304.8503,2025.65 1304.3467,2026.4343 Q1303.8432,2027.2186 1303.8432,2028.7628 Q1303.8432,2030.3009 1304.3467,2031.0852 Q1304.8503,2031.8695 1305.839,2031.8695 Q1306.3029,2031.8695 1306.7393,2031.6711 Q1307.1757,2031.4728 1307.6396,2031.0455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="59.375" x="1324.4792" y="2032.9529">HloVerifier</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1292.1875" x2="1391.1458" y1="2045.7865" y2="2045.7865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1292.1875" x2="1391.1458" y1="2054.1199" y2="2054.1199"/><!--MD5=[6b1af5e522d97990e45b6fb862ef2899]
class AllToAllDecomposer--><rect codeLine="64" height="98.818" id="AllToAllDecomposer" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="190.625" x="1893.75" y="17.7083"/><ellipse cx="1923.8021" cy="34.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1925.7125,39.2975 Q1925.2852,39.5172 1924.8153,39.6271 Q1924.3453,39.7369 1923.8265,39.7369 Q1921.9832,39.7369 1921.0128,38.5223 Q1920.0423,37.3077 1920.0423,35.0128 Q1920.0423,32.7118 1921.0128,31.4972 Q1921.9832,30.2826 1923.8265,30.2826 Q1924.3453,30.2826 1924.8214,30.3925 Q1925.2974,30.5023 1925.7125,30.722 L1925.7125,32.724 Q1925.2486,32.2968 1924.8122,32.0984 Q1924.3758,31.9 1923.9119,31.9 Q1922.9232,31.9 1922.4196,32.6843 Q1921.9161,33.4686 1921.9161,35.0128 Q1921.9161,36.5509 1922.4196,37.3352 Q1922.9232,38.1195 1923.9119,38.1195 Q1924.3758,38.1195 1924.8122,37.9211 Q1925.2486,37.7228 1925.7125,37.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="114.5833" x="1945.9896" y="39.2029">AllToAllDecomposer</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1894.7917" x2="2083.3333" y1="52.0365" y2="52.0365"/><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1902.0833" y="60.3699"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="154.1667" x="1918.75" y="72.4894">decompose_to_tuple_: bool</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1902.0833" y="84.2814"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="139.5833" x="1918.75" y="96.401">min_array_rank_: int64_t</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1894.7917" x2="2083.3333" y1="108.193" y2="108.193"/><!--MD5=[37a115efb258bc1f61b54e4b55ac3571]
class OperandUpcaster--><rect codeLine="68" height="50.9949" id="OperandUpcaster" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="140.625" x="1918.75" y="153.125"/><ellipse cx="1933.3333" cy="170.2891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1935.2437,174.7142 Q1934.8165,174.9339 1934.3465,175.0437 Q1933.8765,175.1536 1933.3577,175.1536 Q1931.5145,175.1536 1930.544,173.939 Q1929.5736,172.7244 1929.5736,170.4295 Q1929.5736,168.1285 1930.544,166.9139 Q1931.5145,165.6993 1933.3577,165.6993 Q1933.8765,165.6993 1934.3526,165.8091 Q1934.8287,165.919 1935.2437,166.1387 L1935.2437,168.1407 Q1934.7799,167.7134 1934.3435,167.5151 Q1933.9071,167.3167 1933.4432,167.3167 Q1932.4544,167.3167 1931.9509,168.101 Q1931.4473,168.8853 1931.4473,170.4295 Q1931.4473,171.9676 1931.9509,172.7519 Q1932.4544,173.5362 1933.4432,173.5362 Q1933.9071,173.5362 1934.3435,173.3378 Q1934.7799,173.1394 1935.2437,172.7122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="98.9583" x="1952.0833" y="174.6195">OperandUpcaster</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1919.7917" x2="2058.3333" y1="187.4532" y2="187.4532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1919.7917" x2="2058.3333" y1="195.7865" y2="195.7865"/><!--MD5=[3b9d96ff7b14aebbb0c83fa3add3d17d]
class ResultCaster--><rect codeLine="69" height="50.9949" id="ResultCaster" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="112.5" x="1932.8125" y="1292.7083"/><ellipse cx="1947.3958" cy="1309.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1949.3062,1314.2975 Q1948.879,1314.5172 1948.409,1314.6271 Q1947.939,1314.7369 1947.4202,1314.7369 Q1945.577,1314.7369 1944.6065,1313.5223 Q1943.6361,1312.3077 1943.6361,1310.0128 Q1943.6361,1307.7118 1944.6065,1306.4972 Q1945.577,1305.2826 1947.4202,1305.2826 Q1947.939,1305.2826 1948.4151,1305.3925 Q1948.8912,1305.5023 1949.3062,1305.722 L1949.3062,1307.724 Q1948.8424,1307.2968 1948.406,1307.0984 Q1947.9696,1306.9 1947.5057,1306.9 Q1946.5169,1306.9 1946.0134,1307.6843 Q1945.5098,1308.4686 1945.5098,1310.0128 Q1945.5098,1311.5509 1946.0134,1312.3352 Q1946.5169,1313.1195 1947.5057,1313.1195 Q1947.9696,1313.1195 1948.406,1312.9211 Q1948.8424,1312.7228 1949.3062,1312.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="70.8333" x="1966.1458" y="1314.2029">ResultCaster</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1933.8542" x2="2044.2708" y1="1327.0365" y2="1327.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1933.8542" x2="2044.2708" y1="1335.3699" y2="1335.3699"/><path d="M1894.2708,1207.2917 L1894.2708,1251.6886 A4.1667,4.1667 0 0 0 1898.4375,1255.8553 L1984.8958,1255.8553 L1989.0625,1292.6354 L1993.2292,1255.8553 L2079.6875,1255.8553 A4.1667,4.1667 0 0 0 2083.8542,1251.6886 L2083.8542,1213.5417 L2073.4375,1203.125 L1898.4375,1203.125 A4.1667,4.1667 0 0 0 1894.2708,1207.2917 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><path d="M2073.4375,1203.125 L2073.4375,1211.4583 A2.0833,2.0833 0 0 0 2075.5208,1213.5417 L2083.8542,1213.5417 L2073.4375,1203.125 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="157.2917" x="1905.7292" y="1226.6337">ResultCaster should run</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="151.0417" x="1905.7292" y="1242.5822">after OperandUpcaster.</text><!--MD5=[5d73980cfaa3deef930adbce3a1803c8]
class RngExpander--><rect codeLine="75" height="50.9949" id="RngExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="116.6667" x="1930.7292" y="240.625"/><ellipse cx="1945.3125" cy="257.7891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1947.2229,262.2142 Q1946.7957,262.4339 1946.3257,262.5437 Q1945.8557,262.6536 1945.3369,262.6536 Q1943.4937,262.6536 1942.5232,261.439 Q1941.5527,260.2244 1941.5527,257.9295 Q1941.5527,255.6285 1942.5232,254.4139 Q1943.4937,253.1993 1945.3369,253.1993 Q1945.8557,253.1993 1946.3318,253.3091 Q1946.8079,253.419 1947.2229,253.6387 L1947.2229,255.6407 Q1946.759,255.2134 1946.3226,255.0151 Q1945.8862,254.8167 1945.4224,254.8167 Q1944.4336,254.8167 1943.9301,255.601 Q1943.4265,256.3853 1943.4265,257.9295 Q1943.4265,259.4676 1943.9301,260.2519 Q1944.4336,261.0362 1945.4224,261.0362 Q1945.8862,261.0362 1946.3226,260.8378 Q1946.759,260.6394 1947.2229,260.2122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="75" x="1964.0625" y="262.1195">RngExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1931.7708" x2="2046.3542" y1="274.9532" y2="274.9532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1931.7708" x2="2046.3542" y1="283.2865" y2="283.2865"/><!--MD5=[2679ab719cf3cbe81b55c9e9cdb21fea]
class RngBitGeneratorExpander--><rect codeLine="76" height="50.9949" id="RngBitGeneratorExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="186.4583" x="1895.8333" y="328.125"/><ellipse cx="1910.4167" cy="345.2891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1912.3271,349.7142 Q1911.8998,349.9339 1911.4299,350.0437 Q1910.9599,350.1536 1910.4411,350.1536 Q1908.5978,350.1536 1907.6274,348.939 Q1906.6569,347.7244 1906.6569,345.4295 Q1906.6569,343.1285 1907.6274,341.9139 Q1908.5978,340.6993 1910.4411,340.6993 Q1910.9599,340.6993 1911.436,340.8091 Q1911.912,340.919 1912.3271,341.1387 L1912.3271,343.1407 Q1911.8632,342.7134 1911.4268,342.5151 Q1910.9904,342.3167 1910.5265,342.3167 Q1909.5378,342.3167 1909.0342,343.101 Q1908.5307,343.8853 1908.5307,345.4295 Q1908.5307,346.9676 1909.0342,347.7519 Q1909.5378,348.5362 1910.5265,348.5362 Q1910.9904,348.5362 1911.4268,348.3378 Q1911.8632,348.1394 1912.3271,347.7122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="144.7917" x="1929.1667" y="349.6195">RngBitGeneratorExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1896.875" x2="2081.25" y1="362.4532" y2="362.4532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1896.875" x2="2081.25" y1="370.7865" y2="370.7865"/><!--MD5=[89607f3cad2068b469bd935e1244323b]
class ZeroSizedHloElimination--><rect codeLine="77" height="50.9949" id="ZeroSizedHloElimination" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="177.0833" x="1900.5208" y="1486.4583"/><ellipse cx="1915.1042" cy="1503.6224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1917.0146,1508.0475 Q1916.5873,1508.2672 1916.1174,1508.3771 Q1915.6474,1508.4869 1915.1286,1508.4869 Q1913.2853,1508.4869 1912.3149,1507.2723 Q1911.3444,1506.0577 1911.3444,1503.7628 Q1911.3444,1501.4618 1912.3149,1500.2472 Q1913.2853,1499.0326 1915.1286,1499.0326 Q1915.6474,1499.0326 1916.1235,1499.1425 Q1916.5995,1499.2523 1917.0146,1499.472 L1917.0146,1501.474 Q1916.5507,1501.0468 1916.1143,1500.8484 Q1915.6779,1500.65 1915.214,1500.65 Q1914.2253,1500.65 1913.7217,1501.4343 Q1913.2182,1502.2186 1913.2182,1503.7628 Q1913.2182,1505.3009 1913.7217,1506.0852 Q1914.2253,1506.8695 1915.214,1506.8695 Q1915.6779,1506.8695 1916.1143,1506.6711 Q1916.5507,1506.4728 1917.0146,1506.0455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="135.4167" x="1933.8542" y="1507.9529">ZeroSizedHloElimination</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1901.5625" x2="2076.5625" y1="1520.7865" y2="1520.7865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1901.5625" x2="2076.5625" y1="1529.1199" y2="1529.1199"/><path d="M1886.9792,1384.8958 L1886.9792,1445.2413 A4.1667,4.1667 0 0 0 1891.1458,1449.408 L1984.8958,1449.408 L1989.0625,1486.25 L1993.2292,1449.408 L2086.9792,1449.408 A4.1667,4.1667 0 0 0 2091.1458,1445.2413 L2091.1458,1391.1458 L2080.7292,1380.7292 L1891.1458,1380.7292 A4.1667,4.1667 0 0 0 1886.9792,1384.8958 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><path d="M2080.7292,1380.7292 L2080.7292,1389.0625 A2.0833,2.0833 0 0 0 2082.8125,1391.1458 L2091.1458,1391.1458 L2080.7292,1380.7292 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="162.5" x="1898.4375" y="1404.2379">Replaces zero sized Hlos</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="171.875" x="1898.4375" y="1420.1864">with a zero sized constant</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="41.6667" x="1898.4375" y="1436.1348">literal.</text><!--MD5=[be8b64d0c7bf72e968a339c0a3a267c4]
class GpuScatterExpander--><rect codeLine="79" height="50.9949" id="GpuScatterExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="156.25" x="2352.0833" y="415.625"/><ellipse cx="2366.6667" cy="432.7891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M2368.5771,437.2142 Q2368.1498,437.4339 2367.6799,437.5437 Q2367.2099,437.6536 2366.6911,437.6536 Q2364.8478,437.6536 2363.8774,436.439 Q2362.9069,435.2244 2362.9069,432.9295 Q2362.9069,430.6285 2363.8774,429.4139 Q2364.8478,428.1993 2366.6911,428.1993 Q2367.2099,428.1993 2367.686,428.3091 Q2368.162,428.419 2368.5771,428.6387 L2368.5771,430.6407 Q2368.1132,430.2134 2367.6768,430.0151 Q2367.2404,429.8167 2366.7765,429.8167 Q2365.7878,429.8167 2365.2842,430.601 Q2364.7807,431.3853 2364.7807,432.9295 Q2364.7807,434.4676 2365.2842,435.2519 Q2365.7878,436.0362 2366.7765,436.0362 Q2367.2404,436.0362 2367.6768,435.8378 Q2368.1132,435.6394 2368.5771,435.2122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="114.5833" x="2385.4167" y="437.1195">GpuScatterExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="2353.125" x2="2507.2917" y1="449.9532" y2="449.9532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="2353.125" x2="2507.2917" y1="458.2865" y2="458.2865"/><!--MD5=[6f807b1745ee4d99a9abb947dc15cbc0]
class ScatterExpander--><rect codeLine="80" height="50.9949" id="ScatterExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="133.3333" x="1922.3958" y="415.625"/><ellipse cx="1936.9792" cy="432.7891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1938.8896,437.2142 Q1938.4623,437.4339 1937.9924,437.5437 Q1937.5224,437.6536 1937.0036,437.6536 Q1935.1603,437.6536 1934.1899,436.439 Q1933.2194,435.2244 1933.2194,432.9295 Q1933.2194,430.6285 1934.1899,429.4139 Q1935.1603,428.1993 1937.0036,428.1993 Q1937.5224,428.1993 1937.9985,428.3091 Q1938.4745,428.419 1938.8896,428.6387 L1938.8896,430.6407 Q1938.4257,430.2134 1937.9893,430.0151 Q1937.5529,429.8167 1937.089,429.8167 Q1936.1003,429.8167 1935.5967,430.601 Q1935.0932,431.3853 1935.0932,432.9295 Q1935.0932,434.4676 1935.5967,435.2519 Q1936.1003,436.0362 1937.089,436.0362 Q1937.5529,436.0362 1937.9893,435.8378 Q1938.4257,435.6394 1938.8896,435.2122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="91.6667" x="1955.7292" y="437.1195">ScatterExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1923.4375" x2="2054.6875" y1="449.9532" y2="449.9532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1923.4375" x2="2054.6875" y1="458.2865" y2="458.2865"/><!--MD5=[7d7fdd8a33b9f1337556d810a2ce10c2]
class QrExpander--><rect codeLine="81" height="50.9949" id="QrExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="109.375" x="1934.375" y="503.125"/><ellipse cx="1948.9583" cy="520.2891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1950.8687,524.7142 Q1950.4415,524.9339 1949.9715,525.0437 Q1949.5015,525.1536 1948.9827,525.1536 Q1947.1395,525.1536 1946.169,523.939 Q1945.1986,522.7244 1945.1986,520.4295 Q1945.1986,518.1285 1946.169,516.9139 Q1947.1395,515.6993 1948.9827,515.6993 Q1949.5015,515.6993 1949.9776,515.8091 Q1950.4537,515.919 1950.8687,516.1387 L1950.8687,518.1407 Q1950.4049,517.7134 1949.9685,517.5151 Q1949.5321,517.3167 1949.0682,517.3167 Q1948.0794,517.3167 1947.5759,518.101 Q1947.0723,518.8853 1947.0723,520.4295 Q1947.0723,521.9676 1947.5759,522.7519 Q1948.0794,523.5362 1949.0682,523.5362 Q1949.5321,523.5362 1949.9685,523.3378 Q1950.4049,523.1394 1950.8687,522.7122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="67.7083" x="1967.7083" y="524.6195">QrExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1935.4167" x2="2042.7083" y1="537.4532" y2="537.4532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1935.4167" x2="2042.7083" y1="545.7865" y2="545.7865"/><!--MD5=[2a468332e09c5a708f779aa2b57d27bb]
class EighExpander--><rect codeLine="82" height="50.9949" id="EighExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="118.75" x="1929.6875" y="590.625"/><ellipse cx="1944.2708" cy="607.7891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1946.1812,612.2142 Q1945.754,612.4339 1945.284,612.5437 Q1944.814,612.6536 1944.2952,612.6536 Q1942.452,612.6536 1941.4815,611.439 Q1940.5111,610.2244 1940.5111,607.9295 Q1940.5111,605.6285 1941.4815,604.4139 Q1942.452,603.1993 1944.2952,603.1993 Q1944.814,603.1993 1945.2901,603.3091 Q1945.7662,603.419 1946.1812,603.6387 L1946.1812,605.6407 Q1945.7174,605.2134 1945.281,605.0151 Q1944.8446,604.8167 1944.3807,604.8167 Q1943.3919,604.8167 1942.8884,605.601 Q1942.3848,606.3853 1942.3848,607.9295 Q1942.3848,609.4676 1942.8884,610.2519 Q1943.3919,611.0362 1944.3807,611.0362 Q1944.8446,611.0362 1945.281,610.8378 Q1945.7174,610.6394 1946.1812,610.2122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="77.0833" x="1963.0208" y="612.1195">EighExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1930.7292" x2="2047.3958" y1="624.9532" y2="624.9532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1930.7292" x2="2047.3958" y1="633.2865" y2="633.2865"/><!--MD5=[a5f12ec8e580018130088188f8b8d6d4]
class DynamicIndexSplitter--><rect codeLine="83" height="50.9949" id="DynamicIndexSplitter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="160.4167" x="1261.4583" y="2098.9583"/><ellipse cx="1276.0417" cy="2116.1224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1277.9521,2120.5475 Q1277.5248,2120.7672 1277.0549,2120.8771 Q1276.5849,2120.9869 1276.0661,2120.9869 Q1274.2228,2120.9869 1273.2524,2119.7723 Q1272.2819,2118.5577 1272.2819,2116.2628 Q1272.2819,2113.9618 1273.2524,2112.7472 Q1274.2228,2111.5326 1276.0661,2111.5326 Q1276.5849,2111.5326 1277.061,2111.6425 Q1277.537,2111.7523 1277.9521,2111.972 L1277.9521,2113.974 Q1277.4882,2113.5468 1277.0518,2113.3484 Q1276.6154,2113.15 1276.1515,2113.15 Q1275.1628,2113.15 1274.6592,2113.9343 Q1274.1557,2114.7186 1274.1557,2116.2628 Q1274.1557,2117.8009 1274.6592,2118.5852 Q1275.1628,2119.3695 1276.1515,2119.3695 Q1276.6154,2119.3695 1277.0518,2119.1711 Q1277.4882,2118.9728 1277.9521,2118.5455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="118.75" x="1294.7917" y="2120.4529">DynamicIndexSplitter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1262.5" x2="1420.8333" y1="2133.2865" y2="2133.2865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1262.5" x2="1420.8333" y1="2141.6199" y2="2141.6199"/><!--MD5=[2ad6355dfe0a22bb2d12fa895dbd06dc]
class CallInliner--><rect codeLine="84" height="50.9949" id="CallInliner" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="97.9167" x="1292.7083" y="2186.4583"/><ellipse cx="1307.2917" cy="2203.6224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1309.2021,2208.0475 Q1308.7748,2208.2672 1308.3049,2208.3771 Q1307.8349,2208.4869 1307.3161,2208.4869 Q1305.4728,2208.4869 1304.5024,2207.2723 Q1303.5319,2206.0577 1303.5319,2203.7628 Q1303.5319,2201.4618 1304.5024,2200.2472 Q1305.4728,2199.0326 1307.3161,2199.0326 Q1307.8349,2199.0326 1308.311,2199.1425 Q1308.787,2199.2523 1309.2021,2199.472 L1309.2021,2201.474 Q1308.7382,2201.0468 1308.3018,2200.8484 Q1307.8654,2200.65 1307.4015,2200.65 Q1306.4128,2200.65 1305.9092,2201.4343 Q1305.4057,2202.2186 1305.4057,2203.7628 Q1305.4057,2205.3009 1305.9092,2206.0852 Q1306.4128,2206.8695 1307.4015,2206.8695 Q1307.8654,2206.8695 1308.3018,2206.6711 Q1308.7382,2206.4728 1309.2021,2206.0455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="56.25" x="1326.0417" y="2207.9529">CallInliner</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1293.75" x2="1389.5833" y1="2220.7865" y2="2220.7865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1293.75" x2="1389.5833" y1="2229.1199" y2="2229.1199"/><!--MD5=[2284831367a975ef8be05d17911f8273]
class DotDecomposer--><rect codeLine="105" height="50.9949" id="DotDecomposer" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="132.2917" x="1275.5208" y="2273.9583"/><ellipse cx="1290.1042" cy="2291.1224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1292.0146,2295.5475 Q1291.5873,2295.7672 1291.1174,2295.8771 Q1290.6474,2295.9869 1290.1286,2295.9869 Q1288.2853,2295.9869 1287.3149,2294.7723 Q1286.3444,2293.5577 1286.3444,2291.2628 Q1286.3444,2288.9618 1287.3149,2287.7472 Q1288.2853,2286.5326 1290.1286,2286.5326 Q1290.6474,2286.5326 1291.1235,2286.6425 Q1291.5995,2286.7523 1292.0146,2286.972 L1292.0146,2288.974 Q1291.5507,2288.5468 1291.1143,2288.3484 Q1290.6779,2288.15 1290.214,2288.15 Q1289.2253,2288.15 1288.7217,2288.9343 Q1288.2182,2289.7186 1288.2182,2291.2628 Q1288.2182,2292.8009 1288.7217,2293.5852 Q1289.2253,2294.3695 1290.214,2294.3695 Q1290.6779,2294.3695 1291.1143,2294.1711 Q1291.5507,2293.9728 1292.0146,2293.5455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="90.625" x="1308.8542" y="2295.4529">DotDecomposer</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1276.5625" x2="1406.7708" y1="2308.2865" y2="2308.2865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1276.5625" x2="1406.7708" y1="2316.6199" y2="2316.6199"/><!--MD5=[0f784d348b9fe54dc18975ca4b0ca44e]
class Convolution4DExpander--><rect codeLine="86" height="50.9949" id="Convolution4DExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="179.1667" x="1899.4792" y="678.125"/><ellipse cx="1914.0625" cy="695.2891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1915.9729,699.7142 Q1915.5457,699.9339 1915.0757,700.0437 Q1914.6057,700.1536 1914.0869,700.1536 Q1912.2437,700.1536 1911.2732,698.939 Q1910.3027,697.7244 1910.3027,695.4295 Q1910.3027,693.1285 1911.2732,691.9139 Q1912.2437,690.6993 1914.0869,690.6993 Q1914.6057,690.6993 1915.0818,690.8091 Q1915.5579,690.919 1915.9729,691.1387 L1915.9729,693.1407 Q1915.509,692.7134 1915.0726,692.5151 Q1914.6362,692.3167 1914.1724,692.3167 Q1913.1836,692.3167 1912.6801,693.101 Q1912.1765,693.8853 1912.1765,695.4295 Q1912.1765,696.9676 1912.6801,697.7519 Q1913.1836,698.5362 1914.1724,698.5362 Q1914.6362,698.5362 1915.0726,698.3378 Q1915.509,698.1394 1915.9729,697.7122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="137.5" x="1932.8125" y="699.6195">Convolution4DExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1900.5208" x2="2077.6042" y1="712.4532" y2="712.4532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1900.5208" x2="2077.6042" y1="720.7865" y2="720.7865"/><!--MD5=[0c43c22750c2634bf6dbe8cbe45d23f5]
class StableSortExpander--><rect codeLine="87" height="50.9949" id="StableSortExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="151.0417" x="1913.5417" y="765.625"/><ellipse cx="1928.125" cy="782.7891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1930.0354,787.2142 Q1929.6082,787.4339 1929.1382,787.5437 Q1928.6682,787.6536 1928.1494,787.6536 Q1926.3062,787.6536 1925.3357,786.439 Q1924.3652,785.2244 1924.3652,782.9295 Q1924.3652,780.6285 1925.3357,779.4139 Q1926.3062,778.1993 1928.1494,778.1993 Q1928.6682,778.1993 1929.1443,778.3091 Q1929.6204,778.419 1930.0354,778.6387 L1930.0354,780.6407 Q1929.5715,780.2134 1929.1351,780.0151 Q1928.6987,779.8167 1928.2349,779.8167 Q1927.2461,779.8167 1926.7426,780.601 Q1926.239,781.3853 1926.239,782.9295 Q1926.239,784.4676 1926.7426,785.2519 Q1927.2461,786.0362 1928.2349,786.0362 Q1928.6987,786.0362 1929.1351,785.8378 Q1929.5715,785.6394 1930.0354,785.2122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="109.375" x="1946.875" y="787.1195">StableSortExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1914.5833" x2="2063.5417" y1="799.9532" y2="799.9532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1914.5833" x2="2063.5417" y1="808.2865" y2="808.2865"/><!--MD5=[dac82508b0e15bbac8a071dcb9e0a3d0]
class BFloat16Normalization--><rect codeLine="88" height="50.9949" id="BFloat16Normalization" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="167.7083" x="1257.8125" y="1588.5417"/><ellipse cx="1272.3958" cy="1605.7058" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1274.3062,1610.1308 Q1273.879,1610.3505 1273.409,1610.4604 Q1272.939,1610.5703 1272.4202,1610.5703 Q1270.577,1610.5703 1269.6065,1609.3557 Q1268.6361,1608.1411 1268.6361,1605.8462 Q1268.6361,1603.5451 1269.6065,1602.3305 Q1270.577,1601.1159 1272.4202,1601.1159 Q1272.939,1601.1159 1273.4151,1601.2258 Q1273.8912,1601.3357 1274.3062,1601.5554 L1274.3062,1603.5573 Q1273.8424,1603.1301 1273.406,1602.9317 Q1272.9696,1602.7334 1272.5057,1602.7334 Q1271.5169,1602.7334 1271.0134,1603.5177 Q1270.5098,1604.302 1270.5098,1605.8462 Q1270.5098,1607.3842 1271.0134,1608.1685 Q1271.5169,1608.9528 1272.5057,1608.9528 Q1272.9696,1608.9528 1273.406,1608.7545 Q1273.8424,1608.5561 1274.3062,1608.1289 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="126.0417" x="1291.1458" y="1610.0362">BFloat16Normalization</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1258.8542" x2="1424.4792" y1="1622.8699" y2="1622.8699"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1258.8542" x2="1424.4792" y1="1631.2032" y2="1631.2032"/><path d="M1869.7917,1578.125 L1869.7917,1611.5938 L1425.75,1614.3333 L1869.7917,1619.9271 L1869.7917,1654.4189 A4.1667,4.1667 0 0 0 1873.9583,1658.5856 L2104.1667,1658.5856 A4.1667,4.1667 0 0 0 2108.3333,1654.4189 L2108.3333,1584.375 L2097.9167,1573.9583 L1873.9583,1573.9583 A4.1667,4.1667 0 0 0 1869.7917,1578.125 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><path d="M2097.9167,1573.9583 L2097.9167,1582.2917 A2.0833,2.0833 0 0 0 2100,1584.375 L2108.3333,1584.375 L2097.9167,1573.9583 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="206.25" x="1881.25" y="1597.467">Add F32 &lt;-&gt; BF16 conversions</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="202.0833" x="1881.25" y="1613.4155">for HLO instructions that don't</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="193.75" x="1881.25" y="1629.364">support BF16 input/output or</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="101.0417" x="1881.25" y="1645.3125">mixedprecision</text><!--MD5=[31bca82c7a8fd95d82b9ec33684b26a4]
class BatchNormExpander--><rect codeLine="90" height="122.7295" id="BatchNormExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="191.6667" x="1245.8333" y="1676.5625"/><ellipse cx="1276.3542" cy="1693.7266" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1278.2646,1698.1517 Q1277.8373,1698.3714 1277.3674,1698.4812 Q1276.8974,1698.5911 1276.3786,1698.5911 Q1274.5353,1698.5911 1273.5649,1697.3765 Q1272.5944,1696.1619 1272.5944,1693.867 Q1272.5944,1691.566 1273.5649,1690.3514 Q1274.5353,1689.1368 1276.3786,1689.1368 Q1276.8974,1689.1368 1277.3735,1689.2466 Q1277.8495,1689.3565 1278.2646,1689.5762 L1278.2646,1691.5782 Q1277.8007,1691.1509 1277.3643,1690.9526 Q1276.9279,1690.7542 1276.464,1690.7542 Q1275.4753,1690.7542 1274.9717,1691.5385 Q1274.4682,1692.3228 1274.4682,1693.867 Q1274.4682,1695.4051 1274.9717,1696.1894 Q1275.4753,1696.9737 1276.464,1696.9737 Q1276.9279,1696.9737 1277.3643,1696.7753 Q1277.8007,1696.5769 1278.2646,1696.1497 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="114.5833" x="1298.6458" y="1698.057">BatchNormExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1246.875" x2="1436.4583" y1="1710.8907" y2="1710.8907"/><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1254.1667" y="1719.224"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="146.875" x="1270.8333" y="1731.3436">rewrite_training_op_: bool</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1254.1667" y="1743.1356"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="155.2083" x="1270.8333" y="1755.2551">rewrite_inference_op_: bool</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1254.1667" y="1767.0471"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="129.1667" x="1270.8333" y="1779.1667">rewrite_grad_op_: bool</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1246.875" x2="1436.4583" y1="1790.9587" y2="1790.9587"/><path d="M1887.5,1700 L1887.5,1733.8542 L1437.5833,1738.0208 L1887.5,1742.1875 L1887.5,1776.2939 A4.1667,4.1667 0 0 0 1891.6667,1780.4606 L2086.4583,1780.4606 A4.1667,4.1667 0 0 0 2090.625,1776.2939 L2090.625,1706.25 L2080.2083,1695.8333 L1891.6667,1695.8333 A4.1667,4.1667 0 0 0 1887.5,1700 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><path d="M2080.2083,1695.8333 L2080.2083,1704.1667 A2.0833,2.0833 0 0 0 2082.2917,1706.25 L2090.625,1706.25 L2080.2083,1695.8333 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="160.4167" x="1898.9583" y="1719.342">`rewrite_inference_op_`</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="146.875" x="1898.9583" y="1735.2905">is always true for GPU.</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="158.3333" x="1903.125" y="1751.239">All three of them are set</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="170.8333" x="1898.9583" y="1767.1875">to true by default for GPU.</text><!--MD5=[ccbdf6b1e3a5d3a43de30dedc5780086]
class CudnnBatchNormRewriter--><rect codeLine="96" height="50.9949" id="CudnnBatchNormRewriter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="186.4583" x="1248.4375" y="2834.375"/><ellipse cx="1263.0208" cy="2851.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1264.9312,2855.9642 Q1264.504,2856.1839 1264.034,2856.2937 Q1263.564,2856.4036 1263.0452,2856.4036 Q1261.202,2856.4036 1260.2315,2855.189 Q1259.2611,2853.9744 1259.2611,2851.6795 Q1259.2611,2849.3785 1260.2315,2848.1639 Q1261.202,2846.9493 1263.0452,2846.9493 Q1263.564,2846.9493 1264.0401,2847.0591 Q1264.5162,2847.169 1264.9312,2847.3887 L1264.9312,2849.3907 Q1264.4674,2848.9634 1264.031,2848.7651 Q1263.5946,2848.5667 1263.1307,2848.5667 Q1262.1419,2848.5667 1261.6384,2849.351 Q1261.1348,2850.1353 1261.1348,2851.6795 Q1261.1348,2853.2176 1261.6384,2854.0019 Q1262.1419,2854.7862 1263.1307,2854.7862 Q1263.5946,2854.7862 1264.031,2854.5878 Q1264.4674,2854.3894 1264.9312,2853.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="144.7917" x="1281.7708" y="2855.8695">CudnnBatchNormRewriter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1249.4792" x2="1433.8542" y1="2868.7032" y2="2868.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1249.4792" x2="1433.8542" y1="2877.0365" y2="2877.0365"/><!--MD5=[d30e6aa227dd12d844d44b68e468ea15]
class LogisticExpander--><rect codeLine="97" height="50.9949" id="LogisticExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="138.5417" x="1919.7917" y="853.125"/><ellipse cx="1934.375" cy="870.2891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1936.2854,874.7142 Q1935.8582,874.9339 1935.3882,875.0437 Q1934.9182,875.1536 1934.3994,875.1536 Q1932.5562,875.1536 1931.5857,873.939 Q1930.6152,872.7244 1930.6152,870.4295 Q1930.6152,868.1285 1931.5857,866.9139 Q1932.5562,865.6993 1934.3994,865.6993 Q1934.9182,865.6993 1935.3943,865.8091 Q1935.8704,865.919 1936.2854,866.1387 L1936.2854,868.1407 Q1935.8215,867.7134 1935.3851,867.5151 Q1934.9487,867.3167 1934.4849,867.3167 Q1933.4961,867.3167 1932.9926,868.101 Q1932.489,868.8853 1932.489,870.4295 Q1932.489,871.9676 1932.9926,872.7519 Q1933.4961,873.5362 1934.4849,873.5362 Q1934.9487,873.5362 1935.3851,873.3378 Q1935.8215,873.1394 1936.2854,872.7122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="96.875" x="1953.125" y="874.6195">LogisticExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1920.8333" x2="2057.2917" y1="887.4532" y2="887.4532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1920.8333" x2="2057.2917" y1="895.7865" y2="895.7865"/><!--MD5=[8337964b03dadab9a25ff06f9a3eb452]
class ConditionalCanonicalizer--><rect codeLine="98" height="50.9949" id="ConditionalCanonicalizer" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="182.2917" x="1250.5208" y="2921.875"/><ellipse cx="1265.1042" cy="2939.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1267.0146,2943.4642 Q1266.5873,2943.6839 1266.1174,2943.7937 Q1265.6474,2943.9036 1265.1286,2943.9036 Q1263.2853,2943.9036 1262.3149,2942.689 Q1261.3444,2941.4744 1261.3444,2939.1795 Q1261.3444,2936.8785 1262.3149,2935.6639 Q1263.2853,2934.4493 1265.1286,2934.4493 Q1265.6474,2934.4493 1266.1235,2934.5591 Q1266.5995,2934.669 1267.0146,2934.8887 L1267.0146,2936.8907 Q1266.5507,2936.4634 1266.1143,2936.2651 Q1265.6779,2936.0667 1265.214,2936.0667 Q1264.2253,2936.0667 1263.7217,2936.851 Q1263.2182,2937.6353 1263.2182,2939.1795 Q1263.2182,2940.7176 1263.7217,2941.5019 Q1264.2253,2942.2862 1265.214,2942.2862 Q1265.6779,2942.2862 1266.1143,2942.0878 Q1266.5507,2941.8894 1267.0146,2941.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="140.625" x="1283.8542" y="2943.3695">ConditionalCanonicalizer</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1251.5625" x2="1431.7708" y1="2956.2032" y2="2956.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1251.5625" x2="1431.7708" y1="2964.5365" y2="2964.5365"/><!--MD5=[994b040da0427846358f8f7e28c434f0]
class DynamicDimensionSimplifier--><rect codeLine="99" height="50.9949" id="DynamicDimensionSimplifier" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="201.0417" x="1241.1458" y="3009.375"/><ellipse cx="1255.7292" cy="3026.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1257.6396,3030.9642 Q1257.2123,3031.1839 1256.7424,3031.2937 Q1256.2724,3031.4036 1255.7536,3031.4036 Q1253.9103,3031.4036 1252.9399,3030.189 Q1251.9694,3028.9744 1251.9694,3026.6795 Q1251.9694,3024.3785 1252.9399,3023.1639 Q1253.9103,3021.9493 1255.7536,3021.9493 Q1256.2724,3021.9493 1256.7485,3022.0591 Q1257.2245,3022.169 1257.6396,3022.3887 L1257.6396,3024.3907 Q1257.1757,3023.9634 1256.7393,3023.7651 Q1256.3029,3023.5667 1255.839,3023.5667 Q1254.8503,3023.5667 1254.3467,3024.351 Q1253.8432,3025.1353 1253.8432,3026.6795 Q1253.8432,3028.2176 1254.3467,3029.0019 Q1254.8503,3029.7862 1255.839,3029.7862 Q1256.3029,3029.7862 1256.7393,3029.5878 Q1257.1757,3029.3894 1257.6396,3028.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="159.375" x="1274.4792" y="3030.8695">DynamicDimensionSimplifier</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1242.1875" x2="1441.1458" y1="3043.7032" y2="3043.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1242.1875" x2="1441.1458" y1="3052.0365" y2="3052.0365"/><!--MD5=[048c45286674a57084ee3b7fe3b3882b]
class DynamicPadder--><rect codeLine="100" height="50.9949" id="DynamicPadder" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="128.125" x="1277.6042" y="3096.875"/><ellipse cx="1292.1875" cy="3114.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1294.0979,3118.4642 Q1293.6707,3118.6839 1293.2007,3118.7937 Q1292.7307,3118.9036 1292.2119,3118.9036 Q1290.3687,3118.9036 1289.3982,3117.689 Q1288.4277,3116.4744 1288.4277,3114.1795 Q1288.4277,3111.8785 1289.3982,3110.6639 Q1290.3687,3109.4493 1292.2119,3109.4493 Q1292.7307,3109.4493 1293.2068,3109.5591 Q1293.6829,3109.669 1294.0979,3109.8887 L1294.0979,3111.8907 Q1293.634,3111.4634 1293.1976,3111.2651 Q1292.7612,3111.0667 1292.2974,3111.0667 Q1291.3086,3111.0667 1290.8051,3111.851 Q1290.3015,3112.6353 1290.3015,3114.1795 Q1290.3015,3115.7176 1290.8051,3116.5019 Q1291.3086,3117.2862 1292.2974,3117.2862 Q1292.7612,3117.2862 1293.1976,3117.0878 Q1293.634,3116.8894 1294.0979,3116.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="86.4583" x="1310.9375" y="3118.3695">DynamicPadder</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1278.6458" x2="1404.6875" y1="3131.2032" y2="3131.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1278.6458" x2="1404.6875" y1="3139.5365" y2="3139.5365"/><!--MD5=[4ba81c803aa0c7dc5e145db685d851dc]
class GatherExpander--><rect codeLine="101" height="50.9949" id="GatherExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="132.2917" x="1922.9167" y="940.625"/><ellipse cx="1937.5" cy="957.7891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1939.4104,962.2142 Q1938.9832,962.4339 1938.5132,962.5437 Q1938.0432,962.6536 1937.5244,962.6536 Q1935.6812,962.6536 1934.7107,961.439 Q1933.7402,960.2244 1933.7402,957.9295 Q1933.7402,955.6285 1934.7107,954.4139 Q1935.6812,953.1993 1937.5244,953.1993 Q1938.0432,953.1993 1938.5193,953.3091 Q1938.9954,953.419 1939.4104,953.6387 L1939.4104,955.6407 Q1938.9465,955.2134 1938.5101,955.0151 Q1938.0737,954.8167 1937.6099,954.8167 Q1936.6211,954.8167 1936.1176,955.601 Q1935.614,956.3853 1935.614,957.9295 Q1935.614,959.4676 1936.1176,960.2519 Q1936.6211,961.0362 1937.6099,961.0362 Q1938.0737,961.0362 1938.5101,960.8378 Q1938.9465,960.6394 1939.4104,960.2122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="90.625" x="1956.25" y="962.1195">GatherExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1923.9583" x2="2054.1667" y1="974.9532" y2="974.9532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1923.9583" x2="2054.1667" y1="983.2865" y2="983.2865"/><!--MD5=[0f727e651a9f1681443e9658d859fd87]
class AlgebraicSimplifier--><rect codeLine="103" height="50.9949" id="AlgebraicSimplifier" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="146.875" x="1268.2292" y="2361.4583"/><ellipse cx="1282.8125" cy="2378.6224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1284.7229,2383.0475 Q1284.2957,2383.2672 1283.8257,2383.3771 Q1283.3557,2383.4869 1282.8369,2383.4869 Q1280.9937,2383.4869 1280.0232,2382.2723 Q1279.0527,2381.0577 1279.0527,2378.7628 Q1279.0527,2376.4618 1280.0232,2375.2472 Q1280.9937,2374.0326 1282.8369,2374.0326 Q1283.3557,2374.0326 1283.8318,2374.1425 Q1284.3079,2374.2523 1284.7229,2374.472 L1284.7229,2376.474 Q1284.259,2376.0468 1283.8226,2375.8484 Q1283.3862,2375.65 1282.9224,2375.65 Q1281.9336,2375.65 1281.4301,2376.4343 Q1280.9265,2377.2186 1280.9265,2378.7628 Q1280.9265,2380.3009 1281.4301,2381.0852 Q1281.9336,2381.8695 1282.9224,2381.8695 Q1283.3862,2381.8695 1283.8226,2381.6711 Q1284.259,2381.4728 1284.7229,2381.0455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="105.2083" x="1301.5625" y="2382.9529">AlgebraicSimplifier</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1269.2708" x2="1414.0625" y1="2395.7865" y2="2395.7865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1269.2708" x2="1414.0625" y1="2404.1199" y2="2404.1199"/><!--MD5=[aadb54f9e7c7a585516ab6b5831c9d9c]
class BitcastDtypesExpander--><rect codeLine="104" height="50.9949" id="BitcastDtypesExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="169.7917" x="1904.1667" y="1028.125"/><ellipse cx="1918.75" cy="1045.2891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1920.6604,1049.7142 Q1920.2332,1049.9339 1919.7632,1050.0437 Q1919.2932,1050.1536 1918.7744,1050.1536 Q1916.9312,1050.1536 1915.9607,1048.939 Q1914.9902,1047.7244 1914.9902,1045.4295 Q1914.9902,1043.1285 1915.9607,1041.9139 Q1916.9312,1040.6993 1918.7744,1040.6993 Q1919.2932,1040.6993 1919.7693,1040.8091 Q1920.2454,1040.919 1920.6604,1041.1387 L1920.6604,1043.1407 Q1920.1965,1042.7134 1919.7601,1042.5151 Q1919.3237,1042.3167 1918.8599,1042.3167 Q1917.8711,1042.3167 1917.3676,1043.101 Q1916.864,1043.8853 1916.864,1045.4295 Q1916.864,1046.9676 1917.3676,1047.7519 Q1917.8711,1048.5362 1918.8599,1048.5362 Q1919.3237,1048.5362 1919.7601,1048.3378 Q1920.1965,1048.1394 1920.6604,1047.7122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="128.125" x="1937.5" y="1049.6195">BitcastDtypesExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1905.2083" x2="2072.9167" y1="1062.4532" y2="1062.4532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1905.2083" x2="2072.9167" y1="1070.7865" y2="1070.7865"/><!--MD5=[e90d1ede78cb955bdce2ff7b808aee6b]
class DotMerger--><rect codeLine="106" height="50.9949" id="DotMerger" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="101.0417" x="1291.1458" y="3271.875"/><ellipse cx="1305.7292" cy="3289.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1307.6396,3293.4642 Q1307.2123,3293.6839 1306.7424,3293.7937 Q1306.2724,3293.9036 1305.7536,3293.9036 Q1303.9103,3293.9036 1302.9399,3292.689 Q1301.9694,3291.4744 1301.9694,3289.1795 Q1301.9694,3286.8785 1302.9399,3285.6639 Q1303.9103,3284.4493 1305.7536,3284.4493 Q1306.2724,3284.4493 1306.7485,3284.5591 Q1307.2245,3284.669 1307.6396,3284.8887 L1307.6396,3286.8907 Q1307.1757,3286.4634 1306.7393,3286.2651 Q1306.3029,3286.0667 1305.839,3286.0667 Q1304.8503,3286.0667 1304.3467,3286.851 Q1303.8432,3287.6353 1303.8432,3289.1795 Q1303.8432,3290.7176 1304.3467,3291.5019 Q1304.8503,3292.2862 1305.839,3292.2862 Q1306.3029,3292.2862 1306.7393,3292.0878 Q1307.1757,3291.8894 1307.6396,3291.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="59.375" x="1324.4792" y="3293.3695">DotMerger</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1292.1875" x2="1391.1458" y1="3306.2032" y2="3306.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1292.1875" x2="1391.1458" y1="3314.5365" y2="3314.5365"/><!--MD5=[fce9bac126d38c9ca385d6cdd16e73ed]
class SortSimplifier--><rect codeLine="107" height="50.9949" id="SortSimplifier" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="116.6667" x="1283.3333" y="3359.375"/><ellipse cx="1297.9167" cy="3376.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1299.8271,3380.9642 Q1299.3998,3381.1839 1298.9299,3381.2937 Q1298.4599,3381.4036 1297.9411,3381.4036 Q1296.0978,3381.4036 1295.1274,3380.189 Q1294.1569,3378.9744 1294.1569,3376.6795 Q1294.1569,3374.3785 1295.1274,3373.1639 Q1296.0978,3371.9493 1297.9411,3371.9493 Q1298.4599,3371.9493 1298.936,3372.0591 Q1299.412,3372.169 1299.8271,3372.3887 L1299.8271,3374.3907 Q1299.3632,3373.9634 1298.9268,3373.7651 Q1298.4904,3373.5667 1298.0265,3373.5667 Q1297.0378,3373.5667 1296.5342,3374.351 Q1296.0307,3375.1353 1296.0307,3376.6795 Q1296.0307,3378.2176 1296.5342,3379.0019 Q1297.0378,3379.7862 1298.0265,3379.7862 Q1298.4904,3379.7862 1298.9268,3379.5878 Q1299.3632,3379.3894 1299.8271,3378.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="75" x="1316.6667" y="3380.8695">SortSimplifier</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1284.375" x2="1398.9583" y1="3393.7032" y2="3393.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1284.375" x2="1398.9583" y1="3402.0365" y2="3402.0365"/><!--MD5=[4e98d3ac1e50365204ec4cdb5b79972b]
class TupleSimplifier--><rect codeLine="108" height="50.9949" id="TupleSimplifier" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="125" x="1279.1667" y="3446.875"/><ellipse cx="1293.75" cy="3464.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1295.6604,3468.4642 Q1295.2332,3468.6839 1294.7632,3468.7937 Q1294.2932,3468.9036 1293.7744,3468.9036 Q1291.9312,3468.9036 1290.9607,3467.689 Q1289.9902,3466.4744 1289.9902,3464.1795 Q1289.9902,3461.8785 1290.9607,3460.6639 Q1291.9312,3459.4493 1293.7744,3459.4493 Q1294.2932,3459.4493 1294.7693,3459.5591 Q1295.2454,3459.669 1295.6604,3459.8887 L1295.6604,3461.8907 Q1295.1965,3461.4634 1294.7601,3461.2651 Q1294.3237,3461.0667 1293.8599,3461.0667 Q1292.8711,3461.0667 1292.3676,3461.851 Q1291.864,3462.6353 1291.864,3464.1795 Q1291.864,3465.7176 1292.3676,3466.5019 Q1292.8711,3467.2862 1293.8599,3467.2862 Q1294.3237,3467.2862 1294.7601,3467.0878 Q1295.1965,3466.8894 1295.6604,3466.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="83.3333" x="1312.5" y="3468.3695">TupleSimplifier</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1280.2083" x2="1403.125" y1="3481.2032" y2="3481.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1280.2083" x2="1403.125" y1="3489.5365" y2="3489.5365"/><!--MD5=[4490916b6dd9dab6fad70dba881b2109]
class WhileLoopConstantSinking--><rect codeLine="109" height="50.9949" id="WhileLoopConstantSinking" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="190.625" x="1246.3542" y="3534.375"/><ellipse cx="1260.9375" cy="3551.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1262.8479,3555.9642 Q1262.4207,3556.1839 1261.9507,3556.2937 Q1261.4807,3556.4036 1260.9619,3556.4036 Q1259.1187,3556.4036 1258.1482,3555.189 Q1257.1777,3553.9744 1257.1777,3551.6795 Q1257.1777,3549.3785 1258.1482,3548.1639 Q1259.1187,3546.9493 1260.9619,3546.9493 Q1261.4807,3546.9493 1261.9568,3547.0591 Q1262.4329,3547.169 1262.8479,3547.3887 L1262.8479,3549.3907 Q1262.384,3548.9634 1261.9476,3548.7651 Q1261.5112,3548.5667 1261.0474,3548.5667 Q1260.0586,3548.5667 1259.5551,3549.351 Q1259.0515,3550.1353 1259.0515,3551.6795 Q1259.0515,3553.2176 1259.5551,3554.0019 Q1260.0586,3554.7862 1261.0474,3554.7862 Q1261.5112,3554.7862 1261.9476,3554.5878 Q1262.384,3554.3894 1262.8479,3553.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="148.9583" x="1279.6875" y="3555.8695">WhileLoopConstantSinking</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1247.3958" x2="1435.9375" y1="3568.7032" y2="3568.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1247.3958" x2="1435.9375" y1="3577.0365" y2="3577.0365"/><!--MD5=[de316da9d43eb509aea687234180a36a]
class WhileLoopSimplifier--><rect codeLine="110" height="50.9949" id="WhileLoopSimplifier" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="151.0417" x="1266.1458" y="3621.875"/><ellipse cx="1280.7292" cy="3639.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1282.6396,3643.4642 Q1282.2123,3643.6839 1281.7424,3643.7937 Q1281.2724,3643.9036 1280.7536,3643.9036 Q1278.9103,3643.9036 1277.9399,3642.689 Q1276.9694,3641.4744 1276.9694,3639.1795 Q1276.9694,3636.8785 1277.9399,3635.6639 Q1278.9103,3634.4493 1280.7536,3634.4493 Q1281.2724,3634.4493 1281.7485,3634.5591 Q1282.2245,3634.669 1282.6396,3634.8887 L1282.6396,3636.8907 Q1282.1757,3636.4634 1281.7393,3636.2651 Q1281.3029,3636.0667 1280.839,3636.0667 Q1279.8503,3636.0667 1279.3467,3636.851 Q1278.8432,3637.6353 1278.8432,3639.1795 Q1278.8432,3640.7176 1279.3467,3641.5019 Q1279.8503,3642.2862 1280.839,3642.2862 Q1281.3029,3642.2862 1281.7393,3642.0878 Q1282.1757,3641.8894 1282.6396,3641.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="109.375" x="1299.4792" y="3643.3695">WhileLoopSimplifier</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1267.1875" x2="1416.1458" y1="3656.2032" y2="3656.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1267.1875" x2="1416.1458" y1="3664.5365" y2="3664.5365"/><!--MD5=[4d797e3167baa70ae7da3bef8825771b]
class SliceSinker--><rect codeLine="111" height="50.9949" id="SliceSinker" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="101.0417" x="1291.1458" y="3709.375"/><ellipse cx="1305.7292" cy="3726.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1307.6396,3730.9642 Q1307.2123,3731.1839 1306.7424,3731.2937 Q1306.2724,3731.4036 1305.7536,3731.4036 Q1303.9103,3731.4036 1302.9399,3730.189 Q1301.9694,3728.9744 1301.9694,3726.6795 Q1301.9694,3724.3785 1302.9399,3723.1639 Q1303.9103,3721.9493 1305.7536,3721.9493 Q1306.2724,3721.9493 1306.7485,3722.0591 Q1307.2245,3722.169 1307.6396,3722.3887 L1307.6396,3724.3907 Q1307.1757,3723.9634 1306.7393,3723.7651 Q1306.3029,3723.5667 1305.839,3723.5667 Q1304.8503,3723.5667 1304.3467,3724.351 Q1303.8432,3725.1353 1303.8432,3726.6795 Q1303.8432,3728.2176 1304.3467,3729.0019 Q1304.8503,3729.7862 1305.839,3729.7862 Q1306.3029,3729.7862 1306.7393,3729.5878 Q1307.1757,3729.3894 1307.6396,3728.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="59.375" x="1324.4792" y="3730.8695">SliceSinker</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1292.1875" x2="1391.1458" y1="3743.7032" y2="3743.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1292.1875" x2="1391.1458" y1="3752.0365" y2="3752.0365"/><!--MD5=[ecaa196b0f3ef97d177414e4bb4e2e34]
class ReshapeMover--><rect codeLine="112" height="50.9949" id="ReshapeMover" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="122.9167" x="1280.2083" y="3796.875"/><ellipse cx="1294.7917" cy="3814.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1296.7021,3818.4642 Q1296.2748,3818.6839 1295.8049,3818.7937 Q1295.3349,3818.9036 1294.8161,3818.9036 Q1292.9728,3818.9036 1292.0024,3817.689 Q1291.0319,3816.4744 1291.0319,3814.1795 Q1291.0319,3811.8785 1292.0024,3810.6639 Q1292.9728,3809.4493 1294.8161,3809.4493 Q1295.3349,3809.4493 1295.811,3809.5591 Q1296.287,3809.669 1296.7021,3809.8887 L1296.7021,3811.8907 Q1296.2382,3811.4634 1295.8018,3811.2651 Q1295.3654,3811.0667 1294.9015,3811.0667 Q1293.9128,3811.0667 1293.4092,3811.851 Q1292.9057,3812.6353 1292.9057,3814.1795 Q1292.9057,3815.7176 1293.4092,3816.5019 Q1293.9128,3817.2862 1294.9015,3817.2862 Q1295.3654,3817.2862 1295.8018,3817.0878 Q1296.2382,3816.8894 1296.7021,3816.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="81.25" x="1313.5417" y="3818.3695">ReshapeMover</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1281.25" x2="1402.0833" y1="3831.2032" y2="3831.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1281.25" x2="1402.0833" y1="3839.5365" y2="3839.5365"/><!--MD5=[e71fefa98ae31a0eeeb4b11d1158c535]
class HloConstantFolding--><rect codeLine="113" height="50.9949" id="HloConstantFolding" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="153.125" x="1265.1042" y="3884.375"/><ellipse cx="1279.6875" cy="3901.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1281.5979,3905.9642 Q1281.1707,3906.1839 1280.7007,3906.2937 Q1280.2307,3906.4036 1279.7119,3906.4036 Q1277.8687,3906.4036 1276.8982,3905.189 Q1275.9277,3903.9744 1275.9277,3901.6795 Q1275.9277,3899.3785 1276.8982,3898.1639 Q1277.8687,3896.9493 1279.7119,3896.9493 Q1280.2307,3896.9493 1280.7068,3897.0591 Q1281.1829,3897.169 1281.5979,3897.3887 L1281.5979,3899.3907 Q1281.134,3898.9634 1280.6976,3898.7651 Q1280.2612,3898.5667 1279.7974,3898.5667 Q1278.8086,3898.5667 1278.3051,3899.351 Q1277.8015,3900.1353 1277.8015,3901.6795 Q1277.8015,3903.2176 1278.3051,3904.0019 Q1278.8086,3904.7862 1279.7974,3904.7862 Q1280.2612,3904.7862 1280.6976,3904.5878 Q1281.134,3904.3894 1281.5979,3903.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="111.4583" x="1298.4375" y="3905.8695">HloConstantFolding</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1266.1458" x2="1417.1875" y1="3918.7032" y2="3918.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1266.1458" x2="1417.1875" y1="3927.0365" y2="3927.0365"/><!--MD5=[1134a9e93d4c39a00f7318c1b99715b6]
class ConditionalSimplifier--><rect codeLine="114" height="50.9949" id="ConditionalSimplifier" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="158.3333" x="1262.5" y="3971.875"/><ellipse cx="1277.0833" cy="3989.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1278.9937,3993.4642 Q1278.5665,3993.6839 1278.0965,3993.7937 Q1277.6265,3993.9036 1277.1077,3993.9036 Q1275.2645,3993.9036 1274.294,3992.689 Q1273.3236,3991.4744 1273.3236,3989.1795 Q1273.3236,3986.8785 1274.294,3985.6639 Q1275.2645,3984.4493 1277.1077,3984.4493 Q1277.6265,3984.4493 1278.1026,3984.5591 Q1278.5787,3984.669 1278.9937,3984.8887 L1278.9937,3986.8907 Q1278.5299,3986.4634 1278.0935,3986.2651 Q1277.6571,3986.0667 1277.1932,3986.0667 Q1276.2044,3986.0667 1275.7009,3986.851 Q1275.1973,3987.6353 1275.1973,3989.1795 Q1275.1973,3990.7176 1275.7009,3991.5019 Q1276.2044,3992.2862 1277.1932,3992.2862 Q1277.6571,3992.2862 1278.0935,3992.0878 Q1278.5299,3991.8894 1278.9937,3991.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="116.6667" x="1295.8333" y="3993.3695">ConditionalSimplifier</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1263.5417" x2="1419.7917" y1="4006.2032" y2="4006.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1263.5417" x2="1419.7917" y1="4014.5365" y2="4014.5365"/><!--MD5=[55f81d71ac91a422b862cc87aa46f8b5]
class RealImagExpander--><rect codeLine="115" height="50.9949" id="RealImagExpander" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="144.7917" x="1916.6667" y="1115.625"/><ellipse cx="1931.25" cy="1132.7891" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1933.1604,1137.2142 Q1932.7332,1137.4339 1932.2632,1137.5437 Q1931.7932,1137.6536 1931.2744,1137.6536 Q1929.4312,1137.6536 1928.4607,1136.439 Q1927.4902,1135.2244 1927.4902,1132.9295 Q1927.4902,1130.6285 1928.4607,1129.4139 Q1929.4312,1128.1993 1931.2744,1128.1993 Q1931.7932,1128.1993 1932.2693,1128.3091 Q1932.7454,1128.419 1933.1604,1128.6387 L1933.1604,1130.6407 Q1932.6965,1130.2134 1932.2601,1130.0151 Q1931.8237,1129.8167 1931.3599,1129.8167 Q1930.3711,1129.8167 1929.8676,1130.601 Q1929.364,1131.3853 1929.364,1132.9295 Q1929.364,1134.4676 1929.8676,1135.2519 Q1930.3711,1136.0362 1931.3599,1136.0362 Q1931.8237,1136.0362 1932.2601,1135.8378 Q1932.6965,1135.6394 1933.1604,1135.2122 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="1950" y="1137.1195">RealImagExpander</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1917.7083" x2="2060.4167" y1="1149.9532" y2="1149.9532"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1917.7083" x2="2060.4167" y1="1158.2865" y2="1158.2865"/><!--MD5=[a0ed7001bd69a59f7775a1acb26ca1fe]
class TransposeFolding--><rect codeLine="116" height="50.9949" id="TransposeFolding" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="142.7083" x="1270.3125" y="4059.375"/><ellipse cx="1284.8958" cy="4076.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1286.8062,4080.9642 Q1286.379,4081.1839 1285.909,4081.2937 Q1285.439,4081.4036 1284.9202,4081.4036 Q1283.077,4081.4036 1282.1065,4080.189 Q1281.1361,4078.9744 1281.1361,4076.6795 Q1281.1361,4074.3785 1282.1065,4073.1639 Q1283.077,4071.9493 1284.9202,4071.9493 Q1285.439,4071.9493 1285.9151,4072.0591 Q1286.3912,4072.169 1286.8062,4072.3887 L1286.8062,4074.3907 Q1286.3424,4073.9634 1285.906,4073.7651 Q1285.4696,4073.5667 1285.0057,4073.5667 Q1284.0169,4073.5667 1283.5134,4074.351 Q1283.0098,4075.1353 1283.0098,4076.6795 Q1283.0098,4078.2176 1283.5134,4079.0019 Q1284.0169,4079.7862 1285.0057,4079.7862 Q1285.4696,4079.7862 1285.906,4079.5878 Q1286.3424,4079.3894 1286.8062,4078.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="101.0417" x="1303.6458" y="4080.8695">TransposeFolding</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1271.3542" x2="1411.9792" y1="4093.7032" y2="4093.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1271.3542" x2="1411.9792" y1="4102.0365" y2="4102.0365"/><path d="M1891.1458,4062.5 L1891.1458,4080.7292 L1413.3021,4084.8958 L1891.1458,4089.0625 L1891.1458,4106.897 A4.1667,4.1667 0 0 0 1895.3125,4111.0636 L2082.8125,4111.0636 A4.1667,4.1667 0 0 0 2086.9792,4106.897 L2086.9792,4068.75 L2076.5625,4058.3333 L1895.3125,4058.3333 A4.1667,4.1667 0 0 0 1891.1458,4062.5 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><path d="M2076.5625,4058.3333 L2076.5625,4066.6667 A2.0833,2.0833 0 0 0 2078.6458,4068.75 L2086.9792,4068.75 L2076.5625,4058.3333 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="163.5417" x="1902.6042" y="4081.842">Fold transpose operators</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="125" x="1902.6042" y="4097.7905">into Dot operators.</text><!--MD5=[cc286ed29425b63079a2e7dc496abb9f]
class HloCSE--><rect codeLine="118" height="50.9949" id="HloCSE" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="81.25" x="1301.0417" y="4146.875"/><ellipse cx="1315.625" cy="4164.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1317.5354,4168.4642 Q1317.1082,4168.6839 1316.6382,4168.7937 Q1316.1682,4168.9036 1315.6494,4168.9036 Q1313.8062,4168.9036 1312.8357,4167.689 Q1311.8652,4166.4744 1311.8652,4164.1795 Q1311.8652,4161.8785 1312.8357,4160.6639 Q1313.8062,4159.4493 1315.6494,4159.4493 Q1316.1682,4159.4493 1316.6443,4159.5591 Q1317.1204,4159.669 1317.5354,4159.8887 L1317.5354,4161.8907 Q1317.0715,4161.4634 1316.6351,4161.2651 Q1316.1987,4161.0667 1315.7349,4161.0667 Q1314.7461,4161.0667 1314.2426,4161.851 Q1313.739,4162.6353 1313.739,4164.1795 Q1313.739,4165.7176 1314.2426,4166.5019 Q1314.7461,4167.2862 1315.7349,4167.2862 Q1316.1987,4167.2862 1316.6351,4167.0878 Q1317.0715,4166.8894 1317.5354,4166.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="39.5833" x="1334.375" y="4168.3695">HloCSE</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1302.0833" x2="1381.25" y1="4181.2032" y2="4181.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1302.0833" x2="1381.25" y1="4189.5365" y2="4189.5365"/><!--MD5=[81ec9de204cc01992df950177875508f]
class HloDCE--><rect codeLine="119" height="50.9949" id="HloDCE" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="83.3333" x="1300" y="4234.375"/><ellipse cx="1314.5833" cy="4251.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1316.4937,4255.9642 Q1316.0665,4256.1839 1315.5965,4256.2937 Q1315.1265,4256.4036 1314.6077,4256.4036 Q1312.7645,4256.4036 1311.794,4255.189 Q1310.8236,4253.9744 1310.8236,4251.6795 Q1310.8236,4249.3785 1311.794,4248.1639 Q1312.7645,4246.9493 1314.6077,4246.9493 Q1315.1265,4246.9493 1315.6026,4247.0591 Q1316.0787,4247.169 1316.4937,4247.3887 L1316.4937,4249.3907 Q1316.0299,4248.9634 1315.5935,4248.7651 Q1315.1571,4248.5667 1314.6932,4248.5667 Q1313.7044,4248.5667 1313.2009,4249.351 Q1312.6973,4250.1353 1312.6973,4251.6795 Q1312.6973,4253.2176 1313.2009,4254.0019 Q1313.7044,4254.7862 1314.6932,4254.7862 Q1315.1571,4254.7862 1315.5935,4254.5878 Q1316.0299,4254.3894 1316.4937,4253.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="41.6667" x="1333.3333" y="4255.8695">HloDCE</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1301.0417" x2="1382.2917" y1="4268.7032" y2="4268.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1301.0417" x2="1382.2917" y1="4277.0365" y2="4277.0365"/><!--MD5=[04d28b743cb3f829d16b0216cf1a0d0d]
class WhileLoopTripCountAnnotator--><rect codeLine="120" height="50.9949" id="WhileLoopTripCountAnnotator" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="213.5417" x="1234.8958" y="4321.875"/><ellipse cx="1249.4792" cy="4339.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1251.3896,4343.4642 Q1250.9623,4343.6839 1250.4924,4343.7937 Q1250.0224,4343.9036 1249.5036,4343.9036 Q1247.6603,4343.9036 1246.6899,4342.689 Q1245.7194,4341.4744 1245.7194,4339.1795 Q1245.7194,4336.8785 1246.6899,4335.6639 Q1247.6603,4334.4493 1249.5036,4334.4493 Q1250.0224,4334.4493 1250.4985,4334.5591 Q1250.9745,4334.669 1251.3896,4334.8887 L1251.3896,4336.8907 Q1250.9257,4336.4634 1250.4893,4336.2651 Q1250.0529,4336.0667 1249.589,4336.0667 Q1248.6003,4336.0667 1248.0967,4336.851 Q1247.5932,4337.6353 1247.5932,4339.1795 Q1247.5932,4340.7176 1248.0967,4341.5019 Q1248.6003,4342.2862 1249.589,4342.2862 Q1250.0529,4342.2862 1250.4893,4342.0878 Q1250.9257,4341.8894 1251.3896,4341.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="171.875" x="1268.2292" y="4343.3695">WhileLoopTripCountAnnotator</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1235.9375" x2="1447.3958" y1="4356.2032" y2="4356.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1235.9375" x2="1447.3958" y1="4364.5365" y2="4364.5365"/><!--MD5=[ff78e1321f497e0029e29cbadc15f0eb]
class AllReduceFolder--><rect codeLine="123" height="50.9949" id="AllReduceFolder" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="132.2917" x="1275.5208" y="4409.375"/><ellipse cx="1290.1042" cy="4426.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1292.0146,4430.9642 Q1291.5873,4431.1839 1291.1174,4431.2937 Q1290.6474,4431.4036 1290.1286,4431.4036 Q1288.2853,4431.4036 1287.3149,4430.189 Q1286.3444,4428.9744 1286.3444,4426.6795 Q1286.3444,4424.3785 1287.3149,4423.1639 Q1288.2853,4421.9493 1290.1286,4421.9493 Q1290.6474,4421.9493 1291.1235,4422.0591 Q1291.5995,4422.169 1292.0146,4422.3887 L1292.0146,4424.3907 Q1291.5507,4423.9634 1291.1143,4423.7651 Q1290.6779,4423.5667 1290.214,4423.5667 Q1289.2253,4423.5667 1288.7217,4424.351 Q1288.2182,4425.1353 1288.2182,4426.6795 Q1288.2182,4428.2176 1288.7217,4429.0019 Q1289.2253,4429.7862 1290.214,4429.7862 Q1290.6779,4429.7862 1291.1143,4429.5878 Q1291.5507,4429.3894 1292.0146,4428.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="90.625" x="1308.8542" y="4430.8695">AllReduceFolder</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1276.5625" x2="1406.7708" y1="4443.7032" y2="4443.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1276.5625" x2="1406.7708" y1="4452.0365" y2="4452.0365"/><!--MD5=[a639e71c1e99874ca6beb12eee24c626]
class ReduceScatterCreator--><rect codeLine="124" height="50.9949" id="ReduceScatterCreator" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="163.5417" x="1259.8958" y="4496.875"/><ellipse cx="1274.4792" cy="4514.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1276.3896,4518.4642 Q1275.9623,4518.6839 1275.4924,4518.7937 Q1275.0224,4518.9036 1274.5036,4518.9036 Q1272.6603,4518.9036 1271.6899,4517.689 Q1270.7194,4516.4744 1270.7194,4514.1795 Q1270.7194,4511.8785 1271.6899,4510.6639 Q1272.6603,4509.4493 1274.5036,4509.4493 Q1275.0224,4509.4493 1275.4985,4509.5591 Q1275.9745,4509.669 1276.3896,4509.8887 L1276.3896,4511.8907 Q1275.9257,4511.4634 1275.4893,4511.2651 Q1275.0529,4511.0667 1274.589,4511.0667 Q1273.6003,4511.0667 1273.0967,4511.851 Q1272.5932,4512.6353 1272.5932,4514.1795 Q1272.5932,4515.7176 1273.0967,4516.5019 Q1273.6003,4517.2862 1274.589,4517.2862 Q1275.0529,4517.2862 1275.4893,4517.0878 Q1275.9257,4516.8894 1276.3896,4516.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="121.875" x="1293.2292" y="4518.3695">ReduceScatterCreator</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1260.9375" x2="1422.3958" y1="4531.2032" y2="4531.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1260.9375" x2="1422.3958" y1="4539.5365" y2="4539.5365"/><!--MD5=[5fa0e07977f52eacb4ea215509689634]
class AllReduceReassociate--><rect codeLine="125" height="50.9949" id="AllReduceReassociate" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="162.5" x="1260.4167" y="4584.375"/><ellipse cx="1275" cy="4601.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1276.9104,4605.9642 Q1276.4832,4606.1839 1276.0132,4606.2937 Q1275.5432,4606.4036 1275.0244,4606.4036 Q1273.1812,4606.4036 1272.2107,4605.189 Q1271.2402,4603.9744 1271.2402,4601.6795 Q1271.2402,4599.3785 1272.2107,4598.1639 Q1273.1812,4596.9493 1275.0244,4596.9493 Q1275.5432,4596.9493 1276.0193,4597.0591 Q1276.4954,4597.169 1276.9104,4597.3887 L1276.9104,4599.3907 Q1276.4465,4598.9634 1276.0101,4598.7651 Q1275.5737,4598.5667 1275.1099,4598.5667 Q1274.1211,4598.5667 1273.6176,4599.351 Q1273.114,4600.1353 1273.114,4601.6795 Q1273.114,4603.2176 1273.6176,4604.0019 Q1274.1211,4604.7862 1275.1099,4604.7862 Q1275.5737,4604.7862 1276.0101,4604.5878 Q1276.4465,4604.3894 1276.9104,4603.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="120.8333" x="1293.75" y="4605.8695">AllReduceReassociate</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1261.4583" x2="1421.875" y1="4618.7032" y2="4618.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1261.4583" x2="1421.875" y1="4627.0365" y2="4627.0365"/><!--MD5=[26ddd15be2164c44d2cbe00cb6424219]
class AllGatherBroadcastReorder--><rect codeLine="126" height="50.9949" id="AllGatherBroadcastReorder" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="193.75" x="1244.7917" y="4671.875"/><ellipse cx="1259.375" cy="4689.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1261.2854,4693.4642 Q1260.8582,4693.6839 1260.3882,4693.7937 Q1259.9182,4693.9036 1259.3994,4693.9036 Q1257.5562,4693.9036 1256.5857,4692.689 Q1255.6152,4691.4744 1255.6152,4689.1795 Q1255.6152,4686.8785 1256.5857,4685.6639 Q1257.5562,4684.4493 1259.3994,4684.4493 Q1259.9182,4684.4493 1260.3943,4684.5591 Q1260.8704,4684.669 1261.2854,4684.8887 L1261.2854,4686.8907 Q1260.8215,4686.4634 1260.3851,4686.2651 Q1259.9487,4686.0667 1259.4849,4686.0667 Q1258.4961,4686.0667 1257.9926,4686.851 Q1257.489,4687.6353 1257.489,4689.1795 Q1257.489,4690.7176 1257.9926,4691.5019 Q1258.4961,4692.2862 1259.4849,4692.2862 Q1259.9487,4692.2862 1260.3851,4692.0878 Q1260.8215,4691.8894 1261.2854,4691.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="152.0833" x="1278.125" y="4693.3695">AllGatherBroadcastReorder</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1245.8333" x2="1437.5" y1="4706.2032" y2="4706.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1245.8333" x2="1437.5" y1="4714.5365" y2="4714.5365"/><!--MD5=[5d7a770011863580e0bee68e22ea7fe3]
class GpusolverRewriter--><rect codeLine="130" height="50.9949" id="GpusolverRewriter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="144.7917" x="1269.2708" y="4759.375"/><ellipse cx="1283.8542" cy="4776.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1285.7646,4780.9642 Q1285.3373,4781.1839 1284.8674,4781.2937 Q1284.3974,4781.4036 1283.8786,4781.4036 Q1282.0353,4781.4036 1281.0649,4780.189 Q1280.0944,4778.9744 1280.0944,4776.6795 Q1280.0944,4774.3785 1281.0649,4773.1639 Q1282.0353,4771.9493 1283.8786,4771.9493 Q1284.3974,4771.9493 1284.8735,4772.0591 Q1285.3495,4772.169 1285.7646,4772.3887 L1285.7646,4774.3907 Q1285.3007,4773.9634 1284.8643,4773.7651 Q1284.4279,4773.5667 1283.964,4773.5667 Q1282.9753,4773.5667 1282.4717,4774.351 Q1281.9682,4775.1353 1281.9682,4776.6795 Q1281.9682,4778.2176 1282.4717,4779.0019 Q1282.9753,4779.7862 1283.964,4779.7862 Q1284.4279,4779.7862 1284.8643,4779.5878 Q1285.3007,4779.3894 1285.7646,4778.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="103.125" x="1302.6042" y="4780.8695">GpusolverRewriter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1270.3125" x2="1413.0208" y1="4793.7032" y2="4793.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1270.3125" x2="1413.0208" y1="4802.0365" y2="4802.0365"/><!--MD5=[5df08ab906abb15c112ffad29c3635b0]
class GpuConvRewriter--><rect codeLine="131" height="50.9949" id="GpuConvRewriter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="139.5833" x="1271.875" y="4846.875"/><ellipse cx="1286.4583" cy="4864.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1288.3687,4868.4642 Q1287.9415,4868.6839 1287.4715,4868.7937 Q1287.0015,4868.9036 1286.4827,4868.9036 Q1284.6395,4868.9036 1283.669,4867.689 Q1282.6986,4866.4744 1282.6986,4864.1795 Q1282.6986,4861.8785 1283.669,4860.6639 Q1284.6395,4859.4493 1286.4827,4859.4493 Q1287.0015,4859.4493 1287.4776,4859.5591 Q1287.9537,4859.669 1288.3687,4859.8887 L1288.3687,4861.8907 Q1287.9049,4861.4634 1287.4685,4861.2651 Q1287.0321,4861.0667 1286.5682,4861.0667 Q1285.5794,4861.0667 1285.0759,4861.851 Q1284.5723,4862.6353 1284.5723,4864.1795 Q1284.5723,4865.7176 1285.0759,4866.5019 Q1285.5794,4867.2862 1286.5682,4867.2862 Q1287.0321,4867.2862 1287.4685,4867.0878 Q1287.9049,4866.8894 1288.3687,4866.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="97.9167" x="1305.2083" y="4868.3695">GpuConvRewriter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1272.9167" x2="1410.4167" y1="4881.2032" y2="4881.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1272.9167" x2="1410.4167" y1="4889.5365" y2="4889.5365"/><!--MD5=[70cc836dec041aae99e780c4ae41cca6]
class GpuConvPaddingLegalization--><rect codeLine="132" height="50.9949" id="GpuConvPaddingLegalization" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="205.2083" x="1239.0625" y="4934.375"/><ellipse cx="1253.6458" cy="4951.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1255.5562,4955.9642 Q1255.129,4956.1839 1254.659,4956.2937 Q1254.189,4956.4036 1253.6702,4956.4036 Q1251.827,4956.4036 1250.8565,4955.189 Q1249.8861,4953.9744 1249.8861,4951.6795 Q1249.8861,4949.3785 1250.8565,4948.1639 Q1251.827,4946.9493 1253.6702,4946.9493 Q1254.189,4946.9493 1254.6651,4947.0591 Q1255.1412,4947.169 1255.5562,4947.3887 L1255.5562,4949.3907 Q1255.0924,4948.9634 1254.656,4948.7651 Q1254.2196,4948.5667 1253.7557,4948.5667 Q1252.7669,4948.5667 1252.2634,4949.351 Q1251.7598,4950.1353 1251.7598,4951.6795 Q1251.7598,4953.2176 1252.2634,4954.0019 Q1252.7669,4954.7862 1253.7557,4954.7862 Q1254.2196,4954.7862 1254.656,4954.5878 Q1255.0924,4954.3894 1255.5562,4953.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="163.5417" x="1272.3958" y="4955.8695">GpuConvPaddingLegalization</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1240.1042" x2="1443.2292" y1="4968.7032" y2="4968.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1240.1042" x2="1443.2292" y1="4977.0365" y2="4977.0365"/><!--MD5=[0e0282f91280ebc6cecbd95e9a512cfc]
class FlattenCallGraph--><rect codeLine="135" height="50.9949" id="FlattenCallGraph" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="134.375" x="1274.4792" y="5021.875"/><ellipse cx="1289.0625" cy="5039.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1290.9729,5043.4642 Q1290.5457,5043.6839 1290.0757,5043.7937 Q1289.6057,5043.9036 1289.0869,5043.9036 Q1287.2437,5043.9036 1286.2732,5042.689 Q1285.3027,5041.4744 1285.3027,5039.1795 Q1285.3027,5036.8785 1286.2732,5035.6639 Q1287.2437,5034.4493 1289.0869,5034.4493 Q1289.6057,5034.4493 1290.0818,5034.5591 Q1290.5579,5034.669 1290.9729,5034.8887 L1290.9729,5036.8907 Q1290.509,5036.4634 1290.0726,5036.2651 Q1289.6362,5036.0667 1289.1724,5036.0667 Q1288.1836,5036.0667 1287.6801,5036.851 Q1287.1765,5037.6353 1287.1765,5039.1795 Q1287.1765,5040.7176 1287.6801,5041.5019 Q1288.1836,5042.2862 1289.1724,5042.2862 Q1289.6362,5042.2862 1290.0726,5042.0878 Q1290.509,5041.8894 1290.9729,5041.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="92.7083" x="1307.8125" y="5043.3695">FlattenCallGraph</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1275.5208" x2="1407.8125" y1="5056.2032" y2="5056.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1275.5208" x2="1407.8125" y1="5064.5365" y2="5064.5365"/><!--MD5=[8ab3e99391ce03abd4e2b6feab309247]
class LayoutAssignment--><rect codeLine="136" height="50.9949" id="LayoutAssignment" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="145.8333" x="1268.75" y="5109.375"/><ellipse cx="1283.3333" cy="5126.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1285.2437,5130.9642 Q1284.8165,5131.1839 1284.3465,5131.2937 Q1283.8765,5131.4036 1283.3577,5131.4036 Q1281.5145,5131.4036 1280.544,5130.189 Q1279.5736,5128.9744 1279.5736,5126.6795 Q1279.5736,5124.3785 1280.544,5123.1639 Q1281.5145,5121.9493 1283.3577,5121.9493 Q1283.8765,5121.9493 1284.3526,5122.0591 Q1284.8287,5122.169 1285.2437,5122.3887 L1285.2437,5124.3907 Q1284.7799,5123.9634 1284.3435,5123.7651 Q1283.9071,5123.5667 1283.4432,5123.5667 Q1282.4544,5123.5667 1281.9509,5124.351 Q1281.4473,5125.1353 1281.4473,5126.6795 Q1281.4473,5128.2176 1281.9509,5129.0019 Q1282.4544,5129.7862 1283.4432,5129.7862 Q1283.9071,5129.7862 1284.3435,5129.5878 Q1284.7799,5129.3894 1285.2437,5128.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="104.1667" x="1302.0833" y="5130.8695">LayoutAssignment</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1269.7917" x2="1413.5417" y1="5143.7032" y2="5143.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1269.7917" x2="1413.5417" y1="5152.0365" y2="5152.0365"/><!--MD5=[e70a0cd23b00c5c4075d5bf6f676ab35]
class GpuLayoutAssignment--><rect codeLine="137" height="50.9949" id="GpuLayoutAssignment" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="168.75" x="1904.6875" y="5109.375"/><ellipse cx="1919.2708" cy="5126.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1921.1812,5130.9642 Q1920.754,5131.1839 1920.284,5131.2937 Q1919.814,5131.4036 1919.2952,5131.4036 Q1917.452,5131.4036 1916.4815,5130.189 Q1915.5111,5128.9744 1915.5111,5126.6795 Q1915.5111,5124.3785 1916.4815,5123.1639 Q1917.452,5121.9493 1919.2952,5121.9493 Q1919.814,5121.9493 1920.2901,5122.0591 Q1920.7662,5122.169 1921.1812,5122.3887 L1921.1812,5124.3907 Q1920.7174,5123.9634 1920.281,5123.7651 Q1919.8446,5123.5667 1919.3807,5123.5667 Q1918.3919,5123.5667 1917.8884,5124.351 Q1917.3848,5125.1353 1917.3848,5126.6795 Q1917.3848,5128.2176 1917.8884,5129.0019 Q1918.3919,5129.7862 1919.3807,5129.7862 Q1919.8446,5129.7862 1920.281,5129.5878 Q1920.7174,5129.3894 1921.1812,5128.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="127.0833" x="1938.0208" y="5130.8695">GpuLayoutAssignment</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1905.7292" x2="2072.3958" y1="5143.7032" y2="5143.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1905.7292" x2="2072.3958" y1="5152.0365" y2="5152.0365"/><!--MD5=[5a6705c70204c3bcb68e8542cd54ef5f]
class ReductionDegenerateDimRemover--><rect codeLine="141" height="50.9949" id="ReductionDegenerateDimRemover" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="232.2917" x="1225.5208" y="5196.875"/><ellipse cx="1240.1042" cy="5214.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1242.0146,5218.4642 Q1241.5873,5218.6839 1241.1174,5218.7937 Q1240.6474,5218.9036 1240.1286,5218.9036 Q1238.2853,5218.9036 1237.3149,5217.689 Q1236.3444,5216.4744 1236.3444,5214.1795 Q1236.3444,5211.8785 1237.3149,5210.6639 Q1238.2853,5209.4493 1240.1286,5209.4493 Q1240.6474,5209.4493 1241.1235,5209.5591 Q1241.5995,5209.669 1242.0146,5209.8887 L1242.0146,5211.8907 Q1241.5507,5211.4634 1241.1143,5211.2651 Q1240.6779,5211.0667 1240.214,5211.0667 Q1239.2253,5211.0667 1238.7217,5211.851 Q1238.2182,5212.6353 1238.2182,5214.1795 Q1238.2182,5215.7176 1238.7217,5216.5019 Q1239.2253,5217.2862 1240.214,5217.2862 Q1240.6779,5217.2862 1241.1143,5217.0878 Q1241.5507,5216.8894 1242.0146,5216.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="190.625" x="1258.8542" y="5218.3695">ReductionDegenerateDimRemover</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1226.5625" x2="1456.7708" y1="5231.2032" y2="5231.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1226.5625" x2="1456.7708" y1="5239.5365" y2="5239.5365"/><!--MD5=[a045d1fcbbaa73c2e41757e0853a796d]
class ReductionLayoutNormalizer--><rect codeLine="142" height="50.9949" id="ReductionLayoutNormalizer" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="196.875" x="1243.2292" y="5284.375"/><ellipse cx="1257.8125" cy="5301.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1259.7229,5305.9642 Q1259.2957,5306.1839 1258.8257,5306.2937 Q1258.3557,5306.4036 1257.8369,5306.4036 Q1255.9937,5306.4036 1255.0232,5305.189 Q1254.0527,5303.9744 1254.0527,5301.6795 Q1254.0527,5299.3785 1255.0232,5298.1639 Q1255.9937,5296.9493 1257.8369,5296.9493 Q1258.3557,5296.9493 1258.8318,5297.0591 Q1259.3079,5297.169 1259.7229,5297.3887 L1259.7229,5299.3907 Q1259.259,5298.9634 1258.8226,5298.7651 Q1258.3862,5298.5667 1257.9224,5298.5667 Q1256.9336,5298.5667 1256.4301,5299.351 Q1255.9265,5300.1353 1255.9265,5301.6795 Q1255.9265,5303.2176 1256.4301,5304.0019 Q1256.9336,5304.7862 1257.9224,5304.7862 Q1258.3862,5304.7862 1258.8226,5304.5878 Q1259.259,5304.3894 1259.7229,5303.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="155.2083" x="1276.5625" y="5305.8695">ReductionLayoutNormalizer</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1244.2708" x2="1439.0625" y1="5318.7032" y2="5318.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1244.2708" x2="1439.0625" y1="5327.0365" y2="5327.0365"/><!--MD5=[bd39bf9b4001032a9b67f7788187303e]
class ReductionDimensionGrouper--><rect codeLine="143" height="50.9949" id="ReductionDimensionGrouper" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="204.1667" x="1239.5833" y="5371.875"/><ellipse cx="1254.1667" cy="5389.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1256.0771,5393.4642 Q1255.6498,5393.6839 1255.1799,5393.7937 Q1254.7099,5393.9036 1254.1911,5393.9036 Q1252.3478,5393.9036 1251.3774,5392.689 Q1250.4069,5391.4744 1250.4069,5389.1795 Q1250.4069,5386.8785 1251.3774,5385.6639 Q1252.3478,5384.4493 1254.1911,5384.4493 Q1254.7099,5384.4493 1255.186,5384.5591 Q1255.662,5384.669 1256.0771,5384.8887 L1256.0771,5386.8907 Q1255.6132,5386.4634 1255.1768,5386.2651 Q1254.7404,5386.0667 1254.2765,5386.0667 Q1253.2878,5386.0667 1252.7842,5386.851 Q1252.2807,5387.6353 1252.2807,5389.1795 Q1252.2807,5390.7176 1252.7842,5391.5019 Q1253.2878,5392.2862 1254.2765,5392.2862 Q1254.7404,5392.2862 1255.1768,5392.0878 Q1255.6132,5391.8894 1256.0771,5391.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="162.5" x="1272.9167" y="5393.3695">ReductionDimensionGrouper</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1240.625" x2="1442.7083" y1="5406.2032" y2="5406.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1240.625" x2="1442.7083" y1="5414.5365" y2="5414.5365"/><!--MD5=[9376214d3c26b35d4d4d61b6ee8269cc]
class ReductionSplitter--><rect codeLine="144" height="50.9949" id="ReductionSplitter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="137.5" x="1272.9167" y="3184.375"/><ellipse cx="1287.5" cy="3201.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1289.4104,3205.9642 Q1288.9832,3206.1839 1288.5132,3206.2937 Q1288.0432,3206.4036 1287.5244,3206.4036 Q1285.6812,3206.4036 1284.7107,3205.189 Q1283.7402,3203.9744 1283.7402,3201.6795 Q1283.7402,3199.3785 1284.7107,3198.1639 Q1285.6812,3196.9493 1287.5244,3196.9493 Q1288.0432,3196.9493 1288.5193,3197.0591 Q1288.9954,3197.169 1289.4104,3197.3887 L1289.4104,3199.3907 Q1288.9465,3198.9634 1288.5101,3198.7651 Q1288.0737,3198.5667 1287.6099,3198.5667 Q1286.6211,3198.5667 1286.1176,3199.351 Q1285.614,3200.1353 1285.614,3201.6795 Q1285.614,3203.2176 1286.1176,3204.0019 Q1286.6211,3204.7862 1287.6099,3204.7862 Q1288.0737,3204.7862 1288.5101,3204.5878 Q1288.9465,3204.3894 1289.4104,3203.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="95.8333" x="1306.25" y="3205.8695">ReductionSplitter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1273.9583" x2="1409.375" y1="3218.7032" y2="3218.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1273.9583" x2="1409.375" y1="3227.0365" y2="3227.0365"/><!--MD5=[035c43cdb0f820be3d336f2abd2385f7]
class GpuTreeReductionRewriter--><rect codeLine="145" height="50.9949" id="GpuTreeReductionRewriter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="191.6667" x="1245.8333" y="1923.9583"/><ellipse cx="1260.4167" cy="1941.1224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1262.3271,1945.5475 Q1261.8998,1945.7672 1261.4299,1945.8771 Q1260.9599,1945.9869 1260.4411,1945.9869 Q1258.5978,1945.9869 1257.6274,1944.7723 Q1256.6569,1943.5577 1256.6569,1941.2628 Q1256.6569,1938.9618 1257.6274,1937.7472 Q1258.5978,1936.5326 1260.4411,1936.5326 Q1260.9599,1936.5326 1261.436,1936.6425 Q1261.912,1936.7523 1262.3271,1936.972 L1262.3271,1938.974 Q1261.8632,1938.5468 1261.4268,1938.3484 Q1260.9904,1938.15 1260.5265,1938.15 Q1259.5378,1938.15 1259.0342,1938.9343 Q1258.5307,1939.7186 1258.5307,1941.2628 Q1258.5307,1942.8009 1259.0342,1943.5852 Q1259.5378,1944.3695 1260.5265,1944.3695 Q1260.9904,1944.3695 1261.4268,1944.1711 Q1261.8632,1943.9728 1262.3271,1943.5455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="150" x="1279.1667" y="1945.4529">GpuTreeReductionRewriter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1246.875" x2="1436.4583" y1="1958.2865" y2="1958.2865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1246.875" x2="1436.4583" y1="1966.6199" y2="1966.6199"/><!--MD5=[c7b1325d5fbe0c5f466d6a4018f7251e]
class GemmRewriter--><rect codeLine="148" height="50.9949" id="GemmRewriter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="122.9167" x="1280.2083" y="5459.375"/><ellipse cx="1294.7917" cy="5476.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1296.7021,5480.9642 Q1296.2748,5481.1839 1295.8049,5481.2937 Q1295.3349,5481.4036 1294.8161,5481.4036 Q1292.9728,5481.4036 1292.0024,5480.189 Q1291.0319,5478.9744 1291.0319,5476.6795 Q1291.0319,5474.3785 1292.0024,5473.1639 Q1292.9728,5471.9493 1294.8161,5471.9493 Q1295.3349,5471.9493 1295.811,5472.0591 Q1296.287,5472.169 1296.7021,5472.3887 L1296.7021,5474.3907 Q1296.2382,5473.9634 1295.8018,5473.7651 Q1295.3654,5473.5667 1294.9015,5473.5667 Q1293.9128,5473.5667 1293.4092,5474.351 Q1292.9057,5475.1353 1292.9057,5476.6795 Q1292.9057,5478.2176 1293.4092,5479.0019 Q1293.9128,5479.7862 1294.9015,5479.7862 Q1295.3654,5479.7862 1295.8018,5479.5878 Q1296.2382,5479.3894 1296.7021,5478.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="81.25" x="1313.5417" y="5480.8695">GemmRewriter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1281.25" x2="1402.0833" y1="5493.7032" y2="5493.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1281.25" x2="1402.0833" y1="5502.0365" y2="5502.0365"/><!--MD5=[9c395bfd6b83db23c2498fe89d00f976]
class GemmBroadcastFoldingRewriter--><rect codeLine="149" height="50.9949" id="GemmBroadcastFoldingRewriter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="219.7917" x="1231.7708" y="5546.875"/><ellipse cx="1246.3542" cy="5564.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1248.2646,5568.4642 Q1247.8373,5568.6839 1247.3674,5568.7937 Q1246.8974,5568.9036 1246.3786,5568.9036 Q1244.5353,5568.9036 1243.5649,5567.689 Q1242.5944,5566.4744 1242.5944,5564.1795 Q1242.5944,5561.8785 1243.5649,5560.6639 Q1244.5353,5559.4493 1246.3786,5559.4493 Q1246.8974,5559.4493 1247.3735,5559.5591 Q1247.8495,5559.669 1248.2646,5559.8887 L1248.2646,5561.8907 Q1247.8007,5561.4634 1247.3643,5561.2651 Q1246.9279,5561.0667 1246.464,5561.0667 Q1245.4753,5561.0667 1244.9717,5561.851 Q1244.4682,5562.6353 1244.4682,5564.1795 Q1244.4682,5565.7176 1244.9717,5566.5019 Q1245.4753,5567.2862 1246.464,5567.2862 Q1246.9279,5567.2862 1247.3643,5567.0878 Q1247.8007,5566.8894 1248.2646,5566.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="178.125" x="1265.1042" y="5568.3695">GemmBroadcastFoldingRewriter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1232.8125" x2="1450.5208" y1="5581.2032" y2="5581.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1232.8125" x2="1450.5208" y1="5589.5365" y2="5589.5365"/><path d="M1865.1042,5550 L1865.1042,5568.2292 L1451.8125,5572.3958 L1865.1042,5576.5625 L1865.1042,5594.397 A4.1667,4.1667 0 0 0 1869.2708,5598.5636 L2108.8542,5598.5636 A4.1667,4.1667 0 0 0 2113.0208,5594.397 L2113.0208,5556.25 L2102.6042,5545.8333 L1869.2708,5545.8333 A4.1667,4.1667 0 0 0 1865.1042,5550 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><path d="M2102.6042,5545.8333 L2102.6042,5554.1667 A2.0833,2.0833 0 0 0 2104.6875,5556.25 L2113.0208,5556.25 L2102.6042,5545.8333 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="215.625" x="1876.5625" y="5569.342">Rewrite GEMMs with broadcasted</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="165.625" x="1876.5625" y="5585.2905">inputs as strided GEMMs.</text><!--MD5=[0e7febef3315657549ba7faa775ce43a]
class GpuConvAlgorithmPicker--><rect codeLine="151" height="50.9949" id="GpuConvAlgorithmPicker" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="183.3333" x="1250" y="5634.375"/><ellipse cx="1264.5833" cy="5651.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1266.4937,5655.9642 Q1266.0665,5656.1839 1265.5965,5656.2937 Q1265.1265,5656.4036 1264.6077,5656.4036 Q1262.7645,5656.4036 1261.794,5655.189 Q1260.8236,5653.9744 1260.8236,5651.6795 Q1260.8236,5649.3785 1261.794,5648.1639 Q1262.7645,5646.9493 1264.6077,5646.9493 Q1265.1265,5646.9493 1265.6026,5647.0591 Q1266.0787,5647.169 1266.4937,5647.3887 L1266.4937,5649.3907 Q1266.0299,5648.9634 1265.5935,5648.7651 Q1265.1571,5648.5667 1264.6932,5648.5667 Q1263.7044,5648.5667 1263.2009,5649.351 Q1262.6973,5650.1353 1262.6973,5651.6795 Q1262.6973,5653.2176 1263.2009,5654.0019 Q1263.7044,5654.7862 1264.6932,5654.7862 Q1265.1571,5654.7862 1265.5935,5654.5878 Q1266.0299,5654.3894 1266.4937,5653.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="141.6667" x="1283.3333" y="5655.8695">GpuConvAlgorithmPicker</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1251.0417" x2="1432.2917" y1="5668.7032" y2="5668.7032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1251.0417" x2="1432.2917" y1="5677.0365" y2="5677.0365"/><!--MD5=[a525df6b59e7f201e71423c470ff2789]
class VariadicOpSplitter--><rect codeLine="154" height="50.9949" id="VariadicOpSplitter" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="142.7083" x="1270.3125" y="5721.875"/><ellipse cx="1284.8958" cy="5739.0391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1286.8062,5743.4642 Q1286.379,5743.6839 1285.909,5743.7937 Q1285.439,5743.9036 1284.9202,5743.9036 Q1283.077,5743.9036 1282.1065,5742.689 Q1281.1361,5741.4744 1281.1361,5739.1795 Q1281.1361,5736.8785 1282.1065,5735.6639 Q1283.077,5734.4493 1284.9202,5734.4493 Q1285.439,5734.4493 1285.9151,5734.5591 Q1286.3912,5734.669 1286.8062,5734.8887 L1286.8062,5736.8907 Q1286.3424,5736.4634 1285.906,5736.2651 Q1285.4696,5736.0667 1285.0057,5736.0667 Q1284.0169,5736.0667 1283.5134,5736.851 Q1283.0098,5737.6353 1283.0098,5739.1795 Q1283.0098,5740.7176 1283.5134,5741.5019 Q1284.0169,5742.2862 1285.0057,5742.2862 Q1285.4696,5742.2862 1285.906,5742.0878 Q1286.3424,5741.8894 1286.8062,5741.4622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="101.0417" x="1303.6458" y="5743.3695">VariadicOpSplitter</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1271.3542" x2="1411.9792" y1="5756.2032" y2="5756.2032"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1271.3542" x2="1411.9792" y1="5764.5365" y2="5764.5365"/><path d="M1880.7292,5725 L1880.7292,5743.2292 L1413.3021,5747.3958 L1880.7292,5751.5625 L1880.7292,5769.397 A4.1667,4.1667 0 0 0 1884.8958,5773.5636 L2093.2292,5773.5636 A4.1667,4.1667 0 0 0 2097.3958,5769.397 L2097.3958,5731.25 L2086.9792,5720.8333 L1884.8958,5720.8333 A4.1667,4.1667 0 0 0 1880.7292,5725 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><path d="M2086.9792,5720.8333 L2086.9792,5729.1667 A2.0833,2.0833 0 0 0 2089.0625,5731.25 L2097.3958,5731.25 L2086.9792,5720.8333 " style="stroke:#2683B9;stroke-width:1.0416666666666667;fill:none;"/><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="184.375" x="1892.1875" y="5744.342">Split variadic ops with many</text><text fill="#033C73" font-family="&quot;Verdana&quot;" font-size="13.5417" lengthAdjust="spacing" textLength="157.2917" x="1892.1875" y="5760.2905">parameters into several.</text><!--MD5=[6a5a1cbf15f57a243a08aef687cfd022]
class InstructionFusion--><rect codeLine="159" height="409.668" id="InstructionFusion" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="568.75" x="1057.2917" y="5809.375"/><ellipse cx="1282.8125" cy="5826.5391" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1284.7229,5830.9642 Q1284.2957,5831.1839 1283.8257,5831.2937 Q1283.3557,5831.4036 1282.8369,5831.4036 Q1280.9937,5831.4036 1280.0232,5830.189 Q1279.0527,5828.9744 1279.0527,5826.6795 Q1279.0527,5824.3785 1280.0232,5823.1639 Q1280.9937,5821.9493 1282.8369,5821.9493 Q1283.3557,5821.9493 1283.8318,5822.0591 Q1284.3079,5822.169 1284.7229,5822.3887 L1284.7229,5824.3907 Q1284.259,5823.9634 1283.8226,5823.7651 Q1283.3862,5823.5667 1282.9224,5823.5667 Q1281.9336,5823.5667 1281.4301,5824.351 Q1280.9265,5825.1353 1280.9265,5826.6795 Q1280.9265,5828.2176 1281.4301,5829.0019 Q1281.9336,5829.7862 1282.9224,5829.7862 Q1283.3862,5829.7862 1283.8226,5829.5878 Q1284.259,5829.3894 1284.7229,5828.9622 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="98.9583" x="1307.8125" y="5830.8695">InstructionFusion</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1058.3333" x2="1625" y1="5843.7032" y2="5843.7032"/><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1065.625" y="5852.0365"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="394.7917" x="1082.2917" y="5864.1561">is_expensive_: std::function&lt;bool(const HloInstruction&amp; instruction)&gt;</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1065.625" y="5875.9481"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="117.7083" x="1082.2917" y="5888.0676">may_duplicate_: bool</text><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="18.75" x="1082.2917" y="5911.9792">......</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1058.3333" x2="1625" y1="5923.7712" y2="5923.7712"/><ellipse cx="1068.75" cy="5935.2295" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="25" x="1082.2917" y="5944.224">Run:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1110.4167" y="5944.224">override</text><ellipse cx="1068.75" cy="5959.141" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="33.3333" x="1082.2917" y="5968.1356">name:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1118.75" y="5968.1356">override</text><ellipse cx="1068.75" cy="5983.0526" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" text-decoration="underline" textLength="295.8333" x="1082.2917" y="5992.0471">IsExpensive(instruction: const HloInstruction&amp;): bool</text><ellipse cx="1068.75" cy="6006.9641" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" text-decoration="underline" textLength="526.0417" x="1082.2917" y="6015.9587">ShouldFuseInPlaceOp(producer: const HloInstruction*, consumer: const HloInstruction*): bool</text><polygon fill="#FFFF44" points="1068.75,6025.6673,1072.9167,6029.834,1068.75,6034.0007,1064.5833,6029.834" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="437.5" x="1082.2917" y="6039.8702">GetFusionComputations(module: HloModule*): std::vector&lt;HloComputation*&gt;</text><polygon fill="#FFFF44" points="1068.75,6049.5789,1072.9167,6053.7455,1068.75,6057.9122,1064.5833,6053.7455" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="388.5417" x="1082.2917" y="6063.7817">ShouldFuse(consumer: HloInstruction*, operand_index: int64_t): bool</text><polygon fill="#FFFF44" points="1068.75,6073.4904,1072.9167,6077.6571,1068.75,6081.8237,1064.5833,6077.6571" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="477.0833" x="1082.2917" y="6087.6933">ShouldFuseIntoMultiOutput(consumer: HloInstruction*, operand_index: int64_t): bool</text><polygon fill="#FFFF44" points="1068.75,6097.4019,1072.9167,6101.5686,1068.75,6105.7353,1064.5833,6101.5686" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="511.4583" x="1082.2917" y="6111.6048">ChooseKind(producer: const HloInstruction*, consumer: const HloInstruction*): FusionKind</text><polygon fill="#FFFF44" points="1068.75,6121.3135,1072.9167,6125.4801,1068.75,6129.6468,1064.5833,6125.4801" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="532.2917" x="1082.2917" y="6135.5164">FuseInstruction(fusion_instruction: HloInstruction*, producer: HloInstruction*): HloInstruction*</text><polygon fill="#FFFF44" points="1068.75,6145.225,1072.9167,6149.3917,1068.75,6153.5583,1064.5833,6149.3917" style="stroke:#B38D22;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="423.9583" x="1082.2917" y="6159.4279">Fuse(producer: HloInstruction*, consumer: HloInstruction*): HloInstruction*</text><rect fill="#F24D5C" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1065.625" y="6171.2199"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="519.7917" x="1082.2917" y="6183.3394">AddFusionInstruction(producer: HloInstruction*, consumer: HloInstruction*): HloInstruction*</text><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="18.75" x="1082.2917" y="6207.251">......</text><!--MD5=[e5c4a8955999ad95f7bd7e3680fcfaf1]
class GpuInstructionFusion--><rect codeLine="177" height="194.4641" id="GpuInstructionFusion" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="244.7917" x="1866.6667" y="5916.6667"/><ellipse cx="1918.75" cy="5933.8308" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1920.6604,5938.2558 Q1920.2332,5938.4755 1919.7632,5938.5854 Q1919.2932,5938.6953 1918.7744,5938.6953 Q1916.9312,5938.6953 1915.9607,5937.4807 Q1914.9902,5936.2661 1914.9902,5933.9712 Q1914.9902,5931.6701 1915.9607,5930.4555 Q1916.9312,5929.2409 1918.7744,5929.2409 Q1919.2932,5929.2409 1919.7693,5929.3508 Q1920.2454,5929.4607 1920.6604,5929.6804 L1920.6604,5931.6823 Q1920.1965,5931.2551 1919.7601,5931.0567 Q1919.3237,5930.8584 1918.8599,5930.8584 Q1917.8711,5930.8584 1917.3676,5931.6427 Q1916.864,5932.427 1916.864,5933.9712 Q1916.864,5935.5092 1917.3676,5936.2935 Q1917.8711,5937.0778 1918.8599,5937.0778 Q1919.3237,5937.0778 1919.7601,5936.8795 Q1920.1965,5936.6811 1920.6604,5936.2539 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="121.875" x="1943.75" y="5938.1612">GpuInstructionFusion</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1867.7083" x2="2110.4167" y1="5950.9949" y2="5950.9949"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1867.7083" x2="2110.4167" y1="5959.3282" y2="5959.3282"/><ellipse cx="1878.125" cy="5970.7865" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" text-decoration="underline" textLength="68.75" x="1891.6667" y="5979.7811">IsExpensive:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="48.9583" x="1963.5417" y="5979.7811">override</text><ellipse cx="1878.125" cy="5994.6981" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="67.7083" x="1891.6667" y="6003.6926">ShouldFuse:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1962.5" y="6003.6926">override</text><ellipse cx="1878.125" cy="6018.6096" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="156.25" x="1891.6667" y="6027.6042">ShouldFuseIntoMultiOutput:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="2051.0417" y="6027.6042">override</text><ellipse cx="1878.125" cy="6042.5212" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="70.8333" x="1891.6667" y="6051.5157">ChooseKind:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1965.625" y="6051.5157">override</text><ellipse cx="1878.125" cy="6066.4327" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="25" x="1891.6667" y="6075.4272">Run:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1919.7917" y="6075.4272">override</text><rect fill="#F24D5C" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="1875" y="6087.2192"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="90.625" x="1891.6667" y="6099.3388">FuseInstruction:</text><text fill="#008080" font-family="&quot;Verdana&quot;" font-size="11.4583" font-weight="bold" lengthAdjust="spacing" textLength="48.9583" x="1985.4167" y="6099.3388">override</text><!--MD5=[2d7fe093c102d03c4e28ffb8c8d2e1c1]
class FusionMerger--><rect codeLine="187" height="50.9949" id="FusionMerger" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="118.75" x="1282.2917" y="6255.2083"/><ellipse cx="1296.875" cy="6272.3724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1298.7854,6276.7975 Q1298.3582,6277.0172 1297.8882,6277.1271 Q1297.4182,6277.2369 1296.8994,6277.2369 Q1295.0562,6277.2369 1294.0857,6276.0223 Q1293.1152,6274.8077 1293.1152,6272.5128 Q1293.1152,6270.2118 1294.0857,6268.9972 Q1295.0562,6267.7826 1296.8994,6267.7826 Q1297.4182,6267.7826 1297.8943,6267.8925 Q1298.3704,6268.0023 1298.7854,6268.222 L1298.7854,6270.224 Q1298.3215,6269.7968 1297.8851,6269.5984 Q1297.4487,6269.4 1296.9849,6269.4 Q1295.9961,6269.4 1295.4926,6270.1843 Q1294.989,6270.9686 1294.989,6272.5128 Q1294.989,6274.0509 1295.4926,6274.8352 Q1295.9961,6275.6195 1296.9849,6275.6195 Q1297.4487,6275.6195 1297.8851,6275.4211 Q1298.3215,6275.2228 1298.7854,6274.7955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="77.0833" x="1315.625" y="6276.7029">FusionMerger</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1283.3333" x2="1400" y1="6289.5365" y2="6289.5365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1283.3333" x2="1400" y1="6297.8699" y2="6297.8699"/><!--MD5=[6e8478677cc6472aef381057bbe5bc2e]
class GpuMultiOutputFusion--><rect codeLine="188" height="50.9949" id="GpuMultiOutputFusion" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="168.75" x="1257.2917" y="6342.7083"/><ellipse cx="1271.875" cy="6359.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1273.7854,6364.2975 Q1273.3582,6364.5172 1272.8882,6364.6271 Q1272.4182,6364.7369 1271.8994,6364.7369 Q1270.0562,6364.7369 1269.0857,6363.5223 Q1268.1152,6362.3077 1268.1152,6360.0128 Q1268.1152,6357.7118 1269.0857,6356.4972 Q1270.0562,6355.2826 1271.8994,6355.2826 Q1272.4182,6355.2826 1272.8943,6355.3925 Q1273.3704,6355.5023 1273.7854,6355.722 L1273.7854,6357.724 Q1273.3215,6357.2968 1272.8851,6357.0984 Q1272.4487,6356.9 1271.9849,6356.9 Q1270.9961,6356.9 1270.4926,6357.6843 Q1269.989,6358.4686 1269.989,6360.0128 Q1269.989,6361.5509 1270.4926,6362.3352 Q1270.9961,6363.1195 1271.9849,6363.1195 Q1272.4487,6363.1195 1272.8851,6362.9211 Q1273.3215,6362.7228 1273.7854,6362.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="127.0833" x="1290.625" y="6364.2029">GpuMultiOutputFusion</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1258.3333" x2="1425" y1="6377.0365" y2="6377.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1258.3333" x2="1425" y1="6385.3699" y2="6385.3699"/><!--MD5=[fef954e0ca7d958f3e3a9204e9d2eb5b]
class GpuHorizontalLoopFusion--><rect codeLine="191" height="50.9949" id="GpuHorizontalLoopFusion" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="188.5417" x="1247.3958" y="6430.2083"/><ellipse cx="1261.9792" cy="6447.3724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1263.8896,6451.7975 Q1263.4623,6452.0172 1262.9924,6452.1271 Q1262.5224,6452.2369 1262.0036,6452.2369 Q1260.1603,6452.2369 1259.1899,6451.0223 Q1258.2194,6449.8077 1258.2194,6447.5128 Q1258.2194,6445.2118 1259.1899,6443.9972 Q1260.1603,6442.7826 1262.0036,6442.7826 Q1262.5224,6442.7826 1262.9985,6442.8925 Q1263.4745,6443.0023 1263.8896,6443.222 L1263.8896,6445.224 Q1263.4257,6444.7968 1262.9893,6444.5984 Q1262.5529,6444.4 1262.089,6444.4 Q1261.1003,6444.4 1260.5967,6445.1843 Q1260.0932,6445.9686 1260.0932,6447.5128 Q1260.0932,6449.0509 1260.5967,6449.8352 Q1261.1003,6450.6195 1262.089,6450.6195 Q1262.5529,6450.6195 1262.9893,6450.4211 Q1263.4257,6450.2228 1263.8896,6449.7955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="146.875" x="1280.7292" y="6451.7029">GpuHorizontalLoopFusion</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1248.4375" x2="1434.8958" y1="6464.5365" y2="6464.5365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1248.4375" x2="1434.8958" y1="6472.8699" y2="6472.8699"/><!--MD5=[304a8ba522956c8e3e362c4a4919a108]
class GpuHorizontalInputFusion--><rect codeLine="192" height="50.9949" id="GpuHorizontalInputFusion" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="189.5833" x="1246.875" y="6517.7083"/><ellipse cx="1261.4583" cy="6534.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1263.3687,6539.2975 Q1262.9415,6539.5172 1262.4715,6539.6271 Q1262.0015,6539.7369 1261.4827,6539.7369 Q1259.6395,6539.7369 1258.669,6538.5223 Q1257.6986,6537.3077 1257.6986,6535.0128 Q1257.6986,6532.7118 1258.669,6531.4972 Q1259.6395,6530.2826 1261.4827,6530.2826 Q1262.0015,6530.2826 1262.4776,6530.3925 Q1262.9537,6530.5023 1263.3687,6530.722 L1263.3687,6532.724 Q1262.9049,6532.2968 1262.4685,6532.0984 Q1262.0321,6531.9 1261.5682,6531.9 Q1260.5794,6531.9 1260.0759,6532.6843 Q1259.5723,6533.4686 1259.5723,6535.0128 Q1259.5723,6536.5509 1260.0759,6537.3352 Q1260.5794,6538.1195 1261.5682,6538.1195 Q1262.0321,6538.1195 1262.4685,6537.9211 Q1262.9049,6537.7228 1263.3687,6537.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="147.9167" x="1280.2083" y="6539.2029">GpuHorizontalInputFusion</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1247.9167" x2="1435.4167" y1="6552.0365" y2="6552.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1247.9167" x2="1435.4167" y1="6560.3699" y2="6560.3699"/><!--MD5=[ebc3e4d46e0bd7988aee27ea64381c3a]
class FusionBitcastLift--><rect codeLine="194" height="50.9949" id="FusionBitcastLift" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="133.3333" x="1275" y="6605.2083"/><ellipse cx="1289.5833" cy="6622.3724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1291.4937,6626.7975 Q1291.0665,6627.0172 1290.5965,6627.1271 Q1290.1265,6627.2369 1289.6077,6627.2369 Q1287.7645,6627.2369 1286.794,6626.0223 Q1285.8236,6624.8077 1285.8236,6622.5128 Q1285.8236,6620.2118 1286.794,6618.9972 Q1287.7645,6617.7826 1289.6077,6617.7826 Q1290.1265,6617.7826 1290.6026,6617.8925 Q1291.0787,6618.0023 1291.4937,6618.222 L1291.4937,6620.224 Q1291.0299,6619.7968 1290.5935,6619.5984 Q1290.1571,6619.4 1289.6932,6619.4 Q1288.7044,6619.4 1288.2009,6620.1843 Q1287.6973,6620.9686 1287.6973,6622.5128 Q1287.6973,6624.0509 1288.2009,6624.8352 Q1288.7044,6625.6195 1289.6932,6625.6195 Q1290.1571,6625.6195 1290.5935,6625.4211 Q1291.0299,6625.2228 1291.4937,6624.7955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="91.6667" x="1308.3333" y="6626.7029">FusionBitcastLift</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1276.0417" x2="1407.2917" y1="6639.5365" y2="6639.5365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1276.0417" x2="1407.2917" y1="6647.8699" y2="6647.8699"/><!--MD5=[ccdd3649ab1ec5285ab47a5421072690]
class AllGatherCombiner--><rect codeLine="197" height="50.9949" id="AllGatherCombiner" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="148.9583" x="1267.1875" y="6692.7083"/><ellipse cx="1281.7708" cy="6709.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1283.6812,6714.2975 Q1283.254,6714.5172 1282.784,6714.6271 Q1282.314,6714.7369 1281.7952,6714.7369 Q1279.952,6714.7369 1278.9815,6713.5223 Q1278.0111,6712.3077 1278.0111,6710.0128 Q1278.0111,6707.7118 1278.9815,6706.4972 Q1279.952,6705.2826 1281.7952,6705.2826 Q1282.314,6705.2826 1282.7901,6705.3925 Q1283.2662,6705.5023 1283.6812,6705.722 L1283.6812,6707.724 Q1283.2174,6707.2968 1282.781,6707.0984 Q1282.3446,6706.9 1281.8807,6706.9 Q1280.8919,6706.9 1280.3884,6707.6843 Q1279.8848,6708.4686 1279.8848,6710.0128 Q1279.8848,6711.5509 1280.3884,6712.3352 Q1280.8919,6713.1195 1281.8807,6713.1195 Q1282.3446,6713.1195 1282.781,6712.9211 Q1283.2174,6712.7228 1283.6812,6712.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="107.2917" x="1300.5208" y="6714.2029">AllGatherCombiner</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1268.2292" x2="1415.1042" y1="6727.0365" y2="6727.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1268.2292" x2="1415.1042" y1="6735.3699" y2="6735.3699"/><!--MD5=[f73b7bd0bb57787956426ab0ec6b676f]
class AllReduceCombiner--><rect codeLine="198" height="50.9949" id="AllReduceCombiner" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="152.0833" x="1265.625" y="6780.2083"/><ellipse cx="1280.2083" cy="6797.3724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1282.1187,6801.7975 Q1281.6915,6802.0172 1281.2215,6802.1271 Q1280.7515,6802.2369 1280.2327,6802.2369 Q1278.3895,6802.2369 1277.419,6801.0223 Q1276.4486,6799.8077 1276.4486,6797.5128 Q1276.4486,6795.2118 1277.419,6793.9972 Q1278.3895,6792.7826 1280.2327,6792.7826 Q1280.7515,6792.7826 1281.2276,6792.8925 Q1281.7037,6793.0023 1282.1187,6793.222 L1282.1187,6795.224 Q1281.6549,6794.7968 1281.2185,6794.5984 Q1280.7821,6794.4 1280.3182,6794.4 Q1279.3294,6794.4 1278.8259,6795.1843 Q1278.3223,6795.9686 1278.3223,6797.5128 Q1278.3223,6799.0509 1278.8259,6799.8352 Q1279.3294,6800.6195 1280.3182,6800.6195 Q1280.7821,6800.6195 1281.2185,6800.4211 Q1281.6549,6800.2228 1282.1187,6799.7955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="110.4167" x="1298.9583" y="6801.7029">AllReduceCombiner</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1266.6667" x2="1416.6667" y1="6814.5365" y2="6814.5365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1266.6667" x2="1416.6667" y1="6822.8699" y2="6822.8699"/><!--MD5=[885433643f57c38d7169b438c3866dbc]
class ReduceScatterCombiner--><rect codeLine="199" height="50.9949" id="ReduceScatterCombiner" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="176.0417" x="1253.6458" y="6867.7083"/><ellipse cx="1268.2292" cy="6884.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1270.1396,6889.2975 Q1269.7123,6889.5172 1269.2424,6889.6271 Q1268.7724,6889.7369 1268.2536,6889.7369 Q1266.4103,6889.7369 1265.4399,6888.5223 Q1264.4694,6887.3077 1264.4694,6885.0128 Q1264.4694,6882.7118 1265.4399,6881.4972 Q1266.4103,6880.2826 1268.2536,6880.2826 Q1268.7724,6880.2826 1269.2485,6880.3925 Q1269.7245,6880.5023 1270.1396,6880.722 L1270.1396,6882.724 Q1269.6757,6882.2968 1269.2393,6882.0984 Q1268.8029,6881.9 1268.339,6881.9 Q1267.3503,6881.9 1266.8467,6882.6843 Q1266.3432,6883.4686 1266.3432,6885.0128 Q1266.3432,6886.5509 1266.8467,6887.3352 Q1267.3503,6888.1195 1268.339,6888.1195 Q1268.8029,6888.1195 1269.2393,6887.9211 Q1269.6757,6887.7228 1270.1396,6887.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="134.375" x="1286.9792" y="6889.2029">ReduceScatterCombiner</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1254.6875" x2="1428.6458" y1="6902.0365" y2="6902.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1254.6875" x2="1428.6458" y1="6910.3699" y2="6910.3699"/><!--MD5=[81f21254abf37d6943de5d5f1ead857a]
class AllReduceContiguous--><rect codeLine="201" height="50.9949" id="AllReduceContiguous" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="162.5" x="1260.4167" y="6955.2083"/><ellipse cx="1275" cy="6972.3724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1276.9104,6976.7975 Q1276.4832,6977.0172 1276.0132,6977.1271 Q1275.5432,6977.2369 1275.0244,6977.2369 Q1273.1812,6977.2369 1272.2107,6976.0223 Q1271.2402,6974.8077 1271.2402,6972.5128 Q1271.2402,6970.2118 1272.2107,6968.9972 Q1273.1812,6967.7826 1275.0244,6967.7826 Q1275.5432,6967.7826 1276.0193,6967.8925 Q1276.4954,6968.0023 1276.9104,6968.222 L1276.9104,6970.224 Q1276.4465,6969.7968 1276.0101,6969.5984 Q1275.5737,6969.4 1275.1099,6969.4 Q1274.1211,6969.4 1273.6176,6970.1843 Q1273.114,6970.9686 1273.114,6972.5128 Q1273.114,6974.0509 1273.6176,6974.8352 Q1274.1211,6975.6195 1275.1099,6975.6195 Q1275.5737,6975.6195 1276.0101,6975.4211 Q1276.4465,6975.2228 1276.9104,6974.7955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="120.8333" x="1293.75" y="6976.7029">AllReduceContiguous</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1261.4583" x2="1421.875" y1="6989.5365" y2="6989.5365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1261.4583" x2="1421.875" y1="6997.8699" y2="6997.8699"/><!--MD5=[61623c54fbe425c0a66711424f18f5b6]
class AllReduceBlueConnect--><rect codeLine="202" height="50.9949" id="AllReduceBlueConnect" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="166.6667" x="1258.3333" y="7042.7083"/><ellipse cx="1272.9167" cy="7059.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1274.8271,7064.2975 Q1274.3998,7064.5172 1273.9299,7064.6271 Q1273.4599,7064.7369 1272.9411,7064.7369 Q1271.0978,7064.7369 1270.1274,7063.5223 Q1269.1569,7062.3077 1269.1569,7060.0128 Q1269.1569,7057.7118 1270.1274,7056.4972 Q1271.0978,7055.2826 1272.9411,7055.2826 Q1273.4599,7055.2826 1273.936,7055.3925 Q1274.412,7055.5023 1274.8271,7055.722 L1274.8271,7057.724 Q1274.3632,7057.2968 1273.9268,7057.0984 Q1273.4904,7056.9 1273.0265,7056.9 Q1272.0378,7056.9 1271.5342,7057.6843 Q1271.0307,7058.4686 1271.0307,7060.0128 Q1271.0307,7061.5509 1271.5342,7062.3352 Q1272.0378,7063.1195 1273.0265,7063.1195 Q1273.4904,7063.1195 1273.9268,7062.9211 Q1274.3632,7062.7228 1274.8271,7062.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="125" x="1291.6667" y="7064.2029">AllReduceBlueConnect</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1259.375" x2="1423.9583" y1="7077.0365" y2="7077.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1259.375" x2="1423.9583" y1="7085.3699" y2="7085.3699"/><!--MD5=[ded6d2bf4d01ff6f8b0201db289cdcfe]
class AsyncCollectiveCreator--><rect codeLine="203" height="50.9949" id="AsyncCollectiveCreator" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="172.9167" x="1255.2083" y="7130.2083"/><ellipse cx="1269.7917" cy="7147.3724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1271.7021,7151.7975 Q1271.2748,7152.0172 1270.8049,7152.1271 Q1270.3349,7152.2369 1269.8161,7152.2369 Q1267.9728,7152.2369 1267.0024,7151.0223 Q1266.0319,7149.8077 1266.0319,7147.5128 Q1266.0319,7145.2118 1267.0024,7143.9972 Q1267.9728,7142.7826 1269.8161,7142.7826 Q1270.3349,7142.7826 1270.811,7142.8925 Q1271.287,7143.0023 1271.7021,7143.222 L1271.7021,7145.224 Q1271.2382,7144.7968 1270.8018,7144.5984 Q1270.3654,7144.4 1269.9015,7144.4 Q1268.9128,7144.4 1268.4092,7145.1843 Q1267.9057,7145.9686 1267.9057,7147.5128 Q1267.9057,7149.0509 1268.4092,7149.8352 Q1268.9128,7150.6195 1269.9015,7150.6195 Q1270.3654,7150.6195 1270.8018,7150.4211 Q1271.2382,7150.2228 1271.7021,7149.7955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="131.25" x="1288.5417" y="7151.7029">AsyncCollectiveCreator</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1256.25" x2="1427.0833" y1="7164.5365" y2="7164.5365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1256.25" x2="1427.0833" y1="7172.8699" y2="7172.8699"/><!--MD5=[f8f5af45b7a28c7139987a8fdfeaadf4]
class CollectivesScheduleLinearizer--><rect codeLine="204" height="50.9949" id="CollectivesScheduleLinearizer" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="207.2917" x="1238.0208" y="7217.7083"/><ellipse cx="1252.6042" cy="7234.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1254.5146,7239.2975 Q1254.0873,7239.5172 1253.6174,7239.6271 Q1253.1474,7239.7369 1252.6286,7239.7369 Q1250.7853,7239.7369 1249.8149,7238.5223 Q1248.8444,7237.3077 1248.8444,7235.0128 Q1248.8444,7232.7118 1249.8149,7231.4972 Q1250.7853,7230.2826 1252.6286,7230.2826 Q1253.1474,7230.2826 1253.6235,7230.3925 Q1254.0995,7230.5023 1254.5146,7230.722 L1254.5146,7232.724 Q1254.0507,7232.2968 1253.6143,7232.0984 Q1253.1779,7231.9 1252.714,7231.9 Q1251.7253,7231.9 1251.2217,7232.6843 Q1250.7182,7233.4686 1250.7182,7235.0128 Q1250.7182,7236.5509 1251.2217,7237.3352 Q1251.7253,7238.1195 1252.714,7238.1195 Q1253.1779,7238.1195 1253.6143,7237.9211 Q1254.0507,7237.7228 1254.5146,7237.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="165.625" x="1271.3542" y="7239.2029">CollectivesScheduleLinearizer</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1239.0625" x2="1444.2708" y1="7252.0365" y2="7252.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1239.0625" x2="1444.2708" y1="7260.3699" y2="7260.3699"/><!--MD5=[2899e1cb399db20ecfcf8ed2a01bcedc]
class ShardingPropagation--><rect codeLine="207" height="50.9949" id="ShardingPropagation" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="159.375" x="1261.9792" y="7305.2083"/><ellipse cx="1276.5625" cy="7322.3724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1278.4729,7326.7975 Q1278.0457,7327.0172 1277.5757,7327.1271 Q1277.1057,7327.2369 1276.5869,7327.2369 Q1274.7437,7327.2369 1273.7732,7326.0223 Q1272.8027,7324.8077 1272.8027,7322.5128 Q1272.8027,7320.2118 1273.7732,7318.9972 Q1274.7437,7317.7826 1276.5869,7317.7826 Q1277.1057,7317.7826 1277.5818,7317.8925 Q1278.0579,7318.0023 1278.4729,7318.222 L1278.4729,7320.224 Q1278.009,7319.7968 1277.5726,7319.5984 Q1277.1362,7319.4 1276.6724,7319.4 Q1275.6836,7319.4 1275.1801,7320.1843 Q1274.6765,7320.9686 1274.6765,7322.5128 Q1274.6765,7324.0509 1275.1801,7324.8352 Q1275.6836,7325.6195 1276.6724,7325.6195 Q1277.1362,7325.6195 1277.5726,7325.4211 Q1278.009,7325.2228 1278.4729,7324.7955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="117.7083" x="1295.3125" y="7326.7029">ShardingPropagation</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1263.0208" x2="1420.3125" y1="7339.5365" y2="7339.5365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1263.0208" x2="1420.3125" y1="7347.8699" y2="7347.8699"/><!--MD5=[bc108fefae5603adfdbecfb2760d526e]
class SpmdPartitioner--><rect codeLine="208" height="50.9949" id="SpmdPartitioner" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="131.25" x="1276.0417" y="7392.7083"/><ellipse cx="1290.625" cy="7409.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1292.5354,7414.2975 Q1292.1082,7414.5172 1291.6382,7414.6271 Q1291.1682,7414.7369 1290.6494,7414.7369 Q1288.8062,7414.7369 1287.8357,7413.5223 Q1286.8652,7412.3077 1286.8652,7410.0128 Q1286.8652,7407.7118 1287.8357,7406.4972 Q1288.8062,7405.2826 1290.6494,7405.2826 Q1291.1682,7405.2826 1291.6443,7405.3925 Q1292.1204,7405.5023 1292.5354,7405.722 L1292.5354,7407.724 Q1292.0715,7407.2968 1291.6351,7407.0984 Q1291.1987,7406.9 1290.7349,7406.9 Q1289.7461,7406.9 1289.2426,7407.6843 Q1288.739,7408.4686 1288.739,7410.0128 Q1288.739,7411.5509 1289.2426,7412.3352 Q1289.7461,7413.1195 1290.7349,7413.1195 Q1291.1987,7413.1195 1291.6351,7412.9211 Q1292.0715,7412.7228 1292.5354,7412.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="89.5833" x="1309.375" y="7414.2029">SpmdPartitioner</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1277.0833" x2="1406.25" y1="7427.0365" y2="7427.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1277.0833" x2="1406.25" y1="7435.3699" y2="7435.3699"/><!--MD5=[e54b14c2f2847a69a0b1158c86af9f75]
class GpuSpmdPartitioner--><rect codeLine="209" height="50.9949" id="GpuSpmdPartitioner" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="154.1667" x="1911.9792" y="7392.7083"/><ellipse cx="1926.5625" cy="7409.8724" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1928.4729,7414.2975 Q1928.0457,7414.5172 1927.5757,7414.6271 Q1927.1057,7414.7369 1926.5869,7414.7369 Q1924.7437,7414.7369 1923.7732,7413.5223 Q1922.8027,7412.3077 1922.8027,7410.0128 Q1922.8027,7407.7118 1923.7732,7406.4972 Q1924.7437,7405.2826 1926.5869,7405.2826 Q1927.1057,7405.2826 1927.5818,7405.3925 Q1928.0579,7405.5023 1928.4729,7405.722 L1928.4729,7407.724 Q1928.009,7407.2968 1927.5726,7407.0984 Q1927.1362,7406.9 1926.6724,7406.9 Q1925.6836,7406.9 1925.1801,7407.6843 Q1924.6765,7408.4686 1924.6765,7410.0128 Q1924.6765,7411.5509 1925.1801,7412.3352 Q1925.6836,7413.1195 1926.6724,7413.1195 Q1927.1362,7413.1195 1927.5726,7412.9211 Q1928.009,7412.7228 1928.4729,7412.2955 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="112.5" x="1945.3125" y="7414.2029">GpuSpmdPartitioner</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1913.0208" x2="2065.1042" y1="7427.0365" y2="7427.0365"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1913.0208" x2="2065.1042" y1="7435.3699" y2="7435.3699"/><!--MD5=[b199ae54cb3eb63a58a511ecab0f6870]
class ShardingRemover--><rect codeLine="210" height="50.9949" id="ShardingRemover" rx="4.1667" ry="4.1667" style="stroke:#2FA4E7;stroke-width:1.0416666666666667;fill:none;" width="140.625" x="1271.3542" y="1836.4583"/><ellipse cx="1285.9375" cy="1853.6224" fill="#EDF0F2" rx="10.4167" ry="10.4167" style="stroke:#BABDBF;stroke-width:1.0416666666666667;"/><path d="M1287.8479,1858.0475 Q1287.4207,1858.2672 1286.9507,1858.3771 Q1286.4807,1858.4869 1285.9619,1858.4869 Q1284.1187,1858.4869 1283.1482,1857.2723 Q1282.1777,1856.0577 1282.1777,1853.7628 Q1282.1777,1851.4618 1283.1482,1850.2472 Q1284.1187,1849.0326 1285.9619,1849.0326 Q1286.4807,1849.0326 1286.9568,1849.1425 Q1287.4329,1849.2523 1287.8479,1849.472 L1287.8479,1851.474 Q1287.384,1851.0468 1286.9476,1850.8484 Q1286.5112,1850.65 1286.0474,1850.65 Q1285.0586,1850.65 1284.5551,1851.4343 Q1284.0515,1852.2186 1284.0515,1853.7628 Q1284.0515,1855.3009 1284.5551,1856.0852 Q1285.0586,1856.8695 1286.0474,1856.8695 Q1286.5112,1856.8695 1286.9476,1856.6711 Q1287.384,1856.4728 1287.8479,1856.0455 Z " fill="#000000"/><text fill="#343A40" font-family="&quot;Verdana&quot;" font-size="11.4583" lengthAdjust="spacing" textLength="98.9583" x="1304.6875" y="1857.9529">ShardingRemover</text><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1272.3958" x2="1410.9375" y1="1870.7865" y2="1870.7865"/><line style="stroke:#2FA4E7;stroke-width:1.0416666666666667;" x1="1272.3958" x2="1410.9375" y1="1879.1199" y2="1879.1199"/><!--MD5=[be374cd1f97e6a41f1bba7cb241fae96]
reverse link HloPassInterface to HloModulePass--><path codeLine="223" d="M524.3021,4303.6458 C565.8333,4303.6458 607.2396,4303.6458 644.2188,4303.6458 " fill="none" id="HloPassInterface-backto-HloModulePass" style="stroke:#2FA4E7;stroke-width:3.125;"/><polygon fill="none" points="524.0938,4310.9375,503.2604,4303.6458,524.0938,4296.3542,524.0938,4310.9375" style="stroke:#2FA4E7;stroke-width:3.125;"/><!--MD5=[3cc5ea7737ebda4ff21904975ace4825]
reverse link HloPassInterface to HloModuleGroupPass--><path codeLine="224" d="M523.4792,4380.3854 C537.7292,4384.4063 551.8438,4388.3646 565.625,4392.1875 C608.1146,4403.9688 655.5208,4416.5104 694.8542,4426.7604 " fill="none" id="HloPassInterface-backto-HloModuleGroupPass" style="stroke:#2FA4E7;stroke-width:3.125;"/><polygon fill="none" points="521.3333,4387.3542,503.2813,4374.6458,525.3125,4373.3229,521.3333,4387.3542" style="stroke:#2FA4E7;stroke-width:3.125;"/><!--MD5=[8653ca536ce83b37e4d8093d13a7de3c]
reverse link HloPassInterface to HloPassPipeline--><path codeLine="225" d="M297.0729,4198.1667 C387.5521,3930.1771 626.4167,3222.7188 730.0417,2915.8021 " fill="none" id="HloPassInterface-backto-HloPassPipeline" style="stroke:#2FA4E7;stroke-width:3.125;"/><polygon fill="none" points="303.8854,4200.7917,290.3125,4218.1979,290.0625,4196.125,303.8854,4200.7917" style="stroke:#2FA4E7;stroke-width:3.125;"/><!--MD5=[506ca5a21e46bfb81a52fb7d17f7f05c]
reverse link HloModulePass to HloVerifier--><path codeLine="227" d="M917.7083,4308.8542 C917.7083,4308.8542 1036.3854,2103.625 1057.2917,2080.7292 C1116.0313,2016.4167 1226.8646,2019.5833 1291.125,2028.0313 " fill="none" id="HloModulePass-backto-HloVerifier" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[336b6fcb973a43bd20cd02b1221055be]
reverse link HloModulePass to OpExpanderPass--><path codeLine="228" d="M917.7083,4308.8542 C917.7083,4308.8542 963.6458,3545.1354 994.7917,2933.8542 C1010.2292,2630.9167 1000.3958,1868.2604 1057.2917,1570.3125 C1108.0208,1304.6458 1226.3333,1008.1667 1292.9167,853.8542 " fill="none" id="HloModulePass-backto-OpExpanderPass" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[0c2f9f9657f0653274f6551cdbf2f0fd]
reverse link OpExpanderPass to AllToAllDecomposer--><path codeLine="229" d="M1560.4167,738.0208 C1560.4167,738.0208 1592.2917,232.4167 1688.5417,134.8958 C1741.5313,81.2188 1827.4375,66.1875 1893.6771,63.4896 " fill="none" id="OpExpanderPass-backto-AllToAllDecomposer" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[867760935432597d12a50baf2571cb92]
reverse link OpExpanderPass to OperandUpcaster--><path codeLine="230" d="M1560.4167,738.0208 C1560.4167,738.0208 1601.0417,301.6667 1688.5417,222.3958 C1750.5521,166.2083 1851.3021,163 1918.5938,168.5938 " fill="none" id="OpExpanderPass-backto-OperandUpcaster" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[e1cb507849696fccfc0f45e366b9025c]
reverse link OpExpanderPass to ResultCaster--><path codeLine="231" d="M1560.4167,738.0208 C1560.4167,738.0208 1598.0938,1191.7708 1688.5417,1274.4792 C1754.75,1335.0208 1865.875,1334.2708 1932.5313,1327.0521 " fill="none" id="OpExpanderPass-backto-ResultCaster" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[1f2d07895e0c1a156336e77097fdc06c]
reverse link OpExpanderPass to RngExpander--><path codeLine="233" d="M1560.4167,738.0208 C1560.4167,738.0208 1613.3958,374.8229 1688.5417,309.8958 C1755.5417,252.0104 1864.0833,251.375 1930.4583,257.6979 " fill="none" id="OpExpanderPass-backto-RngExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[6230a413d0f788a38080b34a2ae25919]
reverse link OpExpanderPass to RngBitGeneratorExpander--><path codeLine="234" d="M1560.4167,738.0208 C1560.4167,738.0208 1562.5729,498.8542 1688.5417,397.3958 C1746.1354,351 1830.9271,342.4063 1895.6042,344.0521 " fill="none" id="OpExpanderPass-backto-RngBitGeneratorExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[99f3798016281ada4489fd041adb9a80]
reverse link OpExpanderPass to ZeroSizedHloElimination--><path codeLine="235" d="M1560.4167,738.0208 C1560.4167,738.0208 1570.7396,1352.3438 1688.5417,1467.1875 C1743.5938,1520.8542 1833.4896,1527.8229 1900.4479,1523.9375 " fill="none" id="OpExpanderPass-backto-ZeroSizedHloElimination" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[3cfe38f094f839cf2dfae7aaeb1035a9]
reverse link OpExpanderPass to ScatterExpander--><path codeLine="236" d="M1560.4167,738.0208 C1560.4167,738.0208 1586.1875,558.5312 1688.5417,484.8958 C1756.8958,435.7188 1857.0208,430.9687 1922.3646,434.2917 " fill="none" id="OpExpanderPass-backto-ScatterExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[a8cbaca7781e86b105445807193bf8fc]
reverse link ScatterExpander to GpuScatterExpander--><path codeLine="237" d="M2076.8646,441.1458 C2156.9896,441.1458 2274.9063,441.1458 2351.875,441.1458 " fill="none" id="ScatterExpander-backto-GpuScatterExpander" style="stroke:#00FFFF;stroke-width:3.125;"/><polygon fill="none" points="2076.6667,448.4375,2055.8333,441.1458,2076.6667,433.8542,2076.6667,448.4375" style="stroke:#00FFFF;stroke-width:3.125;"/><!--MD5=[ec9ef91cb93f36a7ce9865e11409b25b]
reverse link OpExpanderPass to QrExpander--><path codeLine="238" d="M1560.4167,738.0208 C1560.4167,738.0208 1608.1875,619.3437 1688.5417,572.3958 C1765.2188,527.6042 1871.1771,522.8854 1934.3333,524.8542 " fill="none" id="OpExpanderPass-backto-QrExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[f7fe8cdd7393e26535b1019f457c13a9]
reverse link OpExpanderPass to EighExpander--><path codeLine="239" d="M1560.4167,738.0208 C1560.4167,738.0208 1625.8021,682.5312 1688.5417,659.8958 C1768.8542,630.9167 1867.875,621.0938 1929.5,617.7917 " fill="none" id="OpExpanderPass-backto-EighExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[126ae8a1d9ca420eaa8d1dc3ae0a5882]
reverse link HloModulePass to DynamicIndexSplitter--><path codeLine="240" d="M917.7083,4308.8542 C917.7083,4308.8542 1037.1771,2190.2083 1057.2917,2168.2292 C1107.7917,2113.0729 1196.6146,2107.5938 1261.375,2112.4688 " fill="none" id="HloModulePass-backto-DynamicIndexSplitter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[d1f8cc663971cfcca4b1e90d858a224f]
reverse link HloModulePass to CallInliner--><path codeLine="241" d="M917.7083,4308.8542 C917.7083,4308.8542 1018.6354,2297.8333 1057.2917,2255.7292 C1116.625,2191.1146 1228.5521,2194.7292 1292.5417,2203.2604 " fill="none" id="HloModulePass-backto-CallInliner" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[a64f4f02d1d79af2fae8d1a5f691bdea]
reverse link HloModulePass to DotDecomposer--><path codeLine="242" d="M917.7083,4308.8542 C917.7083,4308.8542 1020.2083,2383.4896 1057.2917,2343.2292 C1111.6563,2284.1875 1209.9479,2282.1667 1275.2604,2288.7604 " fill="none" id="HloModulePass-backto-DotDecomposer" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[877e2b14727828795edd6ee424286927]
reverse link OpExpanderPass to Convolution4DExpander--><path codeLine="243" d="M1560.4167,738.0208 C1560.4167,738.0208 1774.1771,720.8333 1899.4167,710.7708 " fill="none" id="OpExpanderPass-backto-Convolution4DExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[d664f4391aaf149ba445ce3937e9d988]
reverse link OpExpanderPass to StableSortExpander--><path codeLine="244" d="M1560.4167,738.0208 C1560.4167,738.0208 1791.0313,766.6667 1913.5417,781.8958 " fill="none" id="OpExpanderPass-backto-StableSortExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[e84d66e4440a3c3ab6081415d7ea40f5]
reverse link HloModulePass to BFloat16Normalization--><path codeLine="245" d="M917.7083,4308.8542 C917.7083,4308.8542 962.6875,3545.0833 994.7917,2933.8542 C998.5104,2862.9792 1009.7917,1710.5521 1057.2917,1657.8125 C1106.4271,1603.2708 1193,1597.0521 1257.5625,1601.5833 " fill="none" id="HloModulePass-backto-BFloat16Normalization" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[8416622863404f83d7b55a9fb6f9b370]
reverse link HloModulePass to BatchNormExpander--><path codeLine="246" d="M917.7083,4308.8542 C917.7083,4308.8542 960.5417,3544.9688 994.7917,2933.8542 C1001.7396,2809.8958 979.6667,1915.125 1057.2917,1818.2292 C1101.8854,1762.5729 1182.0104,1743.7604 1245.6979,1738.1563 " fill="none" id="HloModulePass-backto-BatchNormExpander" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[39bc9295ea368784be41f518f825cb67]
reverse link HloModulePass to CudnnBatchNormRewriter--><path codeLine="247" d="M917.7083,4308.8542 C917.7083,4308.8542 949.3958,3017.5625 1057.2917,2903.6458 C1105.2083,2853.0521 1185.4583,2844.7188 1248.3438,2847.5417 " fill="none" id="HloModulePass-backto-CudnnBatchNormRewriter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[1376a291b6279f371d3250e12a950ca5]
reverse link OpExpanderPass to LogisticExpander--><path codeLine="248" d="M1560.4167,738.0208 C1560.4167,738.0208 1622.6875,807.3438 1688.5417,834.8958 C1763.5521,866.2813 1857.3125,875.7083 1919.7396,878.25 " fill="none" id="OpExpanderPass-backto-LogisticExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[5a4de1f767f01b9878bf2d90c1ffe18a]
reverse link HloModulePass to ConditionalCanonicalizer--><path codeLine="249" d="M917.7083,4308.8542 C917.7083,4308.8542 955.6979,3097.7083 1057.2917,2991.1458 C1105.8958,2940.1771 1187.3229,2932.1875 1250.4583,2935.2292 " fill="none" id="HloModulePass-backto-ConditionalCanonicalizer" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[9d778046f4b63da351383d62cb6ed21f]
reverse link HloModulePass to DynamicDimensionSimplifier--><path codeLine="250" d="M917.7083,4308.8542 C917.7083,4308.8542 961.9896,3177.8542 1057.2917,3078.6458 C1103.6667,3030.3646 1179.5208,3020.7396 1241.0833,3022.4792 " fill="none" id="HloModulePass-backto-DynamicDimensionSimplifier" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[638e965b183f8248ecd5aa6a84b43624]
reverse link HloModulePass to DynamicPadder--><path codeLine="251" d="M917.7083,4308.8542 C917.7083,4308.8542 968.2917,3258.0104 1057.2917,3166.1458 C1113.5729,3108.0521 1212.5625,3106.0833 1277.3646,3112.3958 " fill="none" id="HloModulePass-backto-DynamicPadder" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[5553867723fb2362c459d7f5332981e6]
reverse link HloPassPipeline to HloPassFix--><path codeLine="252" d="M794.5313,2604.0104 C822.2083,2305.4479 897.2292,1697.7396 1057.2917,1570.3125 C1255.0521,1412.875 1425.0729,1416.9896 1626.0417,1570.3125 C1709.625,1634.0729 1640.5521,1704.9063 1688.5417,1798.4375 C1743.8854,1906.3021 1834.1875,2012.0208 1901.1875,2082.6042 " fill="none" id="HloPassPipeline-backto-HloPassFix" style="stroke:#FF0000;stroke-width:3.125;"/><polygon fill="none" points="801.7708,2604.875,792.625,2624.9583,787.25,2603.5521,801.7708,2604.875" style="stroke:#FF0000;stroke-width:3.125;"/><!--MD5=[f415262ccfd5658f524adf0fb73cbdc6]
reverse link AlgebraicSimplifier to HloPassFix--><path codeLine="253" d="M1436.3646,2379.5729 C1492.3438,2373.4167 1564.3333,2362.4375 1626.0417,2343.2292 C1697.8542,2320.875 1773.3438,2286.3333 1836.6875,2253.8333 " fill="none" id="AlgebraicSimplifier-backto-HloPassFix" style="stroke:#FF0000;stroke-width:3.125;"/><polygon fill="none" points="1436.8333,2386.8542,1415.3646,2381.7396,1435.3438,2372.3438,1436.8333,2386.8542" style="stroke:#FF0000;stroke-width:3.125;"/><!--MD5=[8be8f9ff6ad36ac5e671ebcb6f0ce0a5]
reverse link ReductionSplitter to HloPassFix--><path codeLine="254" d="M1431.7604,3218.3542 C1492.875,3219.2917 1572.3333,3210.2917 1626.0417,3166.1458 C1912.3854,2930.7708 1972.2292,2449.2917 1984.7292,2253.6875 " fill="none" id="ReductionSplitter-backto-HloPassFix" style="stroke:#FF0000;stroke-width:3.125;"/><polygon fill="none" points="1431.1458,3225.625,1410.5729,3217.625,1431.6458,3211.0521,1431.1458,3225.625" style="stroke:#FF0000;stroke-width:3.125;"/><!--MD5=[1b27b78f5170555fcd4329d769947bdb]
reverse link GpuTreeReductionRewriter to HloPassFix--><path codeLine="255" d="M1458.6771,1959.5104 C1510.6667,1966 1572.2604,1976.4896 1626.0417,1993.2292 C1697.8542,2015.5833 1773.3438,2050.125 1836.6875,2082.625 " fill="none" id="GpuTreeReductionRewriter-backto-HloPassFix" style="stroke:#FF0000;stroke-width:3.125;"/><polygon fill="none" points="1457.6146,1966.7292,1437.7708,1957.0417,1459.3229,1952.2396,1457.6146,1966.7292" style="stroke:#FF0000;stroke-width:3.125;"/><!--MD5=[38bde9a43229993e90a3beb2c6174022]
reverse link OpExpanderPass to GatherExpander--><path codeLine="256" d="M1560.4167,738.0208 C1560.4167,738.0208 1603.6979,869.875 1688.5417,922.3958 C1759.8021,966.5104 1858.5208,972.6354 1922.8125,970.9896 " fill="none" id="OpExpanderPass-backto-GatherExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[f46dcc7f908adba43b035cac209ad0c9]
reverse link HloModulePass to AlgebraicSimplifier--><path codeLine="257" d="M917.7083,4308.8542 C917.7083,4308.8542 992.3542,2546.6354 1057.2917,2467.1875 C1107.8438,2405.3438 1202.2396,2389.1146 1268.125,2385.8542 " fill="none" id="HloModulePass-backto-AlgebraicSimplifier" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[e80e7e618df0f34a9539cac64de7c5ad]
reverse link OpExpanderPass to BitcastDtypesExpander--><path codeLine="258" d="M1560.4167,738.0208 C1560.4167,738.0208 1581.2188,930.3646 1688.5417,1009.8958 C1750.2813,1055.6458 1839.2188,1063.4063 1904.1354,1061.6458 " fill="none" id="OpExpanderPass-backto-BitcastDtypesExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[c82d6d293a74661f8cee010d580e8bee]
reverse link HloModulePass to DotMerger--><path codeLine="259" d="M917.7083,4308.8542 C917.7083,4308.8542 904.4271,3495.5417 1057.2917,3341.1458 C1118.3125,3279.5104 1227.5313,3281.5104 1291.0625,3289.0729 " fill="none" id="HloModulePass-backto-DotMerger" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[4719144c7ac93371406024b082d6394a]
reverse link HloModulePass to SortSimplifier--><path codeLine="260" d="M917.7083,4308.8542 C917.7083,4308.8542 916.9688,3568.3958 1057.2917,3428.6458 C1116.1875,3369.9896 1218.8125,3369.2396 1283.0521,3375.8125 " fill="none" id="HloModulePass-backto-SortSimplifier" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[d4b4dbcaa8e4dcf74ffcbedaa7a96a65]
reverse link HloModulePass to TupleSimplifier--><path codeLine="261" d="M917.7083,4308.8542 C917.7083,4308.8542 929.4896,3641.2813 1057.2917,3516.1458 C1115.4375,3459.2083 1214.8854,3457.1563 1279.1563,3463.1042 " fill="none" id="HloModulePass-backto-TupleSimplifier" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[3f569408acd72bc25976f3252f06065c]
reverse link HloModulePass to WhileLoopConstantSinking--><path codeLine="262" d="M917.7083,4308.8542 C917.7083,4308.8542 941.9688,3714.1979 1057.2917,3603.6458 C1106.6042,3556.375 1184.4792,3547.2083 1246.125,3548.8854 " fill="none" id="HloModulePass-backto-WhileLoopConstantSinking" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[462130e9322c81efa8759f027f813abe]
reverse link HloModulePass to WhileLoopSimplifier--><path codeLine="263" d="M917.7083,4308.8542 C917.7083,4308.8542 954.4063,3787.1667 1057.2917,3691.1458 C1112.6979,3639.4479 1202.4167,3633.7604 1266.0313,3637.6563 " fill="none" id="HloModulePass-backto-WhileLoopSimplifier" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[2ff407945a41616e352a182c6d18dea6]
reverse link HloModulePass to SliceSinker--><path codeLine="264" d="M917.7083,4308.8542 C917.7083,4308.8542 966.7708,3860.1979 1057.2917,3778.6458 C1121.3646,3720.9271 1228.4792,3721.2917 1291.0313,3727.5625 " fill="none" id="HloModulePass-backto-SliceSinker" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[b7c262d2bf8c28ad33ce94add589eb58]
reverse link HloModulePass to ReshapeMover--><path codeLine="265" d="M917.7083,4308.8542 C917.7083,4308.8542 900.7396,4000.5104 1057.2917,3866.1458 C1118.8542,3813.3021 1216.8854,3810.0208 1279.9896,3814.6042 " fill="none" id="HloModulePass-backto-ReshapeMover" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[bc30e258c0c637409c3d29162efafce3]
reverse link HloModulePass to HloConstantFolding--><path codeLine="266" d="M917.7083,4308.8542 C917.7083,4308.8542 924.8438,4059.6146 1057.2917,3953.6458 C1115.4896,3907.0833 1202.5521,3900.0208 1264.7917,3902.1875 " fill="none" id="HloModulePass-backto-HloConstantFolding" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[2648d2f727e1f18a484ab9e451d03f5b]
reverse link HloModulePass to ConditionalSimplifier--><path codeLine="267" d="M917.7083,4308.8542 C917.7083,4308.8542 948.2188,4119.2917 1057.2917,4041.1458 C1116.6667,3998.6042 1201.0729,3990.4583 1262.3021,3991.2604 " fill="none" id="HloModulePass-backto-ConditionalSimplifier" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[9c99c1bc7eef250b9ed20b993e7fa848]
reverse link OpExpanderPass to RealImagExpander--><path codeLine="268" d="M1560.4167,738.0208 C1560.4167,738.0208 1557.4063,989.8958 1688.5417,1097.3958 C1752.2396,1149.6146 1850.2083,1154.2917 1916.6042,1150.0625 " fill="none" id="OpExpanderPass-backto-RealImagExpander" style="stroke:#4682B4;stroke-width:3.125;"/><!--MD5=[257ddcafb84a3c80e35aea690fc5d1f5]
reverse link HloModulePass to TransposeFolding--><path codeLine="269" d="M917.7083,4308.8542 C917.7083,4308.8542 970.0104,4180.0729 1057.2917,4128.6458 C1122.3646,4090.3021 1209.8438,4082.0417 1270.3125,4081.6771 " fill="none" id="HloModulePass-backto-TransposeFolding" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[52e9288833e0d9d4ada863e8c71c229c]
reverse link HloModulePass to HloCSE--><path codeLine="270" d="M917.7083,4308.8542 C917.7083,4308.8542 987.8542,4243.0625 1057.2917,4216.1458 C1139.8958,4184.125 1244.6146,4175.4896 1300.75,4173.1875 " fill="none" id="HloModulePass-backto-HloCSE" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[e55b624ea291de1bf85123f2fa218a14]
reverse link HloModulePass to HloDCE--><path codeLine="271" d="M917.7083,4308.8542 C917.7083,4308.8542 1193.5521,4276.9167 1299.6875,4264.6354 " fill="none" id="HloModulePass-backto-HloDCE" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[cfba99561db8f8b0ffe402dea0b5769f]
reverse link HloModulePass to WhileLoopTripCountAnnotator--><path codeLine="272" d="M917.7083,4308.8542 C917.7083,4308.8542 1109.4479,4326.3333 1234.7188,4337.7396 " fill="none" id="HloModulePass-backto-WhileLoopTripCountAnnotator" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[1ad489d15b7b55dadd0fa482b4b6f17c]
reverse link HloModulePass to AllReduceFolder--><path codeLine="273" d="M917.7083,4308.8542 C917.7083,4308.8542 989.4688,4366.9271 1057.2917,4391.1458 C1129.2396,4416.8333 1216.7813,4427.4479 1275.3333,4431.8229 " fill="none" id="HloModulePass-backto-AllReduceFolder" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[c6840dcf9071d63cc2868f0452592c69]
reverse link HloModulePass to ReduceScatterCreator--><path codeLine="274" d="M917.7083,4308.8542 C917.7083,4308.8542 962.6146,4353.9271 994.7917,4393.2292 C1024.5833,4429.625 1017.0938,4454.2083 1057.2917,4478.6458 C1118.2188,4515.6771 1199.6771,4524.9688 1259.6146,4525.9583 " fill="none" id="HloModulePass-backto-ReduceScatterCreator" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[36c11dd894609c8cb872c91bcc26188e]
reverse link HloModulePass to AllReduceReassociate--><path codeLine="275" d="M917.7083,4308.8542 C917.7083,4308.8542 968.5208,4349.7604 994.7917,4393.2292 C1037.0521,4463.1667 994.1979,4514.2188 1057.2917,4566.1458 C1113.5938,4612.4792 1198.25,4620.1146 1260.3646,4618.1667 " fill="none" id="HloModulePass-backto-AllReduceReassociate" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[57646a376e057a02fb94a41e5312a851]
reverse link HloModulePass to AllGatherBroadcastReorder--><path codeLine="276" d="M917.7083,4308.8542 C917.7083,4308.8542 970.9792,4348.3646 994.7917,4393.2292 C1050.5938,4498.3646 969.7292,4573.0208 1057.2917,4653.6458 C1106.9896,4699.4167 1183.6563,4708.9479 1244.7083,4707.8021 " fill="none" id="HloModulePass-backto-AllGatherBroadcastReorder" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[f7156a5c0527228dcd6757694b2c1c9b]
reverse link HloModulePass to GpusolverRewriter--><path codeLine="277" d="M917.7083,4308.8542 C917.7083,4308.8542 972.2917,4347.6979 994.7917,4393.2292 C1064.3958,4534.0729 944.8438,4631.4271 1057.2917,4741.1458 C1112.5938,4795.1146 1205.0313,4799.7083 1269.2083,4794.9792 " fill="none" id="HloModulePass-backto-GpusolverRewriter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[61d7f2cf979f52ffe51f041b304bd56c]
reverse link HloModulePass to GpuConvRewriter--><path codeLine="278" d="M917.7083,4308.8542 C917.7083,4308.8542 973.0938,4347.3021 994.7917,4393.2292 C1078.3125,4569.9896 919.7917,4689.6771 1057.2917,4828.6458 C1112.5104,4884.4583 1207.2708,4888.1042 1271.8646,4882.6771 " fill="none" id="HloModulePass-backto-GpuConvRewriter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[a6351459a8f193c176c6cbbc8a3cb7d0]
reverse link HloModulePass to GpuConvPaddingLegalization--><path codeLine="279" d="M917.7083,4308.8542 C917.7083,4308.8542 973.6354,4347.0521 994.7917,4393.2292 C1043.5417,4499.625 975.9688,4831.9896 1057.2917,4916.1458 C1103.2083,4963.6563 1177.6875,4973.6563 1238.7708,4972.2813 " fill="none" id="HloModulePass-backto-GpuConvPaddingLegalization" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[8fa7ef3244d39497cfa5b0726f3ad3e6]
reverse link HloModulePass to FlattenCallGraph--><path codeLine="280" d="M917.7083,4308.8542 C917.7083,4308.8542 974.0313,4346.875 994.7917,4393.2292 C1050.5313,4517.6667 963.375,4904.7917 1057.2917,5003.6458 C1112.2292,5061.4688 1209.4063,5064.0417 1274.4271,5057.8854 " fill="none" id="HloModulePass-backto-FlattenCallGraph" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[e9e4818e0d4eb7786ac361528b8b2057]
reverse link HloModulePass to LayoutAssignment--><path codeLine="281" d="M917.7083,4308.8542 C917.7083,4308.8542 974.3229,4346.7396 994.7917,4393.2292 C1057.5417,4535.7396 950.7604,4977.5833 1057.2917,5091.1458 C1110.3333,5147.6875 1203.7083,5151.625 1268.7083,5146.0313 " fill="none" id="HloModulePass-backto-LayoutAssignment" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[665863011d69386ea5d3a49e25949e4c]
reverse link LayoutAssignment to GpuLayoutAssignment--><path codeLine="282" d="M1436.0729,5134.8958 C1561.9479,5134.8958 1784.1563,5134.8958 1904.6667,5134.8958 " fill="none" id="LayoutAssignment-backto-GpuLayoutAssignment" style="stroke:#00CED1;stroke-width:3.125;"/><polygon fill="none" points="1435.6875,5142.1875,1414.8542,5134.8958,1435.6875,5127.6042,1435.6875,5142.1875" style="stroke:#00CED1;stroke-width:3.125;"/><!--MD5=[a8af1bcdf856db7e797c43f8fe4517cd]
reverse link HloModulePass to ReductionDegenerateDimRemover--><path codeLine="283" d="M917.7083,4308.8542 C917.7083,4308.8542 974.5521,4346.6458 994.7917,4393.2292 C1064.5625,4553.8229 938.1354,5050.3542 1057.2917,5178.6458 C1099.2083,5223.7813 1166.8125,5235.5 1225.4688,5235.5625 " fill="none" id="HloModulePass-backto-ReductionDegenerateDimRemover" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[631500c24ba98f9176dd2ae654d01473]
reverse link HloModulePass to ReductionLayoutNormalizer--><path codeLine="284" d="M917.7083,4308.8542 C917.7083,4308.8542 974.7396,4346.5625 994.7917,4393.2292 C1071.5729,4571.9063 925.5104,5123.125 1057.2917,5266.1458 C1103.3333,5316.1042 1180.8229,5325.2292 1243.1458,5322.8542 " fill="none" id="HloModulePass-backto-ReductionLayoutNormalizer" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[0fc1e9f545c9f217075fe673bf616ec6]
reverse link HloModulePass to ReductionDimensionGrouper--><path codeLine="285" d="M917.7083,4308.8542 C917.7083,4308.8542 974.8854,4346.5 994.7917,4393.2292 C1078.5938,4590 912.875,5195.8854 1057.2917,5353.6458 C1102.2396,5402.75 1177.5625,5412.4896 1239.25,5410.5833 " fill="none" id="HloModulePass-backto-ReductionDimensionGrouper" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[46ce81f7ea731ce70690df9863d22efa]
reverse link HloModulePass to ReductionSplitter--><path codeLine="286" d="M917.7083,4308.8542 C917.7083,4308.8542 974.5729,3338.1771 1057.2917,3253.6458 C1112.4688,3197.2604 1207.9271,3193.9271 1272.6458,3199.5625 " fill="none" id="HloModulePass-backto-ReductionSplitter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[ca803b8adae607034d1192de491788e7]
reverse link HloModulePass to GpuTreeReductionRewriter--><path codeLine="287" d="M917.7083,4308.8542 C917.7083,4308.8542 1046.4375,2005.1354 1057.2917,1993.2292 C1103.7188,1942.2708 1182.8438,1933.6458 1245.6875,1936.4583 " fill="none" id="HloModulePass-backto-GpuTreeReductionRewriter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[c60c9f2b23cc5e05113f203cd83e2c13]
reverse link HloModulePass to GemmRewriter--><path codeLine="288" d="M917.7083,4308.8542 C917.7083,4308.8542 975.0208,4346.4479 994.7917,4393.2292 C1040.2083,4500.6667 978.7604,5354.8958 1057.2917,5441.1458 C1112.6667,5501.9583 1214.6146,5502.4896 1279.9271,5495.2292 " fill="none" id="HloModulePass-backto-GemmRewriter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[1be0371f38c7c79ad70c77d8d2a272f7]
reverse link HloModulePass to GemmBroadcastFoldingRewriter--><path codeLine="289" d="M917.7083,4308.8542 C917.7083,4308.8542 975.125,4346.3958 994.7917,4393.2292 C1043.7188,4509.7188 972.4479,5435.0313 1057.2917,5528.6458 C1100.2396,5576.0313 1171.4583,5586.875 1231.75,5585.9167 " fill="none" id="HloModulePass-backto-GemmBroadcastFoldingRewriter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[f29465466bebabb9e136ea459aec15d0]
reverse link HloModulePass to GpuConvAlgorithmPicker--><path codeLine="290" d="M917.7083,4308.8542 C917.7083,4308.8542 975.2188,4346.3646 994.7917,4393.2292 C1047.2292,4518.7708 966.125,5515.1563 1057.2917,5616.1458 C1104.5729,5668.5208 1186.3542,5676.3021 1249.9479,5672.8229 " fill="none" id="HloModulePass-backto-GpuConvAlgorithmPicker" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[bfac023b2745d0b0e6c3e75649f6aacc]
reverse link HloModulePass to VariadicOpSplitter--><path codeLine="291" d="M917.7083,4308.8542 C917.7083,4308.8542 975.2917,4346.3229 994.7917,4393.2292 C1050.7396,4527.8333 959.8021,5595.2813 1057.2917,5703.6458 C1109.6354,5761.8333 1204.5833,5765.0417 1270.0417,5758.8646 " fill="none" id="HloModulePass-backto-VariadicOpSplitter" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[6ac50017b6df27684a8c0d98a97b5a39]
reverse link HloModulePass to InstructionFusion--><path codeLine="292" d="M917.7083,4308.8542 C917.7083,4308.8542 975.3646,4346.3021 994.7917,4393.2292 C1113.7292,4680.5417 915.2396,5514.5313 1057.2917,5791.1458 C1060.4375,5797.2708 1063.8333,5803.2813 1067.4583,5809.1771 " fill="none" id="HloModulePass-backto-InstructionFusion" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[2ba988fd607b4a3b8ab32f5437b005a4]
reverse link InstructionFusion to GpuInstructionFusion--><path codeLine="293" d="M1647.5104,6014.0625 C1725.1042,6014.0625 1804.0729,6014.0625 1866.4063,6014.0625 " fill="none" id="InstructionFusion-backto-GpuInstructionFusion" style="stroke:#C77182;stroke-width:3.125;"/><polygon fill="none" points="1647.0521,6021.3542,1626.2188,6014.0625,1647.0521,6006.7708,1647.0521,6021.3542" style="stroke:#C77182;stroke-width:3.125;"/><!--MD5=[8fb4f01c26d1a3ae23ad7e2ed93dc5ab]
reverse link HloModulePass to FusionMerger--><path codeLine="294" d="M917.7083,4308.8542 C917.7083,4308.8542 975.6146,4346.1979 994.7917,4393.2292 C1072.1667,4583.0417 921.25,6083.6563 1057.2917,6236.9792 C1112.625,6299.3438 1216.8438,6298.8229 1282.2917,6291.0208 " fill="none" id="HloModulePass-backto-FusionMerger" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[7813dd70215d10b60599628c9674c4df]
reverse link HloModulePass to GpuMultiOutputFusion--><path codeLine="295" d="M917.7083,4308.8542 C917.7083,4308.8542 975.6563,4346.1771 994.7917,4393.2292 C1075.6875,4592.1042 914.9271,6163.7708 1057.2917,6324.4792 C1105.8958,6379.3333 1192.3229,6385.5625 1256.9896,6380.9479 " fill="none" id="HloModulePass-backto-GpuMultiOutputFusion" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[771b5984584098528cf4e24483d4a9eb]
reverse link HloModulePass to GpuHorizontalLoopFusion--><path codeLine="296" d="M917.7083,4308.8542 C917.7083,4308.8542 975.6875,4346.1667 994.7917,4393.2292 C1037,4497.1979 982.9479,6327.9375 1057.2917,6411.9792 C1103.4583,6464.1667 1183.875,6472.3646 1247.2604,6469.0729 " fill="none" id="HloModulePass-backto-GpuHorizontalLoopFusion" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[2b5a7827a99d44ac002cd6094a9fd5dc]
reverse link HloModulePass to GpuHorizontalInputFusion--><path codeLine="297" d="M917.7083,4308.8542 C917.7083,4308.8542 975.7188,4346.1563 994.7917,4393.2292 C1038.75,4501.7292 979.7813,6411.75 1057.2917,6499.4792 C1103.2604,6551.5104 1183.2708,6559.8333 1246.5625,6556.625 " fill="none" id="HloModulePass-backto-GpuHorizontalInputFusion" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[37ee193c5afa837d7cc902b87b32c8f4]
reverse link HloModulePass to FusionBitcastLift--><path codeLine="298" d="M917.7083,4308.8542 C917.7083,4308.8542 975.75,4346.1458 994.7917,4393.2292 C1040.5104,4506.2604 976.6146,6495.5625 1057.2917,6586.9792 C1110.3958,6647.1563 1209.0104,6648.8854 1274.7396,6641.9167 " fill="none" id="HloModulePass-backto-FusionBitcastLift" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[5d383da11566a239b8c8a616b930e945]
reverse link HloModulePass to AllGatherCombiner--><path codeLine="299" d="M917.7083,4308.8542 C917.7083,4308.8542 975.7708,4346.1354 994.7917,4393.2292 C1042.2708,4510.7917 973.4583,6579.375 1057.2917,6674.4792 C1108.3021,6732.3542 1201.4167,6736.1875 1266.9375,6730.1979 " fill="none" id="HloModulePass-backto-AllGatherCombiner" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[97c74441ac337a1ad2774d025ecbb723]
reverse link HloModulePass to AllReduceCombiner--><path codeLine="300" d="M917.7083,4308.8542 C917.7083,4308.8542 975.7917,4346.125 994.7917,4393.2292 C1044.0313,4515.3229 970.2917,6663.1771 1057.2917,6761.9792 C1107.8646,6819.4063 1199.8958,6823.6354 1265.3333,6817.8542 " fill="none" id="HloModulePass-backto-AllReduceCombiner" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[f3c7987968621b2daa81a0b2bb0836bc]
reverse link HloModulePass to ReduceScatterCombiner--><path codeLine="301" d="M917.7083,4308.8542 C917.7083,4308.8542 975.8125,4346.1146 994.7917,4393.2292 C1045.7813,4519.8542 967.125,6746.9896 1057.2917,6849.4792 C1104.875,6903.5729 1189.2396,6910.4792 1253.5729,6906.2708 " fill="none" id="HloModulePass-backto-ReduceScatterCombiner" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[88ff9c807b4ec1c3fb28ab9cb38611f9]
reverse link HloModulePass to AllReduceContiguous--><path codeLine="302" d="M917.7083,4308.8542 C917.7083,4308.8542 975.8333,4346.1042 994.7917,4393.2292 C1047.5417,4524.375 963.9688,6830.8021 1057.2917,6936.9792 C1106.5,6992.9583 1195.0938,6998.4167 1260.1458,6993.3021 " fill="none" id="HloModulePass-backto-AllReduceContiguous" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[7c6bbc6e6b9d76816bfff186c9a78ff3]
reverse link HloModulePass to AllReduceBlueConnect--><path codeLine="303" d="M917.7083,4308.8542 C917.7083,4308.8542 975.8542,4346.0938 994.7917,4393.2292 C1049.3021,4528.9063 960.8021,6914.6146 1057.2917,7024.4792 C1105.9792,7079.9167 1193.3021,7085.8229 1258.1771,7080.9688 " fill="none" id="HloModulePass-backto-AllReduceBlueConnect" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[3089bb574c6bc82151086bd9b372a399]
reverse link HloModulePass to AsyncCollectiveCreator--><path codeLine="304" d="M917.7083,4308.8542 C917.7083,4308.8542 975.875,4346.0938 994.7917,4393.2292 C1051.0625,4533.4375 957.6354,6998.4271 1057.2917,7111.9792 C1105.2188,7166.5938 1190.6354,7173.1458 1255.1979,7168.6875 " fill="none" id="HloModulePass-backto-AsyncCollectiveCreator" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[880056fca4dc00a10a4632a12a004d27]
reverse link HloModulePass to CollectivesScheduleLinearizer--><path codeLine="305" d="M917.7083,4308.8542 C917.7083,4308.8542 975.8958,4346.0833 994.7917,4393.2292 C1052.8125,4537.9688 954.4792,7082.2396 1057.2917,7199.4792 C1101.0208,7249.3438 1175.9896,7259.1563 1237.8333,7257.0938 " fill="none" id="HloModulePass-backto-CollectivesScheduleLinearizer" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[72bb445fb4a9b0ea1a214fa502938e38]
reverse link HloModulePass to ShardingPropagation--><path codeLine="306" d="M917.7083,4308.8542 C917.7083,4308.8542 975.9063,4346.0729 994.7917,4393.2292 C1054.5729,4542.5 951.3125,7166.0417 1057.2917,7286.9792 C1106.8229,7343.5 1196.5,7348.5625 1261.7292,7343.2083 " fill="none" id="HloModulePass-backto-ShardingPropagation" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[7540448f33088403c11b3cb3142a127d]
reverse link HloModulePass to SpmdPartitioner--><path codeLine="307" d="M917.7083,4308.8542 C917.7083,4308.8542 975.9271,4346.0729 994.7917,4393.2292 C1056.3333,4547.0313 948.1458,7249.8542 1057.2917,7374.4792 C1110.5,7435.2292 1210.0729,7436.5521 1275.8646,7429.3646 " fill="none" id="HloModulePass-backto-SpmdPartitioner" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[fec36e15bb4629df7096a06ce19a757e]
reverse link SpmdPartitioner to GpuSpmdPartitioner--><path codeLine="308" d="M1428.4063,7418.2292 C1555.1875,7418.2292 1790.7604,7418.2292 1911.8333,7418.2292 " fill="none" id="SpmdPartitioner-backto-GpuSpmdPartitioner" style="stroke:#7FE994;stroke-width:3.125;"/><polygon fill="none" points="1428.375,7425.5208,1407.5417,7418.2292,1428.375,7410.9375,1428.375,7425.5208" style="stroke:#7FE994;stroke-width:3.125;"/><!--MD5=[e8ec50f6f7fde9824b406504bf426f50]
reverse link HloModulePass to ShardingRemover--><path codeLine="309" d="M917.7083,4308.8542 C917.7083,4308.8542 1051.6667,1911.9167 1057.2917,1905.7292 C1110.1875,1847.5417 1205.7188,1844.5104 1271.1042,1850.7187 " fill="none" id="HloModulePass-backto-ShardingRemover" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[d1905715c80418ea935a3e1e7e95f277]
reverse link HloModulePass to AliasPassthroughParams--><path codeLine="311" d="M917.7083,4308.8542 C917.7083,4308.8542 990.7188,2625.3229 1057.2917,2553.6458 C1105.5625,2501.6771 1187.8854,2494.0104 1251.3958,2497.4271 " fill="none" id="HloModulePass-backto-AliasPassthroughParams" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[e83a4bb56396b368c990827d0a224c9a]
reverse link HloModulePass to LoopScheduleLinearizer--><path codeLine="312" d="M917.7083,4308.8542 C917.7083,4308.8542 993.875,2709.1354 1057.2917,2641.1458 C1106.3438,2588.5521 1190.2917,2581.3854 1254.1146,2585.1354 " fill="none" id="HloModulePass-backto-LoopScheduleLinearizer" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[a4e9e359a38bfeb3fde62c889bd56b4f]
reverse link HloModulePass to GpuCopyInsertion--><path codeLine="313" d="M917.7083,4308.8542 C917.7083,4308.8542 936.7813,2857.2708 1057.2917,2728.6458 C1110.5521,2671.8021 1204.5833,2668.1042 1269.625,2673.8229 " fill="none" id="HloModulePass-backto-GpuCopyInsertion" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[5cc36f0c6d33c81e925cdbd4c7b15feb]
reverse link HloModulePass to GpuSanitizeConstantNames--><path codeLine="314" d="M917.7083,4308.8542 C917.7083,4308.8542 943.0833,2937.4167 1057.2917,2816.1458 C1103.875,2766.6875 1181.3333,2757.5312 1243.5,2759.7604 " fill="none" id="HloModulePass-backto-GpuSanitizeConstantNames" style="stroke:#008B8B;stroke-width:3.125;"/><!--MD5=[6c708314b03c489d71a5a608fe7a08fa]
@startuml HLO-Passes-UML
skinparam groupInheritance 6
left to right direction
'top to bottom direction
!theme cerulean-outline

' Create from the analysis of GpuCompiler::OptimizeHloModule
' https://github.com/tensorflow/tensorflow/blob/f386883f9f5995aa0f6e0988e29dd67f809271e5/tensorflow/compiler/xla/service/gpu/gpu_compiler.cc#L267
' https://github.com/tensorflow/tensorflow/blob/f386883f9f5995aa0f6e0988e29dd67f809271e5/tensorflow/compiler/xla/service/gpu/gpu_compiler.cc#L745

interface HloPassInterface {
    + {abstract} name(): absl::string_view
    + {abstract} Run(module: HloModule*): StatusOr<bool>
    + {abstract} RunOnModuleGroup(module_group: HloModuleGroup*): StatusOr<bool>
    + {method} RunOnChangedComputations(module: HloModule*, run_state: RunState*): Status
    + {method} IsPassPipeline(): bool
}

abstract class HloModulePass {
    + {method} RunOnModuleGroup: <b><color:#008080>override</color></b>
    + {method} UpdateLayout(shape: Shape*): void
}

abstract class HloModuleGroupPass {
    + {method} Run: <b><color:#008080>override</color></b> (<color:red>prohibit</color>)
}
' note left of HloModuleGroupPass::Run
' Calling the <b>Run</b> method will return an error:
' Module group pass cannot be run on a module.
' end note

abstract class OpExpanderPass {
    + {field} PatternExtraFilter: std::function<bool(const HloInstruction*)>
    # {field} extra_filter_: PatternExtraFilter
    + {method} Run: <b><color:#008080>override</color></b>
    # {method} InstructionMatchesPattern(instruction: HloInstruction*): bool
    # {method} ExpandInstruction(instruction: HloInstruction*): HloInstruction*
}

class HloPassFix<typename Pass, is_base_of<HloPassInterface, Pass>, HloPassFix extends Pass> {
    + {method} Run: <b><color:#008080>override</color></b>
    + {method} RunOnModuleGroup: <b><color:#008080>override</color></b>
    + {method} RunOnChangedComputations: <b><color:#008080>override</color></b>
    - {method} RunToFixPoint(module: HloModule*, run_state: RunState*): Status
    - {method} RunOnChangedComputationsOnce(module: HloModule*, run_state: RunState*): Status
}

class HloPassPipeline {
    - {field} passes_: std::vector<std::unique_ptr<HloPassInterface>>
    - {field} invariant_checkers_: std::vector<std::unique_ptr<HloPassInterface>>
    + {method} name: <b><color:#008080>override</color></b>
    + {method} Run: <b><color:#008080>override</color></b>
    + {method} RunOnModuleGroup: <b><color:#008080>override</color></b>
    + {method} IsPassPipeline: <b><color:#008080>override</color></b>
    + {method} AddPass(args: Args&&...): T&
    + {method} AddInvariantChecker(args: Args&&...): T&
    + {method} PassesSize(): int
    + {method} GetPass(index: int): HloPassInterface&
}

' GpuCompiler::OptimizeHloModule
class HloVerifier

' optimization pipeline
class AllToAllDecomposer{
    - decompose_to_tuple_: bool
    - min_array_rank_: int64_t
}
class OperandUpcaster
class ResultCaster
note top of ResultCaster
ResultCaster should run
after OperandUpcaster.
end note

class RngExpander
class RngBitGeneratorExpander
class ZeroSizedHloElimination
note top of ZeroSizedHloElimination: Replaces zero sized Hlos\nwith a zero sized constant\nliteral.
class GpuScatterExpander
class ScatterExpander
class QrExpander
class EighExpander
class DynamicIndexSplitter
class CallInliner
class DotDecomposer
class Convolution4DExpander
class StableSortExpander
class BFloat16Normalization
note right of BFloat16Normalization: Add F32 <-> BF16 conversions\nfor HLO instructions that don't\nsupport BF16 input/output or\nmixedprecision
class BatchNormExpander {
    - rewrite_training_op_: bool
    - rewrite_inference_op_: bool
    - rewrite_grad_op_: bool
}
note right of BatchNormExpander: `rewrite_inference_op_`\nis always true for GPU.\n All three of them are set\nto true by default for GPU.
class CudnnBatchNormRewriter
class LogisticExpander
class ConditionalCanonicalizer
class DynamicDimensionSimplifier
class DynamicPadder
class GatherExpander
' AlgebraicSimplifier is important
class AlgebraicSimplifier
class BitcastDtypesExpander
class DotDecomposer
class DotMerger
class SortSimplifier
class TupleSimplifier
class WhileLoopConstantSinking
class WhileLoopSimplifier
class SliceSinker
class ReshapeMover
class HloConstantFolding
class ConditionalSimplifier
class RealImagExpander
class TransposeFolding
note right of TransposeFolding: Fold transpose operators\ninto Dot operators.
class HloCSE
class HloDCE
class WhileLoopTripCountAnnotator

' collective optimizations pipeline
class AllReduceFolder
class ReduceScatterCreator
class AllReduceReassociate
class AllGatherBroadcastReorder

' target-specific HLO optimization passes for convolution canonicalization
' conv canonicalization pipeline
class GpusolverRewriter
class GpuConvRewriter
class GpuConvPaddingLegalization

' layout assignment optimization passes
class FlattenCallGraph
class LayoutAssignment
class GpuLayoutAssignment

' target-specific HLO optimization passes after layout assignment
' post layout_assignment pipeline
class ReductionDegenerateDimRemover
class ReductionLayoutNormalizer
class ReductionDimensionGrouper
class ReductionSplitter
class GpuTreeReductionRewriter
' AlgebraicSimplifier
' TransposeFolding
class GemmRewriter
class GemmBroadcastFoldingRewriter
note right of GemmBroadcastFoldingRewriter: Rewrite GEMMs with broadcasted\ninputs as strided GEMMs.
class GpuConvAlgorithmPicker

' fusion optimization pipeline
class VariadicOpSplitter
note right of VariadicOpSplitter: Split variadic ops with many\nparameters into several.
' split variadic ops with many parameters into several such ops to avoid exceeding the parameter space.

' fusion is needed to learn about in detail
class InstructionFusion {
    - {field} is_expensive_: std::function<bool(const HloInstruction& instruction)>
    - {field} may_duplicate_: bool
    {field} ......
    + {method} Run: <b><color:#008080>override</color></b>
    + {method} name: <b><color:#008080>override</color></b>
    + {static} IsExpensive(instruction: const HloInstruction&): bool
    + {static} ShouldFuseInPlaceOp(producer: const HloInstruction*, consumer: const HloInstruction*): bool
    # {method} GetFusionComputations(module: HloModule*): std::vector<HloComputation*>
    # {method} ShouldFuse(consumer: HloInstruction*, operand_index: int64_t): bool
    # {method} ShouldFuseIntoMultiOutput(consumer: HloInstruction*, operand_index: int64_t): bool
    # {method} ChooseKind(producer: const HloInstruction*, consumer: const HloInstruction*): FusionKind
    # {method} FuseInstruction(fusion_instruction: HloInstruction*, producer: HloInstruction*): HloInstruction*
    # {method} Fuse(producer: HloInstruction*, consumer: HloInstruction*): HloInstruction*
    - {method} AddFusionInstruction(producer: HloInstruction*, consumer: HloInstruction*): HloInstruction*
    {method} ......
}

class GpuInstructionFusion {
    + {static} {method} IsExpensive: <b><color:#008080>override</color></b>
    + {method} ShouldFuse: <b><color:#008080>override</color></b>
    + {method} ShouldFuseIntoMultiOutput: <b><color:#008080>override</color></b>
    + {method} ChooseKind: <b><color:#008080>override</color></b>
    + {method} Run: <b><color:#008080>override</color></b>
    - {method} FuseInstruction: <b><color:#008080>override</color></b>
}
' GpuInstructionFusion: may_duplicate=false
' GpuInstructionFusion: may_duplicate=true
class FusionMerger
class GpuMultiOutputFusion

' horizontal fusion pipeline: important
class GpuHorizontalLoopFusion
class GpuHorizontalInputFusion
' FusionBitcastLift must be after InstructionFusion
class FusionBitcastLift

' post-fusion optimization pipeline
class AllGatherCombiner
class AllReduceCombiner
class ReduceScatterCombiner
' AllReduceBlueConnect&AllReduceContiguous&AsyncCollectiveCreator are optional
class AllReduceContiguous
class AllReduceBlueConnect
class AsyncCollectiveCreator
class CollectivesScheduleLinearizer

' spmd partitioner pipeline
class ShardingPropagation
class SpmdPartitioner
class GpuSpmdPartitioner
class ShardingRemover

' GpuCompiler::PrepareHloModuleForIrEmitting
' Modifies the given HLO module so that it will be accepted by IrEmitter.
' Unlike optimization passes, the passes are necessary for correctness.
' GPU ir emit prepare pipeline
package "Just for correctness" #E3F2FD {
    class AliasPassthroughParams
    class LoopScheduleLinearizer
    class GpuCopyInsertion
    class GpuSanitizeConstantNames
}

HloPassInterface <|- - HloModulePass
HloPassInterface <|- - HloModuleGroupPass
HloPassInterface <|- - HloPassPipeline

HloModulePass <|- - HloVerifier #line:DarkCyan
HloModulePass <|- - OpExpanderPass #line:DarkCyan
OpExpanderPass <|- - AllToAllDecomposer #line:SteelBlue
OpExpanderPass <|- - OperandUpcaster #line:SteelBlue
OpExpanderPass <|- - ResultCaster #line:SteelBlue
' ResultCaster <.. OperandUpcaster
OpExpanderPass <|- - RngExpander #line:SteelBlue
OpExpanderPass <|- - RngBitGeneratorExpander #line:SteelBlue
OpExpanderPass <|- - ZeroSizedHloElimination #line:SteelBlue
OpExpanderPass <|- - ScatterExpander #line:SteelBlue
ScatterExpander <|- - GpuScatterExpander #line:Cyan
OpExpanderPass <|- - QrExpander #line:SteelBlue
OpExpanderPass <|- - EighExpander #line:SteelBlue
HloModulePass <|- - DynamicIndexSplitter #line:DarkCyan
HloModulePass <|- - CallInliner #line:DarkCyan
HloModulePass <|- - DotDecomposer #line:DarkCyan
OpExpanderPass <|- - Convolution4DExpander #line:SteelBlue
OpExpanderPass <|- - StableSortExpander #line:SteelBlue
HloModulePass <|- - BFloat16Normalization #line:DarkCyan
HloModulePass <|- - BatchNormExpander #line:DarkCyan
HloModulePass <|- - CudnnBatchNormRewriter #line:DarkCyan
OpExpanderPass <|- - LogisticExpander #line:SteelBlue
HloModulePass <|- - ConditionalCanonicalizer #line:DarkCyan
HloModulePass <|- - DynamicDimensionSimplifier #line:DarkCyan
HloModulePass <|- - DynamicPadder #line:DarkCyan
HloPassPipeline <|- - HloPassFix #line:Red
AlgebraicSimplifier <|- - HloPassFix #line:Red
ReductionSplitter <|- - HloPassFix #line:Red
GpuTreeReductionRewriter <|- - HloPassFix #line:Red
OpExpanderPass <|- - GatherExpander #line:SteelBlue
HloModulePass <|- - AlgebraicSimplifier #line:DarkCyan
OpExpanderPass <|- - BitcastDtypesExpander #line:SteelBlue
HloModulePass <|- - DotMerger #line:DarkCyan
HloModulePass <|- - SortSimplifier #line:DarkCyan
HloModulePass <|- - TupleSimplifier #line:DarkCyan
HloModulePass <|- - WhileLoopConstantSinking #line:DarkCyan
HloModulePass <|- - WhileLoopSimplifier #line:DarkCyan
HloModulePass <|- - SliceSinker #line:DarkCyan
HloModulePass <|- - ReshapeMover #line:DarkCyan
HloModulePass <|- - HloConstantFolding #line:DarkCyan
HloModulePass <|- - ConditionalSimplifier #line:DarkCyan
OpExpanderPass <|- - RealImagExpander #line:SteelBlue
HloModulePass <|- - TransposeFolding #line:DarkCyan
HloModulePass <|- - HloCSE #line:DarkCyan
HloModulePass <|- - HloDCE #line:DarkCyan
HloModulePass <|- - WhileLoopTripCountAnnotator #line:DarkCyan
HloModulePass <|- - AllReduceFolder #line:DarkCyan
HloModulePass <|- - ReduceScatterCreator #line:DarkCyan
HloModulePass <|- - AllReduceReassociate #line:DarkCyan
HloModulePass <|- - AllGatherBroadcastReorder #line:DarkCyan
HloModulePass <|- - GpusolverRewriter #line:DarkCyan
HloModulePass <|- - GpuConvRewriter #line:DarkCyan
HloModulePass <|- - GpuConvPaddingLegalization #line:DarkCyan
HloModulePass <|- - FlattenCallGraph #line:DarkCyan
HloModulePass <|- - LayoutAssignment #line:DarkCyan
LayoutAssignment <|- - GpuLayoutAssignment #line:DarkTurquoise
HloModulePass <|- - ReductionDegenerateDimRemover #line:DarkCyan
HloModulePass <|- - ReductionLayoutNormalizer #line:DarkCyan
HloModulePass <|- - ReductionDimensionGrouper #line:DarkCyan
HloModulePass <|- - ReductionSplitter #line:DarkCyan
HloModulePass <|- - GpuTreeReductionRewriter #line:DarkCyan
HloModulePass <|- - GemmRewriter #line:DarkCyan
HloModulePass <|- - GemmBroadcastFoldingRewriter #line:DarkCyan
HloModulePass <|- - GpuConvAlgorithmPicker #line:DarkCyan
HloModulePass <|- - VariadicOpSplitter #line:DarkCyan
HloModulePass <|- - InstructionFusion #line:DarkCyan
InstructionFusion <|- - GpuInstructionFusion #line:c77182
HloModulePass <|- - FusionMerger #line:DarkCyan
HloModulePass <|- - GpuMultiOutputFusion #line:DarkCyan
HloModulePass <|- - GpuHorizontalLoopFusion #line:DarkCyan
HloModulePass <|- - GpuHorizontalInputFusion #line:DarkCyan
HloModulePass <|- - FusionBitcastLift #line:DarkCyan
HloModulePass <|- - AllGatherCombiner #line:DarkCyan
HloModulePass <|- - AllReduceCombiner #line:DarkCyan
HloModulePass <|- - ReduceScatterCombiner #line:DarkCyan
HloModulePass <|- - AllReduceContiguous #line:DarkCyan
HloModulePass <|- - AllReduceBlueConnect #line:DarkCyan
HloModulePass <|- - AsyncCollectiveCreator #line:DarkCyan
HloModulePass <|- - CollectivesScheduleLinearizer #line:DarkCyan
HloModulePass <|- - ShardingPropagation #line:DarkCyan
HloModulePass <|- - SpmdPartitioner #line:DarkCyan
SpmdPartitioner <|- - GpuSpmdPartitioner #line:7fe994
HloModulePass <|- - ShardingRemover #line:DarkCyan

HloModulePass <|- - AliasPassthroughParams #line:DarkCyan
HloModulePass <|- - LoopScheduleLinearizer #line:DarkCyan
HloModulePass <|- - GpuCopyInsertion #line:DarkCyan
HloModulePass <|- - GpuSanitizeConstantNames #line:DarkCyan

@enduml

@startuml HLO-Passes-UML
skinparam groupInheritance 6
left to right direction



skinparam backgroundColor transparent
skinparam useBetaStyle false






<style>
  root {
    BackgroundColor transparent
    FontColor #2FA4E7
    HyperLinkColor #FD7E14
    LineColor #2683B9
    LineThickness 1
    Margin 10
    Padding 6
    Shadowing 0.0
  }
  node {
   Padding 15
   roundcorner 20
   BackgroundColor transparent
  }
  caption {
    LineThickness 0
  }
  footer {
    LineThickness 0
  }
  groupHeader {
    BackgroundColor #E9ECEF
    FontColor #033C73
    FontStyle bold
  }
  header {
    LineThickness 0
  }
  referenceHeader {
    BackgroundColor transparent
    FontColor #343A40
    FontStyle bold
  }
  separator {
    BackgroundColor #343A40
    FontColor transparent
    FontStyle bold
  }
  title {
	FontSize 20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor  transparent
	FontColor #2FA4E7
	BorderColor #E9ECEF
  }
  nwdiagDiagram {
	network {
			FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent    
		LineColor #2FA4E7
		LineThickness 1.0
		FontColor #2683B9
	}
	server {
			FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	}
	arrow {
		FontColor #2683B9
		LineColor #2683B9
	}
	group {
		BackGroundColor #F8F9FA
		LineColor $LIGHT_DARK
		LineThickness 2.0
		Margin 5
		Padding 5
	}
  }
  ganttDiagram {
	task {
			FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
		LineColor #2FA4E7
		Margin 10
		Padding 6
	}
	note {
		FontColor #033C73
		LineColor $INFO_DARK
		BackGroundColor transparent
	}
	separator {
		LineColor #BABDBF
		BackGroundColor transparent
		FontColor #BABDBF
	}
	milestone {
		FontColor #033C73
		FontSize 16
		FontStyle italic
		BackGroundColor #E9ECEF
		LineColor #BABDBF
	}
	timeline {
		BackgroundColor #E9ECEF
		FontColor #BABDBF
	}
	closed {
		BackgroundColor $WARNING_DARK
		FontColor #DD5600
	}
  }
</style>
skinparam defaultFontName       "Verdana"
skinparam defaultFontSize       12
skinparam dpi                   100
skinparam shadowing             false
skinparam roundcorner           8
skinparam ParticipantPadding    40
skinparam BoxPadding            40
skinparam Padding               5
skinparam ArrowColor            #868E96
skinparam stereotype {
    CBackgroundColor #EDF0F2
    CBorderColor #BABDBF
    ABackgroundColor #8FB961
    ABorderColor $SUCCESS_DARK
    IBackgroundColor #D2494E
    IBorderColor $DANGER_DARK
    EBackgroundColor #E47833
    EBorderColor $WARNING_DARK
    NBackgroundColor #35638F
    NBorderColor $INFO_DARK
}
skinparam title {
	FontColor	                 #2FA4E7
	BorderColor	                 #BABDBF
	FontSize	    	         20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor              transparent
}

skinparam legend {
	BackgroundColor transparent
	BorderColor #BABDBF
	FontColor #343A40
}

skinparam swimlane {
	BorderColor #033C73
	BorderThickness 2
	TitleBackgroundColor  #EDF0F2-#E9ECEF
	TitleFontColor #2FA4E7
}


skinparam activity {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	BarColor #73A839
	StartColor #033C73
	EndColor #033C73
	DiamondBackgroundColor transparent
  	DiamondBorderColor #BABDBF
	DiamondFontColor #BABDBF
}


skinparam participant {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	ParticipantBorderThickness 2
}


skinparam actor {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam arrow {
	Thickness 3
	Color #2FA4E7
	FontColor #343A40
}


skinparam sequence {
	BorderColor #2FA4E7
	TitleFontColor #2FA4E7
	BackgroundColor transparent
	StartColor #2FA4E7
	EndColor #2FA4E7
	BoxBackgroundColor transparent
	BoxBorderColor #868E96
	BoxFontColor #343A40
	DelayFontColor #343A40
	LifeLineBorderColor #BABDBF
	LifeLineBorderThickness 2
	LifeLineBackgroundColor transparent
	GroupBorderColor #868E96
	GroupFontColor #343A40
	GroupHeaderFontColor #033C73
	DividerBackgroundColor transparent
    DividerBorderColor #868E96
    DividerBorderThickness 2
    DividerFontColor #343A40
	ReferenceBackgroundColor transparent
	ReferenceBorderColor #868E96
	ReferenceFontColor #343A40
	ReferenceHeaderFontColor #033C73
	StereotypeFontColor #2FA4E7
}


skinparam partition {
	BorderColor #2FA4E7
	FontColor #2FA4E7
	BackgroundColor transparent
}


skinparam collections {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam control {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam entity {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam boundary {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam agent {
	BackgroundColor transparent
	BorderColor #999999
	FontColor #333333
}


skinparam note {
	BorderThickness 1
	BackgroundColor transparent
	BorderColor #033C73
	FontColor #033C73
}


skinparam artifact {
	BackgroundColor transparent
	BorderColor #868E96
	FontColor #868E96
}


skinparam component {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam interface {
	BackgroundColor  transparent
	BorderColor  #C71C22
	FontColor #343A40
}


skinparam storage {
	BackgroundColor transparent
  	BorderColor #DD5600
	FontColor #DD5600
}


skinparam node {
	BackgroundColor transparent
	BorderColor #343A40
	FontColor #343A40
}


skinparam cloud {
	BackgroundColor #F2FCFE-#eeeeee
	BorderColor #F2FCFE
	FontColor #343A40
}


skinparam database {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam class {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	FontColor #F8F9FA
	HeaderBackgroundColor #2FA4E7-#2683B9
	StereotypeFontColor #343A40
	BorderThickness 1
	AttributeFontColor #343A40
	AttributeFontSize 11
}


skinparam object {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	StereotypeFontColor #343A40
	BorderThickness 1
	AttributeFontColor #BABDBF
	AttributeFontSize 11
}


skinparam usecase {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	BorderThickness 2
	StereotypeFontColor #2FA4E7
}


skinparam rectangle {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	BorderThickness 2
	StereotypeFontColor #2FA4E7
}


skinparam package {
	BackgroundColor transparent
  	BorderColor #2FA4E7
	FontColor #2FA4E7
	BorderThickness 2
}


skinparam folder {
	BackgroundColor transparent
  	BorderColor #DD5600
	FontColor #DD5600
	BorderThickness 2
}


skinparam frame {
	BackgroundColor transparent
  	BorderColor #033C73
	FontColor #033C73
	BorderThickness 2
}


skinparam state {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
	StartColor #033C73
	EndColor #033C73
	AttributeFontColor #BABDBF
	AttributeFontSize 11
}


skinparam queue {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}


skinparam card {
	BackgroundColor transparent
	BorderColor #033C73
	FontColor #033C73
}


skinparam file {
	BackgroundColor transparent
	BorderColor #868E96
	FontColor #868E96
}


skinparam stack {
		FontColor #2FA4E7
	BorderColor #2FA4E7
	BackgroundColor transparent
}





interface HloPassInterface {
    + {abstract} name(): absl::string_view
    + {abstract} Run(module: HloModule*): StatusOr<bool>
    + {abstract} RunOnModuleGroup(module_group: HloModuleGroup*): StatusOr<bool>
    + {method} RunOnChangedComputations(module: HloModule*, run_state: RunState*): Status
    + {method} IsPassPipeline(): bool
}

abstract class HloModulePass {
    + {method} RunOnModuleGroup: <b><color:#008080>override</color></b>
    + {method} UpdateLayout(shape: Shape*): void
}

abstract class HloModuleGroupPass {
    + {method} Run: <b><color:#008080>override</color></b> (<color:red>prohibit</color>)
}

abstract class OpExpanderPass {
    + {field} PatternExtraFilter: std::function<bool(const HloInstruction*)>
    # {field} extra_filter_: PatternExtraFilter
    + {method} Run: <b><color:#008080>override</color></b>
    # {method} InstructionMatchesPattern(instruction: HloInstruction*): bool
    # {method} ExpandInstruction(instruction: HloInstruction*): HloInstruction*
}

class HloPassFix<typename Pass, is_base_of<HloPassInterface, Pass>, HloPassFix extends Pass> {
    + {method} Run: <b><color:#008080>override</color></b>
    + {method} RunOnModuleGroup: <b><color:#008080>override</color></b>
    + {method} RunOnChangedComputations: <b><color:#008080>override</color></b>
    - {method} RunToFixPoint(module: HloModule*, run_state: RunState*): Status
    - {method} RunOnChangedComputationsOnce(module: HloModule*, run_state: RunState*): Status
}

class HloPassPipeline {
    - {field} passes_: std::vector<std::unique_ptr<HloPassInterface>>
    - {field} invariant_checkers_: std::vector<std::unique_ptr<HloPassInterface>>
    + {method} name: <b><color:#008080>override</color></b>
    + {method} Run: <b><color:#008080>override</color></b>
    + {method} RunOnModuleGroup: <b><color:#008080>override</color></b>
    + {method} IsPassPipeline: <b><color:#008080>override</color></b>
    + {method} AddPass(args: Args&&...): T&
    + {method} AddInvariantChecker(args: Args&&...): T&
    + {method} PassesSize(): int
    + {method} GetPass(index: int): HloPassInterface&
}

class HloVerifier

class AllToAllDecomposer{
    - decompose_to_tuple_: bool
    - min_array_rank_: int64_t
}
class OperandUpcaster
class ResultCaster
note top of ResultCaster
ResultCaster should run
after OperandUpcaster.
end note

class RngExpander
class RngBitGeneratorExpander
class ZeroSizedHloElimination
note top of ZeroSizedHloElimination: Replaces zero sized Hlos\nwith a zero sized constant\nliteral.
class GpuScatterExpander
class ScatterExpander
class QrExpander
class EighExpander
class DynamicIndexSplitter
class CallInliner
class DotDecomposer
class Convolution4DExpander
class StableSortExpander
class BFloat16Normalization
note right of BFloat16Normalization: Add F32 <-> BF16 conversions\nfor HLO instructions that don't\nsupport BF16 input/output or\nmixedprecision
class BatchNormExpander {
    - rewrite_training_op_: bool
    - rewrite_inference_op_: bool
    - rewrite_grad_op_: bool
}
note right of BatchNormExpander: `rewrite_inference_op_`\nis always true for GPU.\n All three of them are set\nto true by default for GPU.
class CudnnBatchNormRewriter
class LogisticExpander
class ConditionalCanonicalizer
class DynamicDimensionSimplifier
class DynamicPadder
class GatherExpander
class AlgebraicSimplifier
class BitcastDtypesExpander
class DotDecomposer
class DotMerger
class SortSimplifier
class TupleSimplifier
class WhileLoopConstantSinking
class WhileLoopSimplifier
class SliceSinker
class ReshapeMover
class HloConstantFolding
class ConditionalSimplifier
class RealImagExpander
class TransposeFolding
note right of TransposeFolding: Fold transpose operators\ninto Dot operators.
class HloCSE
class HloDCE
class WhileLoopTripCountAnnotator

class AllReduceFolder
class ReduceScatterCreator
class AllReduceReassociate
class AllGatherBroadcastReorder

class GpusolverRewriter
class GpuConvRewriter
class GpuConvPaddingLegalization

class FlattenCallGraph
class LayoutAssignment
class GpuLayoutAssignment

class ReductionDegenerateDimRemover
class ReductionLayoutNormalizer
class ReductionDimensionGrouper
class ReductionSplitter
class GpuTreeReductionRewriter
class GemmRewriter
class GemmBroadcastFoldingRewriter
note right of GemmBroadcastFoldingRewriter: Rewrite GEMMs with broadcasted\ninputs as strided GEMMs.
class GpuConvAlgorithmPicker

class VariadicOpSplitter
note right of VariadicOpSplitter: Split variadic ops with many\nparameters into several.

class InstructionFusion {
    - {field} is_expensive_: std::function<bool(const HloInstruction& instruction)>
    - {field} may_duplicate_: bool
    {field} ......
    + {method} Run: <b><color:#008080>override</color></b>
    + {method} name: <b><color:#008080>override</color></b>
    + {static} IsExpensive(instruction: const HloInstruction&): bool
    + {static} ShouldFuseInPlaceOp(producer: const HloInstruction*, consumer: const HloInstruction*): bool
    # {method} GetFusionComputations(module: HloModule*): std::vector<HloComputation*>
    # {method} ShouldFuse(consumer: HloInstruction*, operand_index: int64_t): bool
    # {method} ShouldFuseIntoMultiOutput(consumer: HloInstruction*, operand_index: int64_t): bool
    # {method} ChooseKind(producer: const HloInstruction*, consumer: const HloInstruction*): FusionKind
    # {method} FuseInstruction(fusion_instruction: HloInstruction*, producer: HloInstruction*): HloInstruction*
    # {method} Fuse(producer: HloInstruction*, consumer: HloInstruction*): HloInstruction*
    - {method} AddFusionInstruction(producer: HloInstruction*, consumer: HloInstruction*): HloInstruction*
    {method} ......
}

class GpuInstructionFusion {
    + {static} {method} IsExpensive: <b><color:#008080>override</color></b>
    + {method} ShouldFuse: <b><color:#008080>override</color></b>
    + {method} ShouldFuseIntoMultiOutput: <b><color:#008080>override</color></b>
    + {method} ChooseKind: <b><color:#008080>override</color></b>
    + {method} Run: <b><color:#008080>override</color></b>
    - {method} FuseInstruction: <b><color:#008080>override</color></b>
}
class FusionMerger
class GpuMultiOutputFusion

class GpuHorizontalLoopFusion
class GpuHorizontalInputFusion
class FusionBitcastLift

class AllGatherCombiner
class AllReduceCombiner
class ReduceScatterCombiner
class AllReduceContiguous
class AllReduceBlueConnect
class AsyncCollectiveCreator
class CollectivesScheduleLinearizer

class ShardingPropagation
class SpmdPartitioner
class GpuSpmdPartitioner
class ShardingRemover

package "Just for correctness" #E3F2FD {
    class AliasPassthroughParams
    class LoopScheduleLinearizer
    class GpuCopyInsertion
    class GpuSanitizeConstantNames
}

HloPassInterface <|- - HloModulePass
HloPassInterface <|- - HloModuleGroupPass
HloPassInterface <|- - HloPassPipeline

HloModulePass <|- - HloVerifier #line:DarkCyan
HloModulePass <|- - OpExpanderPass #line:DarkCyan
OpExpanderPass <|- - AllToAllDecomposer #line:SteelBlue
OpExpanderPass <|- - OperandUpcaster #line:SteelBlue
OpExpanderPass <|- - ResultCaster #line:SteelBlue
OpExpanderPass <|- - RngExpander #line:SteelBlue
OpExpanderPass <|- - RngBitGeneratorExpander #line:SteelBlue
OpExpanderPass <|- - ZeroSizedHloElimination #line:SteelBlue
OpExpanderPass <|- - ScatterExpander #line:SteelBlue
ScatterExpander <|- - GpuScatterExpander #line:Cyan
OpExpanderPass <|- - QrExpander #line:SteelBlue
OpExpanderPass <|- - EighExpander #line:SteelBlue
HloModulePass <|- - DynamicIndexSplitter #line:DarkCyan
HloModulePass <|- - CallInliner #line:DarkCyan
HloModulePass <|- - DotDecomposer #line:DarkCyan
OpExpanderPass <|- - Convolution4DExpander #line:SteelBlue
OpExpanderPass <|- - StableSortExpander #line:SteelBlue
HloModulePass <|- - BFloat16Normalization #line:DarkCyan
HloModulePass <|- - BatchNormExpander #line:DarkCyan
HloModulePass <|- - CudnnBatchNormRewriter #line:DarkCyan
OpExpanderPass <|- - LogisticExpander #line:SteelBlue
HloModulePass <|- - ConditionalCanonicalizer #line:DarkCyan
HloModulePass <|- - DynamicDimensionSimplifier #line:DarkCyan
HloModulePass <|- - DynamicPadder #line:DarkCyan
HloPassPipeline <|- - HloPassFix #line:Red
AlgebraicSimplifier <|- - HloPassFix #line:Red
ReductionSplitter <|- - HloPassFix #line:Red
GpuTreeReductionRewriter <|- - HloPassFix #line:Red
OpExpanderPass <|- - GatherExpander #line:SteelBlue
HloModulePass <|- - AlgebraicSimplifier #line:DarkCyan
OpExpanderPass <|- - BitcastDtypesExpander #line:SteelBlue
HloModulePass <|- - DotMerger #line:DarkCyan
HloModulePass <|- - SortSimplifier #line:DarkCyan
HloModulePass <|- - TupleSimplifier #line:DarkCyan
HloModulePass <|- - WhileLoopConstantSinking #line:DarkCyan
HloModulePass <|- - WhileLoopSimplifier #line:DarkCyan
HloModulePass <|- - SliceSinker #line:DarkCyan
HloModulePass <|- - ReshapeMover #line:DarkCyan
HloModulePass <|- - HloConstantFolding #line:DarkCyan
HloModulePass <|- - ConditionalSimplifier #line:DarkCyan
OpExpanderPass <|- - RealImagExpander #line:SteelBlue
HloModulePass <|- - TransposeFolding #line:DarkCyan
HloModulePass <|- - HloCSE #line:DarkCyan
HloModulePass <|- - HloDCE #line:DarkCyan
HloModulePass <|- - WhileLoopTripCountAnnotator #line:DarkCyan
HloModulePass <|- - AllReduceFolder #line:DarkCyan
HloModulePass <|- - ReduceScatterCreator #line:DarkCyan
HloModulePass <|- - AllReduceReassociate #line:DarkCyan
HloModulePass <|- - AllGatherBroadcastReorder #line:DarkCyan
HloModulePass <|- - GpusolverRewriter #line:DarkCyan
HloModulePass <|- - GpuConvRewriter #line:DarkCyan
HloModulePass <|- - GpuConvPaddingLegalization #line:DarkCyan
HloModulePass <|- - FlattenCallGraph #line:DarkCyan
HloModulePass <|- - LayoutAssignment #line:DarkCyan
LayoutAssignment <|- - GpuLayoutAssignment #line:DarkTurquoise
HloModulePass <|- - ReductionDegenerateDimRemover #line:DarkCyan
HloModulePass <|- - ReductionLayoutNormalizer #line:DarkCyan
HloModulePass <|- - ReductionDimensionGrouper #line:DarkCyan
HloModulePass <|- - ReductionSplitter #line:DarkCyan
HloModulePass <|- - GpuTreeReductionRewriter #line:DarkCyan
HloModulePass <|- - GemmRewriter #line:DarkCyan
HloModulePass <|- - GemmBroadcastFoldingRewriter #line:DarkCyan
HloModulePass <|- - GpuConvAlgorithmPicker #line:DarkCyan
HloModulePass <|- - VariadicOpSplitter #line:DarkCyan
HloModulePass <|- - InstructionFusion #line:DarkCyan
InstructionFusion <|- - GpuInstructionFusion #line:c77182
HloModulePass <|- - FusionMerger #line:DarkCyan
HloModulePass <|- - GpuMultiOutputFusion #line:DarkCyan
HloModulePass <|- - GpuHorizontalLoopFusion #line:DarkCyan
HloModulePass <|- - GpuHorizontalInputFusion #line:DarkCyan
HloModulePass <|- - FusionBitcastLift #line:DarkCyan
HloModulePass <|- - AllGatherCombiner #line:DarkCyan
HloModulePass <|- - AllReduceCombiner #line:DarkCyan
HloModulePass <|- - ReduceScatterCombiner #line:DarkCyan
HloModulePass <|- - AllReduceContiguous #line:DarkCyan
HloModulePass <|- - AllReduceBlueConnect #line:DarkCyan
HloModulePass <|- - AsyncCollectiveCreator #line:DarkCyan
HloModulePass <|- - CollectivesScheduleLinearizer #line:DarkCyan
HloModulePass <|- - ShardingPropagation #line:DarkCyan
HloModulePass <|- - SpmdPartitioner #line:DarkCyan
SpmdPartitioner <|- - GpuSpmdPartitioner #line:7fe994
HloModulePass <|- - ShardingRemover #line:DarkCyan

HloModulePass <|- - AliasPassthroughParams #line:DarkCyan
HloModulePass <|- - LoopScheduleLinearizer #line:DarkCyan
HloModulePass <|- - GpuCopyInsertion #line:DarkCyan
HloModulePass <|- - GpuSanitizeConstantNames #line:DarkCyan

@enduml

PlantUML version 1.2021.16(Thu Dec 09 01:25:22 CST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>